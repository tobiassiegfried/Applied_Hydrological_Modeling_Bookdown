<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.3 Climate Reanalysis Data | Applied Modeling of Hydrological Systems in Central Asia</title>
  <meta name="description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5.3 Climate Reanalysis Data | Applied Modeling of Hydrological Systems in Central Asia" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.3 Climate Reanalysis Data | Applied Modeling of Hydrological Systems in Central Asia" />
  
  <meta name="twitter:description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  

<meta name="author" content="Tobias Siegfried" />


<meta name="date" content="2021-04-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="Data-GeospatialData.html"/>
<link rel="next" href="data-on-climate-projections.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Hydrological Modeling</a></li>

<li class="divider"></li>
<li><a href="index.html#Welcome"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="part"><span><b>I Part I Hydrological Systems</b></span></li>
<li class="chapter" data-level="1" data-path="ShortHistory.html"><a href="ShortHistory.html"><i class="fa fa-check"></i><b>1</b> Short History of Water in Central Asia</a>
<ul>
<li class="chapter" data-level="1.1" data-path="TamingHydrologicalSystems.html"><a href="TamingHydrologicalSystems.html"><i class="fa fa-check"></i><b>1.1</b> The Taming of the Central Asian Rivers</a></li>
<li class="chapter" data-level="1.2" data-path="PostTransitionDevelopmentsChallenges.html"><a href="PostTransitionDevelopmentsChallenges.html"><i class="fa fa-check"></i><b>1.2</b> Post-Transition Development and Challenges</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="HydrologicalSystems.html"><a href="HydrologicalSystems.html"><i class="fa fa-check"></i><b>2</b> Hydrological Systems in Central Asia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regional-hydro-climatological-features.html"><a href="regional-hydro-climatological-features.html"><i class="fa fa-check"></i><b>2.1</b> Regional Hydro-Climatological Features</a></li>
<li class="chapter" data-level="2.2" data-path="chap-regionalWaterBalance.html"><a href="chap-regionalWaterBalance.html"><i class="fa fa-check"></i><b>2.2</b> Regional Water Balance</a></li>
<li class="chapter" data-level="2.3" data-path="runoff-formation.html"><a href="runoff-formation.html"><i class="fa fa-check"></i><b>2.3</b> Runoff Formation</a></li>
<li class="chapter" data-level="2.4" data-path="average-multi-year-runoff.html"><a href="average-multi-year-runoff.html"><i class="fa fa-check"></i><b>2.4</b> Average Multi-Year Runoff</a></li>
<li class="chapter" data-level="2.5" data-path="annual-runoff-fluctuations.html"><a href="annual-runoff-fluctuations.html"><i class="fa fa-check"></i><b>2.5</b> Annual Runoff Fluctuations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="CaseStudies.html"><a href="CaseStudies.html"><i class="fa fa-check"></i><b>3</b> Case Studies</a>
<ul>
<li class="chapter" data-level="3.1" data-path="GuntRB.html"><a href="GuntRB.html"><i class="fa fa-check"></i><b>3.1</b> Gunt River Basin</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="GuntRB.html"><a href="GuntRB.html#GuntRBOverview"><i class="fa fa-check"></i><b>3.1.1</b> Basin Characterization</a></li>
<li class="chapter" data-level="3.1.2" data-path="GuntRB.html"><a href="GuntRB.html#GuntHyrology"><i class="fa fa-check"></i><b>3.1.2</b> Hydrology</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="CRB.html"><a href="CRB.html"><i class="fa fa-check"></i><b>3.2</b> Chirchik River Basin</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="CRB.html"><a href="CRB.html#CRBOverview"><i class="fa fa-check"></i><b>3.2.1</b> Basin Characterization</a></li>
<li class="chapter" data-level="3.2.2" data-path="CRB.html"><a href="CRB.html#CRBBasinCharacteristics"><i class="fa fa-check"></i><b>3.2.2</b> Hydrology</a></li>
<li class="chapter" data-level="3.2.3" data-path="CRB.html"><a href="CRB.html#CRB_KoskuDischargeContribution"><i class="fa fa-check"></i><b>3.2.3</b> Discharge Estimation from the Ungauged Kosku Tributary</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Part II Applied Modeling</b></span></li>
<li class="chapter" data-level="4" data-path="LongTermWaterBalance.html"><a href="LongTermWaterBalance.html"><i class="fa fa-check"></i><b>4</b> Budyko-Type Long-term Water Balance Modeling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="derivation-of-the-budyko-relationship.html"><a href="derivation-of-the-budyko-relationship.html"><i class="fa fa-check"></i><b>4.1</b> Derivation of the Budyko Relationship</a></li>
<li class="chapter" data-level="4.2" data-path="effects-of-snow-ratio-on-annual-runoff-within-the-budyko-framework.html"><a href="effects-of-snow-ratio-on-annual-runoff-within-the-budyko-framework.html"><i class="fa fa-check"></i><b>4.2</b> Effects of Snow Ratio on Annual Runoff within the Budyko Framework</a></li>
<li class="chapter" data-level="4.3" data-path="hydrological-response-to-a-changing-climate.html"><a href="hydrological-response-to-a-changing-climate.html"><i class="fa fa-check"></i><b>4.3</b> Hydrological Response to a Changing Climate</a></li>
<li class="chapter" data-level="4.4" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html"><i class="fa fa-check"></i><b>4.4</b> Application to Central Asian River Basins</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#data"><i class="fa fa-check"></i><b>4.4.1</b> Data</a></li>
<li class="chapter" data-level="4.4.2" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#model"><i class="fa fa-check"></i><b>4.4.2</b> Model</a></li>
<li class="chapter" data-level="4.4.3" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#conclusions"><i class="fa fa-check"></i><b>4.4.3</b> Conclusions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Chapter-DATA.html"><a href="Chapter-DATA.html"><i class="fa fa-check"></i><b>5</b> Data Retrieval, Preparation &amp; Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Data-StationData.html"><a href="Data-StationData.html"><i class="fa fa-check"></i><b>5.1</b> Station Data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="Data-StationData.html"><a href="Data-StationData.html#AvailableData"><i class="fa fa-check"></i><b>5.1.1</b> Available Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="Data-StationData.html"><a href="Data-StationData.html#StationData::GapFilling"><i class="fa fa-check"></i><b>5.1.2</b> Gap Filling Discharge Data</a></li>
<li class="chapter" data-level="5.1.3" data-path="Data-StationData.html"><a href="Data-StationData.html#DataPreparationPT"><i class="fa fa-check"></i><b>5.1.3</b> Gap Filling Meteorological Data</a></li>
<li class="chapter" data-level="5.1.4" data-path="Data-StationData.html"><a href="Data-StationData.html#AnomaliesOutliers"><i class="fa fa-check"></i><b>5.1.4</b> Anomalies and Outliers</a></li>
<li class="chapter" data-level="5.1.5" data-path="Data-StationData.html"><a href="Data-StationData.html#FinalData"><i class="fa fa-check"></i><b>5.1.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html"><i class="fa fa-check"></i><b>5.2</b> Geospatial Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#section-steps-setting-up"><i class="fa fa-check"></i><b>5.2.1</b> Setting up QGIS</a></li>
<li class="chapter" data-level="5.2.2" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#load-dem"><i class="fa fa-check"></i><b>5.2.2</b> Load DEM</a></li>
<li class="chapter" data-level="5.2.3" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#section-steps-derive-catchment-boundaries"><i class="fa fa-check"></i><b>5.2.3</b> Derive the boundaries of your catchment</a></li>
<li class="chapter" data-level="5.2.4" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#run-through-the-process-model"><i class="fa fa-check"></i><b>5.2.4</b> Run through the process model</a></li>
<li class="chapter" data-level="5.2.5" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#manually-edit-the-gis-layers-for-import-in-rs-minerve"><i class="fa fa-check"></i><b>5.2.5</b> Manually edit the GIS Layers for import in RS MINERVE</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html"><i class="fa fa-check"></i><b>5.3</b> Climate Reanalysis Data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html#Data::CHELSA"><i class="fa fa-check"></i><b>5.3.1</b> CHELSA V1.2.1 Data and Bias Correction</a></li>
<li class="chapter" data-level="5.3.2" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html#Data::ERA5"><i class="fa fa-check"></i><b>5.3.2</b> ERA5 Download and Data Resampling with PBCORR CHELSA</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html"><i class="fa fa-check"></i><b>5.4</b> Data on Climate Projections</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html#CHELSA21Century"><i class="fa fa-check"></i><b>5.4.1</b> High Res. Monthly Climate Time Series for 2006 - 2100</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html#using-a-weather-generator-to-simulate-daily-future-climate"><i class="fa fa-check"></i><b>5.4.2</b> Using a Weather Generator to Simulate Daily Future Climate</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="snow-cover-data.html"><a href="snow-cover-data.html"><i class="fa fa-check"></i><b>5.5</b> Snow Cover Data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="RSMinerveMODELS.html"><a href="RSMinerveMODELS.html"><i class="fa fa-check"></i><b>6</b> Hydrological-Hydraulic Modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="section-rsminerve-prerequisites.html"><a href="section-rsminerve-prerequisites.html"><i class="fa fa-check"></i><b>6.1</b> Prerequisites</a></li>
<li class="chapter" data-level="6.2" data-path="section-rsminerve-why-model-introduction.html"><a href="section-rsminerve-why-model-introduction.html"><i class="fa fa-check"></i><b>6.2</b> Recap: Hydrological response</a></li>
<li class="chapter" data-level="6.3" data-path="section-hbv-model.html"><a href="section-hbv-model.html"><i class="fa fa-check"></i><b>6.3</b> The HBV model</a></li>
<li class="chapter" data-level="6.4" data-path="data-preparation-and-setup.html"><a href="data-preparation-and-setup.html"><i class="fa fa-check"></i><b>6.4</b> Data Preparation and Setup</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-preparation-and-setup.html"><a href="data-preparation-and-setup.html#examining-and-understanding-the-gis-data"><i class="fa fa-check"></i><b>6.4.1</b> Examining and Understanding the GIS Data</a></li>
<li class="chapter" data-level="6.4.2" data-path="data-preparation-and-setup.html"><a href="data-preparation-and-setup.html#loading-gis-data-and-model-creation"><i class="fa fa-check"></i><b>6.4.2</b> Loading GIS Data and Model Creation</a></li>
<li class="chapter" data-level="6.4.3" data-path="data-preparation-and-setup.html"><a href="data-preparation-and-setup.html#climate-data"><i class="fa fa-check"></i><b>6.4.3</b> Climate Data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="model-calibration-and-validation.html"><a href="model-calibration-and-validation.html"><i class="fa fa-check"></i><b>6.5</b> Model Calibration and Validation</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="model-calibration-and-validation.html"><a href="model-calibration-and-validation.html#basic-principles"><i class="fa fa-check"></i><b>6.5.1</b> Basic Principles</a></li>
<li class="chapter" data-level="6.5.2" data-path="model-calibration-and-validation.html"><a href="model-calibration-and-validation.html#practical-steps"><i class="fa fa-check"></i><b>6.5.2</b> Practical Steps</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="application-investigating-climate-change-impacts.html"><a href="application-investigating-climate-change-impacts.html"><i class="fa fa-check"></i><b>6.6</b> Application: Investigating Climate Change Impacts</a></li>
<li class="chapter" data-level="6.7" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>6.7</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="HydroModelsEmpiricalModels.html"><a href="HydroModelsEmpiricalModels.html"><i class="fa fa-check"></i><b>7</b> Discharge Forecasting with Predictive Inference</a>
<ul>
<li class="chapter" data-level="" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="7.1" data-path="Chap9PredictiveInference.html"><a href="Chap9PredictiveInference.html"><i class="fa fa-check"></i><b>7.1</b> Forecasting Using Predictive Inference</a></li>
<li class="chapter" data-level="7.2" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html"><i class="fa fa-check"></i><b>7.2</b> Forecasting in the Central Asian Hydromets</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html#background"><i class="fa fa-check"></i><b>7.2.1</b> Background</a></li>
<li class="chapter" data-level="7.2.2" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html#forecasting-for-what-and-whom"><i class="fa fa-check"></i><b>7.2.2</b> Forecasting for What and Whom?</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html"><i class="fa fa-check"></i><b>7.3</b> Data and Preparation</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9AvailableData"><i class="fa fa-check"></i><b>7.3.1</b> Available Data</a></li>
<li class="chapter" data-level="7.3.2" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9DataPreparationQ"><i class="fa fa-check"></i><b>7.3.2</b> Gap Filling Discharge Data</a></li>
<li class="chapter" data-level="7.3.3" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9DataPreparationPT"><i class="fa fa-check"></i><b>7.3.3</b> Gap Filling Meteorological Data</a></li>
<li class="chapter" data-level="7.3.4" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9AnomaliesOutliers"><i class="fa fa-check"></i><b>7.3.4</b> Anomalies and Outliers</a></li>
<li class="chapter" data-level="7.3.5" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9_FinalData"><i class="fa fa-check"></i><b>7.3.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html"><i class="fa fa-check"></i><b>7.4</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap_9_DataTransformation"><i class="fa fa-check"></i><b>7.4.1</b> Data Transformation</a></li>
<li class="chapter" data-level="7.4.2" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_Trends"><i class="fa fa-check"></i><b>7.4.2</b> Detecting Trends</a></li>
<li class="chapter" data-level="7.4.3" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_Autocorrelations"><i class="fa fa-check"></i><b>7.4.3</b> Auto- and Crosscorrelations</a></li>
<li class="chapter" data-level="7.4.4" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_SeasonalityAnalysis"><i class="fa fa-check"></i><b>7.4.4</b> Time Series Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html"><i class="fa fa-check"></i><b>7.5</b> Investigating and Engineering Predictors</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_CurrentPractice"><i class="fa fa-check"></i><b>7.5.1</b> Benchmark: Current Operational Forecasting Models in the Hydrometeorological Agencies</a></li>
<li class="chapter" data-level="7.5.2" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_TSR"><i class="fa fa-check"></i><b>7.5.2</b> Time Series Regression Models</a></li>
<li class="chapter" data-level="7.5.3" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_ForecastQuality"><i class="fa fa-check"></i><b>7.5.3</b> Assessing the Quality of Forecasts</a></li>
<li class="chapter" data-level="7.5.4" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#generating-and-assessing-out-of-sample-forecasts"><i class="fa fa-check"></i><b>7.5.4</b> Generating and Assessing Out-of-Sample Forecasts</a></li>
<li class="chapter" data-level="7.5.5" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_MLM"><i class="fa fa-check"></i><b>7.5.5</b> Machine Learning Models</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="save-data-for-hot-start.html"><a href="save-data-for-hot-start.html"><i class="fa fa-check"></i><b>7.6</b> Save Data for Hot Start</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Operationalization.html"><a href="Operationalization.html"><i class="fa fa-check"></i><b>8</b> Operationalization of Models - Opportunities and Challenges</a>
<ul>
<li class="chapter" data-level="8.1" data-path="co-design-phase.html"><a href="co-design-phase.html"><i class="fa fa-check"></i><b>8.1</b> Co-design Phase</a></li>
<li class="chapter" data-level="8.2" data-path="modeling-phase.html"><a href="modeling-phase.html"><i class="fa fa-check"></i><b>8.2</b> Modeling Phase</a></li>
<li class="chapter" data-level="8.3" data-path="testing-phase.html"><a href="testing-phase.html"><i class="fa fa-check"></i><b>8.3</b> Testing Phase</a></li>
<li class="chapter" data-level="8.4" data-path="operational-deployment.html"><a href="operational-deployment.html"><i class="fa fa-check"></i><b>8.4</b> Operational Deployment</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ChapterAppendix.html"><a href="ChapterAppendix.html"><i class="fa fa-check"></i><b>9</b> (APPENDIX) Appendix</a>
<ul>
<li class="chapter" data-level="9.1" data-path="appendix-a-open-source-software.html"><a href="appendix-a-open-source-software.html"><i class="fa fa-check"></i><b>9.1</b> Appendix A: Open-source Software</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="appendix-a-open-source-software.html"><a href="appendix-a-open-source-software.html#open-source-software"><i class="fa fa-check"></i><b>9.1.1</b> Open-Source Software</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html"><i class="fa fa-check"></i><b>9.2</b> Appendix B: Quick Guides</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#rs-minerve-1"><i class="fa fa-check"></i><b>9.2.1</b> RS Minerve</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html"><i class="fa fa-check"></i><b>9.3</b> Appendix C: Processing Climate Data</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#cutting-chelsa-v.1.2.1-to-ca-domain"><i class="fa fa-check"></i><b>9.3.1</b> Cutting CHELSA v.1.2.1 to CA Domain</a></li>
<li class="chapter" data-level="9.3.2" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#bias-correcting-chelsa-v1.2.1-precipitation-data-for-snow-undercatch"><i class="fa fa-check"></i><b>9.3.2</b> Bias Correcting CHELSA v1.2.1 Precipitation Data for Snow Undercatch</a></li>
<li class="chapter" data-level="9.3.3" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#computing-mean-monthly-temperature-climatology-from-chelsa-v1.2.1-data"><i class="fa fa-check"></i><b>9.3.3</b> Computing Mean Monthly Temperature Climatology from CHELSA v1.2.1 data</a></li>
<li class="chapter" data-level="9.3.4" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#era5"><i class="fa fa-check"></i><b>9.3.4</b> ERA5</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html"><i class="fa fa-check"></i><b>9.4</b> Appendix D: Solutions to exercises</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html#section-appendix-solutions-exercise1"><i class="fa fa-check"></i><b>9.4.1</b> Exercise on Linear Reservoir modelling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Modeling of Hydrological Systems in Central Asia</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Data::ClimateReanalysisData" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Climate Reanalysis Data</h2>
<p>Information about the spatio-temporal distribution of precipitation (P) and temperature (T) is vital for water balance studies, including for modeling. Poorly gauged basins do not have dense enough ground-based monitoring network that would allow to obtain reliable meteorological fields that can be used to drive hydrological models. Station data are especially poor in complex and remote mountain catchments in developing and transition countries. The Central Asian river basins are examples of such basins. Global reanalysis data can help to cover these existing gaps. In this Chapter, we show how this can be achieved.</p>
<p>We use ERA5 global reanalysis data to obtain temperature at 2 meters above ground and total precipitation fields on an hourly base from 1981-01-01 through 2020-12-31. ERA5 data comes with a 30km grid cell size resolution and is thus quite course. This is relevant for complex mountain terrains which feature highly variable climate over very short distances, sometimes from one valley to the next. To address this problem, a bias correct version of the monthly CHELSA high resolution climatology product is used to arrive at high resolution hourly climatology fields (the CHELSA dataset is described in <span class="citation">(<a href="References.html#ref-Karger_2017" role="doc-biblioref">Karger et al. 2017</a>)</span> and the bias correction of it in <span class="citation">(<a href="References.html#ref-beck2020a" role="doc-biblioref">Beck et al. 2020b</a>)</span>. Like this, high-resolution hourly data from 1981-01-01 through 2013-12-31, i.e. the period for which the CHELSA dataset is available, could be derived. These data are then used for model calibration and validation and for the computation of the reference hydro-climatological situation from 1981 through 2013. More details can be found in Chapter <a href="RSMinerveMODELS.html#RSMinerveMODELS">6</a>.</p>
<p>The analysis present here is for the Gunt river catchment. The approach and methods we have developed are universally applicable for other catchments.</p>
<div id="Data::CHELSA" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> CHELSA V1.2.1 Data and Bias Correction</h3>
<p>The CHELSA V1.2.1 data covers the period 1981-01-01 until 2013-12-31. This period is considered to be the base climate period where 1981-01-01 until 1993-12-31 will be used as the parameter calibration period for the hydrological model. The model validation period is from 1994-01-01 until 2013-12-31. This period will constitute the baseline period in relation to which climatic changes in the mid 21st as well as end of 21st century will be assessed.</p>
<p>Mean monthly temperature and total monthly precipitation between 1981-01-01 and 2013-01-01 can be accessed and downloaded for the Central Asia domain from the following <a href="https://www.dropbox.com/sh/zfwfhw6rnq04k0l/AABuhwT5clmV_vprEoXWPp-pa?dl=0">online repository</a><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>. Mean monthly temperatures are stored in the <code>./t2m/</code> folder and precipitation in the <code>./pr/</code> folder there.</p>
<p>Note that the Central Asia domain is defined as test</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="Data-ClimateReanalysisData.html#cb74-1" aria-hidden="true" tabindex="-1"></a>aoi_CentralAsia_LatLon <span class="ot">&lt;-</span> <span class="fu">extent</span>(<span class="fu">c</span>(<span class="dv">65</span>,<span class="fl">80.05</span>,<span class="fl">35.95</span>,<span class="fl">44.05</span>)) <span class="co"># this is a raster::extent() object. For more information, type ?extent into the console.</span></span></code></pre></div>
<p>The CHELSA data are downscaled ERA-INTERIM model outputs for temperature and precipitation with a resolution of 30 arc seconds <span class="citation">(<a href="References.html#ref-Karger_2017" role="doc-biblioref">Karger et al. 2017</a>)</span>. Temperature fields are statistically downscaled ERA-INTERIM temperatures whereas for precipitation downscaling, several orographic predictors are taken into account, including for example wind fields, valley exposition, height of the atmospheric boundary layer, etc.</p>
<p>Because of its highly resolved climatologies, the CHELSA data has been shown to be particularly useful for studies in regions with complex topography. However, it has also been shown that the original CHELSA precipitation data is underestimating high mountain precipitation. This can be explained by the phenomenon of snow undercatch which explains measured precipitation deficits by sublimation and blowing snow transport at high altitude meteorological stations.</p>
<p>An example of this is shown in Figure <a href="Data-ClimateReanalysisData.html#fig:snowUndercatchExampleSpain">5.32</a> for high elevation gauges in Spain. In a recent intercomparison project carried out in Spain, it has been shown that undercatch poses significant problems in accurately measuring solid precipitation <span class="citation">(<a href="References.html#ref-Buis_n_2017" role="doc-biblioref">Buisán et al. 2017</a>)</span> in mountainous regions. Both, ERA-INTERIM and CHELSA themselves assimilate station data in their models and hence are affected by these <em>erroneous</em> measurements.</p>
<div class="figure"><span id="fig:snowUndercatchExampleSpain"></span>
<img src="_bookdown_files/FIG_DATA/snowUndercatch_Spain.jpg" alt="Measured snow undercatch values in high-mountain stations in Spain. The values were determined within the World Meteorological Organization Solid Precipitation Intercomparison Experiment (WMO-SPICE). See text for more information and reference." width="425" />
<p class="caption">
Figure 5.32: Measured snow undercatch values in high-mountain stations in Spain. The values were determined within the World Meteorological Organization Solid Precipitation Intercomparison Experiment (WMO-SPICE). See text for more information and reference.
</p>
</div>
<p><span class="citation"><a href="References.html#ref-beck2020" role="doc-biblioref">Beck et al.</a> (<a href="References.html#ref-beck2020" role="doc-biblioref">2020a</a>)</span> has recognized this and released monthly correction factors for the CHELSA data (see Figure <a href="Data-ClimateReanalysisData.html#fig:CHELSABiasCorrectionFactors">5.33</a>).</p>
<div class="figure"><span id="fig:CHELSABiasCorrectionFactors"></span>
<img src="_bookdown_files/FIG_DATA/Beck_BiasCorrectionFactors.jpg" alt="Figure from [@beck2020], Supplementary Material. Plate d): Best estimate of global bias correction factors. Plate e): Lower bound estimate of global bias correction factors. Plate f): Upper bound of global bias correction factors. As is clearly visible, bias correction factors in high-mountain Asia, including the parts of Central Asia are significant." width="764" />
<p class="caption">
Figure 5.33: Figure from <span class="citation">(<a href="References.html#ref-beck2020" role="doc-biblioref">Beck et al. 2020a</a>)</span>, Supplementary Material. Plate d): Best estimate of global bias correction factors. Plate e): Lower bound estimate of global bias correction factors. Plate f): Upper bound of global bias correction factors. As is clearly visible, bias correction factors in high-mountain Asia, including the parts of Central Asia are significant.
</p>
</div>
<p>The bias corrected CHELSA precipitation (tp) raster data is available via this Dropbox <a href="https://www.dropbox.com/s/zysif93xbbay2tp/CHELSA_V12.nc?dl=0">link</a>. Using these temperature as well bias-corrected precipitation data, we can easily compute and display the monthly norm climatology fields over the Central Asia domain<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>. Here, we just load them and visualize the mean monthly patterns for a consistency check.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="Data-ClimateReanalysisData.html#cb75-1" aria-hidden="true" tabindex="-1"></a>t2m_meanMonthlyClimate_CHELSA <span class="ot">&lt;-</span> </span>
<span id="cb75-2"><a href="Data-ClimateReanalysisData.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  raster<span class="sc">::</span><span class="fu">brick</span>(<span class="st">&#39;./data/CentralAsiaDomain/CHELSA_V1.2.1/t2m_climatology/t2m_climatology_CA.tif&#39;</span>)</span>
<span id="cb75-3"><a href="Data-ClimateReanalysisData.html#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="Data-ClimateReanalysisData.html#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(t2m_meanMonthlyClimate_CHELSA) <span class="ot">&lt;-</span> month.abb</span>
<span id="cb75-5"><a href="Data-ClimateReanalysisData.html#cb75-5" aria-hidden="true" tabindex="-1"></a>t2m_meanMonthlyClimate_CHELSA <span class="ot">&lt;-</span> t2m_meanMonthlyClimate_CHELSA <span class="sc">/</span> <span class="dv">10</span> <span class="sc">-</span> <span class="fl">273.15</span> <span class="co"># now, the CHELSA data is in deg. C</span></span>
<span id="cb75-6"><a href="Data-ClimateReanalysisData.html#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="Data-ClimateReanalysisData.html#cb75-7" aria-hidden="true" tabindex="-1"></a>temperature_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;RdYlBu&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">colorRampPalette</span>()</span>
<span id="cb75-8"><a href="Data-ClimateReanalysisData.html#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="Data-ClimateReanalysisData.html#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="fu">gplot</span>(t2m_meanMonthlyClimate_CHELSA) <span class="sc">+</span> </span>
<span id="cb75-10"><a href="Data-ClimateReanalysisData.html#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb75-11"><a href="Data-ClimateReanalysisData.html#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable) <span class="sc">+</span></span>
<span id="cb75-12"><a href="Data-ClimateReanalysisData.html#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">rev</span>(<span class="fu">temperature_colors</span>(<span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb75-13"><a href="Data-ClimateReanalysisData.html#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb75-14"><a href="Data-ClimateReanalysisData.html#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_colorbar</span>(<span class="at">title=</span><span class="st">&#39;T [deg. C.]&#39;</span>)) </span></code></pre></div>
<div class="figure"><span id="fig:meanMonthlyTemperatureClimatology"></span>
<img src="applied-hydrological-modeling-central-asia_files/figure-html/meanMonthlyTemperatureClimatology-1.png" alt="CHELSA v1.2.1 mean monthly temperature climatology is shown." width="672" />
<p class="caption">
Figure 5.34: CHELSA v1.2.1 mean monthly temperature climatology is shown.
</p>
</div>
<p>In a similar way, the bias corrected precipitation climatology can be plotted. Figure <a href="Data-ClimateReanalysisData.html#fig:meanMonthlyPrecipitationClimatology">5.35</a> nicely shows the main precipitation months of the key mountain ranges in the region. The Figure shows that March and April are normally the main precipitation months.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="Data-ClimateReanalysisData.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load file</span></span>
<span id="cb76-2"><a href="Data-ClimateReanalysisData.html#cb76-2" aria-hidden="true" tabindex="-1"></a>pbcorr_pr_meanMonthlyClimate_CHELSA <span class="ot">&lt;-</span> </span>
<span id="cb76-3"><a href="Data-ClimateReanalysisData.html#cb76-3" aria-hidden="true" tabindex="-1"></a>  raster<span class="sc">::</span><span class="fu">brick</span>(<span class="st">&#39;./data/CentralAsiaDomain/CHELSA_V1.2.1/pr_climatology/pr_climatology_CA.nc&#39;</span>)</span>
<span id="cb76-4"><a href="Data-ClimateReanalysisData.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Layer names</span></span>
<span id="cb76-5"><a href="Data-ClimateReanalysisData.html#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(pbcorr_pr_meanMonthlyClimate_CHELSA) <span class="ot">&lt;-</span> month.abb</span>
<span id="cb76-6"><a href="Data-ClimateReanalysisData.html#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Color palette</span></span>
<span id="cb76-7"><a href="Data-ClimateReanalysisData.html#cb76-7" aria-hidden="true" tabindex="-1"></a>precipitation_colors <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;YlGnBu&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">colorRampPalette</span>()</span>
<span id="cb76-8"><a href="Data-ClimateReanalysisData.html#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb76-9"><a href="Data-ClimateReanalysisData.html#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="fu">gplot</span>(pbcorr_pr_meanMonthlyClimate_CHELSA) <span class="sc">+</span> </span>
<span id="cb76-10"><a href="Data-ClimateReanalysisData.html#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb76-11"><a href="Data-ClimateReanalysisData.html#cb76-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable) <span class="sc">+</span></span>
<span id="cb76-12"><a href="Data-ClimateReanalysisData.html#cb76-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">precipitation_colors</span>(<span class="dv">500</span>)) <span class="sc">+</span></span>
<span id="cb76-13"><a href="Data-ClimateReanalysisData.html#cb76-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb76-14"><a href="Data-ClimateReanalysisData.html#cb76-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_colorbar</span>(<span class="at">title=</span><span class="st">&#39;P [mm/yr]&#39;</span>)) </span></code></pre></div>
<div class="figure"><span id="fig:meanMonthlyPrecipitationClimatology"></span>
<img src="applied-hydrological-modeling-central-asia_files/figure-html/meanMonthlyPrecipitationClimatology-1.png" alt="CHELSA v1.2.1 mean monthly precipitation climatology is shown." width="672" />
<p class="caption">
Figure 5.35: CHELSA v1.2.1 mean monthly precipitation climatology is shown.
</p>
</div>
<p>How can the quality of the CHELSA data in the complex Central Asia domain be assessed? We explore this question the validity of the CHELSA dataset to be able to adequately represent the high-mountain climate in the Pamirs. The key questions here to be answered are</p>
<ul>
<li><p>does the magnitude of the precipitation yield physically meaningful results, and</p></li>
<li><p>does the climatology adequately reproduce the seasonal cycle observed one at the stations?</p></li>
</ul>
<p>Let us address the first question investigating bias corrected precipitation values and comparing these discharge for the Gunt river basin. If <span class="math inline">\(P &gt;Q\)</span> where <span class="math inline">\(P\)</span> is the long-term mean precipitation and <span class="math inline">\(Q\)</span> is the long-term mean discharge, we can confidently say that the bias corrected CHELSA precipitation product is meaningful from a water balance perspective (see also Chapter <a href="LongTermWaterBalance.html#LongTermWaterBalance">4</a> for more information).</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="Data-ClimateReanalysisData.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load catchment shp</span></span>
<span id="cb77-2"><a href="Data-ClimateReanalysisData.html#cb77-2" aria-hidden="true" tabindex="-1"></a>gunt_Shapefile <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;./data/AmuDarya/Gunt/GeospatialData/Gunt_Basin_poly.shp&#39;</span>,<span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-3"><a href="Data-ClimateReanalysisData.html#cb77-3" aria-hidden="true" tabindex="-1"></a>gunt_Shapefile <span class="ot">&lt;-</span> gunt_Shapefile <span class="sc">%&gt;%</span> <span class="fu">subset</span>(fid<span class="sc">==</span><span class="dv">2</span>)</span>
<span id="cb77-4"><a href="Data-ClimateReanalysisData.html#cb77-4" aria-hidden="true" tabindex="-1"></a>gunt_Shapefile_LatLon <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(gunt_Shapefile,<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>))</span>
<span id="cb77-5"><a href="Data-ClimateReanalysisData.html#cb77-5" aria-hidden="true" tabindex="-1"></a>areaGunt <span class="ot">&lt;-</span> gunt_Shapefile <span class="sc">%&gt;%</span> <span class="fu">st_area</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>()</span>
<span id="cb77-6"><a href="Data-ClimateReanalysisData.html#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="Data-ClimateReanalysisData.html#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Areas of Interest</span></span>
<span id="cb77-8"><a href="Data-ClimateReanalysisData.html#cb77-8" aria-hidden="true" tabindex="-1"></a>aoi_CentralAsia_LatLon <span class="ot">&lt;-</span> <span class="fu">extent</span>(<span class="fu">c</span>(<span class="dv">65</span>,<span class="fl">80.05</span>,<span class="fl">35.95</span>,<span class="fl">44.05</span>)) <span class="co"># in lat/lon</span></span>
<span id="cb77-9"><a href="Data-ClimateReanalysisData.html#cb77-9" aria-hidden="true" tabindex="-1"></a>aoi_Basin_LatLon <span class="ot">&lt;-</span> gunt_Shapefile_LatLon <span class="sc">%&gt;%</span> <span class="fu">extent</span>() <span class="co"># GUNT</span></span>
<span id="cb77-10"><a href="Data-ClimateReanalysisData.html#cb77-10" aria-hidden="true" tabindex="-1"></a>aoi_Basin_UTM <span class="ot">&lt;-</span> gunt_Shapefile <span class="sc">%&gt;%</span> <span class="fu">extent</span>() <span class="co"># GUNT, in UTM</span></span>
<span id="cb77-11"><a href="Data-ClimateReanalysisData.html#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="Data-ClimateReanalysisData.html#cb77-12" aria-hidden="true" tabindex="-1"></a>fLoc <span class="ot">&lt;-</span> <span class="st">&#39;./data/AmuDarya/Gunt/ReanalysisData/tp_bcorr_NORM_CHELSA_Gunt.nc&#39;</span></span>
<span id="cb77-13"><a href="Data-ClimateReanalysisData.html#cb77-13" aria-hidden="true" tabindex="-1"></a>chelsaP_GUNT_corr_raster <span class="ot">&lt;-</span> <span class="fu">brick</span>(fLoc, <span class="at">varname=</span><span class="st">&quot;corr_P_annual&quot;</span>)</span>
<span id="cb77-14"><a href="Data-ClimateReanalysisData.html#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="Data-ClimateReanalysisData.html#cb77-15" aria-hidden="true" tabindex="-1"></a>chelsaP_GUNT_corr__spdf <span class="ot">&lt;-</span> <span class="fu">as</span>(chelsaP_GUNT_corr_raster, <span class="st">&quot;SpatialPixelsDataFrame&quot;</span>)</span>
<span id="cb77-16"><a href="Data-ClimateReanalysisData.html#cb77-16" aria-hidden="true" tabindex="-1"></a>chelsaP_GUNT_corr__df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(chelsaP_GUNT_corr__spdf)</span>
<span id="cb77-17"><a href="Data-ClimateReanalysisData.html#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(chelsaP_GUNT_corr__df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;value&quot;</span>, <span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb77-18"><a href="Data-ClimateReanalysisData.html#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="Data-ClimateReanalysisData.html#cb77-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the raster for inspection and analysis</span></span>
<span id="cb77-20"><a href="Data-ClimateReanalysisData.html#cb77-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb77-21"><a href="Data-ClimateReanalysisData.html#cb77-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">data=</span>chelsaP_GUNT_corr__df, <span class="fu">aes</span>(<span class="at">x=</span>x, <span class="at">y=</span>y, <span class="at">fill=</span>value), <span class="at">alpha=</span><span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb77-22"><a href="Data-ClimateReanalysisData.html#cb77-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>gunt_Shapefile,<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">fill=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb77-23"><a href="Data-ClimateReanalysisData.html#cb77-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">precipitation_colors</span>(<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb77-24"><a href="Data-ClimateReanalysisData.html#cb77-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Longitude&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Latitude&quot;</span>) <span class="sc">+</span> </span>
<span id="cb77-25"><a href="Data-ClimateReanalysisData.html#cb77-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill=</span><span class="fu">guide_colorbar</span>(<span class="at">title=</span><span class="st">&quot;P Norm [mm]&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb77-26"><a href="Data-ClimateReanalysisData.html#cb77-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bias Corrected CHELSA v1.2.1 Norm Precipitation, Gunt River Basin&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:guntCHELSAPreciptiation"></span>
<img src="applied-hydrological-modeling-central-asia_files/figure-html/guntCHELSAPreciptiation-1.png" alt="Long-term mean precipitation climatology of the Gunt river basin in the Pamir mountains. The catchment is delineated by the black polygon. The mean long-term precipitation in the catchment is 349 mm/year." width="672" />
<p class="caption">
Figure 5.36: Long-term mean precipitation climatology of the Gunt river basin in the Pamir mountains. The catchment is delineated by the black polygon. The mean long-term precipitation in the catchment is 349 mm/year.
</p>
</div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="Data-ClimateReanalysisData.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract raster values inside basin polygon and convert to equivalent water height</span></span>
<span id="cb78-2"><a href="Data-ClimateReanalysisData.html#cb78-2" aria-hidden="true" tabindex="-1"></a>rasterRes <span class="ot">&lt;-</span> chelsaP_GUNT_corr_raster <span class="sc">%&gt;%</span> <span class="fu">res</span>()</span>
<span id="cb78-3"><a href="Data-ClimateReanalysisData.html#cb78-3" aria-hidden="true" tabindex="-1"></a>rasterCellArea <span class="ot">&lt;-</span> rasterRes[<span class="dv">1</span>] <span class="sc">*</span> rasterRes[<span class="dv">2</span>] <span class="co"># in m^2</span></span>
<span id="cb78-4"><a href="Data-ClimateReanalysisData.html#cb78-4" aria-hidden="true" tabindex="-1"></a>basin_P <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(chelsaP_GUNT_corr_raster,gunt_Shapefile)[[<span class="dv">1</span>]] <span class="sc">*</span> rasterCellArea <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb78-5"><a href="Data-ClimateReanalysisData.html#cb78-5" aria-hidden="true" tabindex="-1"></a>basin_P <span class="ot">&lt;-</span> basin_P <span class="sc">%&gt;%</span> <span class="fu">sum</span>() <span class="sc">/</span> areaGunt <span class="sc">*</span> <span class="dv">1000</span> <span class="co"># now in mm</span></span>
<span id="cb78-6"><a href="Data-ClimateReanalysisData.html#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print(paste0(&quot;The bias corrected CHELSA v.1.2 norm precipitation in Gunt River Basin is &quot;, basin_P %&gt;% round(0), &#39; mm&#39;))</span></span></code></pre></div>
<p>From the perspective of the water balance, the basin-wide long-term mean precipitation estimate passes the test since P (353 mm) &gt; Q (234 mm) where the latter is the long-term discharge norm at the Khorog gauging station at the outlet of the basin (see also Chapter <a href="CaseStudies.html#CaseStudies">3</a> for more information on Gunt river basin). The water balance components are also discussed in Chapter <a href="LongTermWaterBalance.html#LongTermWaterBalance">4</a>.</p>
<p>As an aside, the bias corrected precipitation climatology shows an interesting feature of the Gunt river basin (see Figure <a href="Data-ClimateReanalysisData.html#fig:guntCHELSAPreciptiation">5.36</a>). Namely, there is a stark precipitation gradient between the western part of the basin where the bulk of the precipitation is observed and the hyper-arid Pamir plateau region to the east, where annual precipitation is around or below 200 mm.</p>
<p>What about the seasonality of the CHELSA product? Can it adequately reproduce the observed precipitation seasonality? If this would not be the case, we would have to reject the validity of the product and explore other high-resolution climatologies such as WorldClim V2 or CHPClim V1 (see <span class="citation">(<a href="References.html#ref-beck2020b" role="doc-biblioref">Beck et al. 2020c</a>)</span> for more information on these products). Lets explore again for Gunt river basin.</p>
<p>First, we load and prepare all the required station precipitation and geospatial data. Then, we compute the monthly norms of these data for the period 1981-01-01 through 2013-12-31.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="Data-ClimateReanalysisData.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data (this time, we access the monthly norm data through the specification of the variable name, that we want to load, i.e. varname=&quot;corr_P_monthly&quot;) </span></span>
<span id="cb79-2"><a href="Data-ClimateReanalysisData.html#cb79-2" aria-hidden="true" tabindex="-1"></a>fLoc <span class="ot">&lt;-</span> <span class="st">&#39;./data/AmuDarya/Gunt/ReanalysisData/tp_bcorr_monthly_CHELSA_Gunt.nc&#39;</span></span>
<span id="cb79-3"><a href="Data-ClimateReanalysisData.html#cb79-3" aria-hidden="true" tabindex="-1"></a>chelsaP_GUNT_monthly_corr_raster_proj <span class="ot">&lt;-</span> <span class="fu">brick</span>(fLoc, <span class="at">varname=</span><span class="st">&quot;corr_P_monthly&quot;</span>)</span>
<span id="cb79-4"><a href="Data-ClimateReanalysisData.html#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="Data-ClimateReanalysisData.html#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Gunt river basin cells and compute monthly totals</span></span>
<span id="cb79-6"><a href="Data-ClimateReanalysisData.html#cb79-6" aria-hidden="true" tabindex="-1"></a>chelsa_monthly_norm_P <span class="ot">&lt;-</span> <span class="fu">extract</span>(chelsaP_GUNT_monthly_corr_raster_proj,gunt_Shapefile)[[<span class="dv">1</span>]] <span class="sc">*</span> rasterCellArea <span class="sc">/</span> <span class="dv">1000</span></span>
<span id="cb79-7"><a href="Data-ClimateReanalysisData.html#cb79-7" aria-hidden="true" tabindex="-1"></a>chelsa_monthly_norm_P <span class="ot">&lt;-</span> (chelsa_monthly_norm_P <span class="sc">%&gt;%</span> <span class="fu">colSums</span>() <span class="sc">/</span> areaGunt <span class="sc">*</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span> <span class="fu">unname</span>() <span class="co"># now in mm</span></span>
<span id="cb79-8"><a href="Data-ClimateReanalysisData.html#cb79-8" aria-hidden="true" tabindex="-1"></a>chelsa_monthly_norm_P <span class="ot">&lt;-</span> chelsa_monthly_norm_P <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">CHELSA_norm_P=</span>value)</span>
<span id="cb79-9"><a href="Data-ClimateReanalysisData.html#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="Data-ClimateReanalysisData.html#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Gunt Station Data record</span></span>
<span id="cb79-11"><a href="Data-ClimateReanalysisData.html#cb79-11" aria-hidden="true" tabindex="-1"></a>fPath <span class="ot">=</span> <span class="st">&#39;./data/AmuDarya/Gunt/StationData/gunt_data_cleaned.Rds&#39;</span></span>
<span id="cb79-12"><a href="Data-ClimateReanalysisData.html#cb79-12" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(fPath)</span>
<span id="cb79-13"><a href="Data-ClimateReanalysisData.html#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="Data-ClimateReanalysisData.html#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the station data precipitation record</span></span>
<span id="cb79-15"><a href="Data-ClimateReanalysisData.html#cb79-15" aria-hidden="true" tabindex="-1"></a>P_38950 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;P&quot;</span> <span class="sc">&amp;</span> code<span class="sc">==</span><span class="dv">38950</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(date,data) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">P_38950=</span>data)</span>
<span id="cb79-16"><a href="Data-ClimateReanalysisData.html#cb79-16" aria-hidden="true" tabindex="-1"></a>P_38953 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;P&quot;</span> <span class="sc">&amp;</span> code<span class="sc">==</span><span class="dv">38953</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(date,data) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">P_38953=</span>data)</span>
<span id="cb79-17"><a href="Data-ClimateReanalysisData.html#cb79-17" aria-hidden="true" tabindex="-1"></a>P_38954 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;P&quot;</span> <span class="sc">&amp;</span> code<span class="sc">==</span><span class="dv">38954</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(date,data) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">P_38954=</span>data)</span>
<span id="cb79-18"><a href="Data-ClimateReanalysisData.html#cb79-18" aria-hidden="true" tabindex="-1"></a>P_38956 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&quot;P&quot;</span> <span class="sc">&amp;</span> code<span class="sc">==</span><span class="dv">38956</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(date,data) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">P_38956=</span>data)</span>
<span id="cb79-19"><a href="Data-ClimateReanalysisData.html#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="Data-ClimateReanalysisData.html#cb79-20" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">full_join</span>(P_38950,P_38953,<span class="at">by=</span><span class="st">&quot;date&quot;</span>)</span>
<span id="cb79-21"><a href="Data-ClimateReanalysisData.html#cb79-21" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">full_join</span>(P,P_38954,<span class="at">by=</span><span class="st">&quot;date&quot;</span>)</span>
<span id="cb79-22"><a href="Data-ClimateReanalysisData.html#cb79-22" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">full_join</span>(P,P_38956,<span class="at">by=</span><span class="st">&quot;date&quot;</span>)</span>
<span id="cb79-23"><a href="Data-ClimateReanalysisData.html#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="Data-ClimateReanalysisData.html#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="co"># add a month identifier</span></span>
<span id="cb79-25"><a href="Data-ClimateReanalysisData.html#cb79-25" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> P <span class="sc">%&gt;%</span> <span class="fu">filter</span>(date<span class="sc">&gt;=</span><span class="fu">as.Date</span>(<span class="st">&quot;1981-01-01&quot;</span>) <span class="sc">&amp;</span> date<span class="sc">&lt;=</span><span class="fu">as.Date</span>(<span class="st">&quot;2013-12-31&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">mon =</span> <span class="fu">month</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb79-26"><a href="Data-ClimateReanalysisData.html#cb79-26" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>date)</span>
<span id="cb79-27"><a href="Data-ClimateReanalysisData.html#cb79-27" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> P <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>mon) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(mon)</span>
<span id="cb79-28"><a href="Data-ClimateReanalysisData.html#cb79-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-29"><a href="Data-ClimateReanalysisData.html#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, make a nice plot which compares with the monthly means average over all stations in the catchment.</span></span>
<span id="cb79-30"><a href="Data-ClimateReanalysisData.html#cb79-30" aria-hidden="true" tabindex="-1"></a>station_monthly_norm_P <span class="ot">&lt;-</span> P <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">Station_norm_P =</span> <span class="fu">mean</span>(value,<span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>mon) </span>
<span id="cb79-31"><a href="Data-ClimateReanalysisData.html#cb79-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-32"><a href="Data-ClimateReanalysisData.html#cb79-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Join data</span></span>
<span id="cb79-33"><a href="Data-ClimateReanalysisData.html#cb79-33" aria-hidden="true" tabindex="-1"></a>norm_P_data <span class="ot">&lt;-</span> chelsa_monthly_norm_P <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">mon=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">1</span>),station_monthly_norm_P,<span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb79-34"><a href="Data-ClimateReanalysisData.html#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare for plotting</span></span>
<span id="cb79-35"><a href="Data-ClimateReanalysisData.html#cb79-35" aria-hidden="true" tabindex="-1"></a>norm_P_data_long <span class="ot">&lt;-</span> norm_P_data <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>mon)</span>
<span id="cb79-36"><a href="Data-ClimateReanalysisData.html#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb79-37"><a href="Data-ClimateReanalysisData.html#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(norm_P_data_long,<span class="fu">aes</span>(<span class="at">x=</span>mon,<span class="at">y=</span>value,<span class="at">color =</span> name)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb79-38"><a href="Data-ClimateReanalysisData.html#cb79-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;mm/month&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:precipitationNorms"></span>
<img src="applied-hydrological-modeling-central-asia_files/figure-html/precipitationNorms-1.png" alt="Monthly precipitation norms of the bias corrected CHELSA v1.2.1 dataset and the mean monthly precipitation averaged over the four meteorological stations in the Gunt river basin." width="672" />
<p class="caption">
Figure 5.37: Monthly precipitation norms of the bias corrected CHELSA v1.2.1 dataset and the mean monthly precipitation averaged over the four meteorological stations in the Gunt river basin.
</p>
</div>
<p>The seasonality of the precipitation is in excellent agreement between the observed data and the bias corrected CHELSA precipitation product. One should not be misled by the offset in absolute terms between the two datasets since since one is data derived from stations at particular locations and the other is average high-resolution gridded data.</p>
<p>A better way to plot the comparison of the seasonality of the two products would be to center and standardize the two datasets. This can be achieved the following way.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="Data-ClimateReanalysisData.html#cb80-1" aria-hidden="true" tabindex="-1"></a>norm_P_data_zscore <span class="ot">&lt;-</span> </span>
<span id="cb80-2"><a href="Data-ClimateReanalysisData.html#cb80-2" aria-hidden="true" tabindex="-1"></a>  norm_P_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Station_norm_P_zscore =</span> (Station_norm_P <span class="sc">-</span> <span class="fu">mean</span>(Station_norm_P))<span class="sc">/</span> <span class="fu">sd</span>(Station_norm_P)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="Data-ClimateReanalysisData.html#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CHELSA_norm_P_zscore =</span> (CHELSA_norm_P <span class="sc">-</span> <span class="fu">mean</span>(CHELSA_norm_P)) <span class="sc">/</span> <span class="fu">sd</span>(CHELSA_norm_P))</span>
<span id="cb80-4"><a href="Data-ClimateReanalysisData.html#cb80-4" aria-hidden="true" tabindex="-1"></a>norm_P_data_zscore_long <span class="ot">&lt;-</span> norm_P_data_zscore <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Station_norm_P,<span class="sc">-</span>CHELSA_norm_P) <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>mon)</span>
<span id="cb80-5"><a href="Data-ClimateReanalysisData.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(norm_P_data_zscore_long,<span class="fu">aes</span>(<span class="at">x=</span>mon,<span class="at">y=</span>value,<span class="at">color =</span> name)) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb80-6"><a href="Data-ClimateReanalysisData.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Month&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;[-]&quot;</span>)</span></code></pre></div>
<div class="figure"><span id="fig:precipitationNormsZscore"></span>
<img src="applied-hydrological-modeling-central-asia_files/figure-html/precipitationNormsZscore-1.png" alt="Centered and standardized precipitation norms for the comparison of the seasonality of the two products.The bias corrected CHELSA product reproduces the precipitation seasonlity in an excellent manner. Note that the values on the y-axis do not have any units as a result of the standarization." width="672" />
<p class="caption">
Figure 5.38: Centered and standardized precipitation norms for the comparison of the seasonality of the two products.The bias corrected CHELSA product reproduces the precipitation seasonlity in an excellent manner. Note that the values on the y-axis do not have any units as a result of the standarization.
</p>
</div>
<p>To summarize, with the CHELSA v1.2.1 dataset, we have downloaded and prepared a high spatial resolution climatology for the Central Asia domain. As this product is derived from reanalysis data that mixes station data with climate model output, the precipitation product was bias corrected for snow undercatch that causes the original reanalysis data to greatly underestimate high-elevation precipitation data. As show for Gunt river basin in the Pamirs, the resulting temperature and precipitation climatologies compare in an excellent manner with seasonalities observed at local meteorological stations.</p>
<p>For hydrological modeling, however, we need not only high spatial resolution data but also high temporal resolution data, ideally at hourly time-steps, to drive the hydrological model. In the next Section @ref(<a href="Data::ERA5" class="uri">Data::ERA5</a>), we show how hourly ERA5 reanalysis data fields can be resampled and rescaled so that mean or total monthly values match CHELSA v.1.2.1 at particular raster cells. Like this, we will arrive at a dataset with high temporal and spatial resolution.</p>
</div>
<div id="Data::ERA5" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> ERA5 Download and Data Resampling with PBCORR CHELSA</h3>
<div id="era5-background" class="section level4" number="5.3.2.1">
<h4><span class="header-section-number">5.3.2.1</span> ERA5 Background</h4>
<p>ERA5 data from 1981-01-01 through 2013-12-31 for the Central Asia domain is available for download under this <a href="https://www.dropbox.com/sh/5ce1kuque45njav/AABz97dPaA12qamuXQIdjSFEa?dl=0">link</a>. Hourly temperature 2 meters above the surface (t2m) and hourly precipitation (tp) totals can be downloaded there<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>. More information about ERA5 data can be found on the official <a href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5">website</a> of the European Center of Medium Weather Forecast.</p>
<p>With the <a href="https://era5.lobelia.earth/en/?utm_source=lobelia&amp;utm_medium=web&amp;utm_campaign=project-button">Lobelia Past Climate Explorer</a>, one can easily get key statistics of any of the ERA5 raster cells globally. Try it! Go to the Central Asia domain, search for your place of interest (i.e. your home, the Gunt river basin, Chirchik river basin, etc.) and click on the point where you would like to see the statistics. See also Figure <a href="Data-ClimateReanalysisData.html#fig:lobeliaERA5">5.39</a></p>
<div class="figure"><span id="fig:lobeliaERA5"></span>
<img src="_bookdown_files/FIG_DATA/lobelia_era5.jpg" alt="Screenshot from the Lovelia ERA5 website with the ERA5 temperature statistics of Khorog selected.  " width="1645" />
<p class="caption">
Figure 5.39: Screenshot from the Lovelia ERA5 website with the ERA5 temperature statistics of Khorog selected.
</p>
</div>
<p><a href="https://cds.climate.copernicus.eu/#!/search?text=ERA5&amp;type=dataset">ERA5 data</a> can be downloaded from the Copernicus Climate Change Service (C3S) Climate Data Store. We use the ERA5-Land hourly data from 1981 product. Note that if you want to download the data yourself from the Data Store, you need to register there.</p>
<div class="figure"><span id="fig:CDStoreERA5"></span>
<img src="_bookdown_files/FIG_DATA/CDStore_ERA5.jpg" alt="Screenshot from the Copernicus Climate Data Store. One needs to register first if you want to download data yourself from the Climate Data Store (click on Login/register button. The product which we download is highlighted. If you click on it, then the detailed data page comes up." width="1379" />
<p class="caption">
Figure 5.40: Screenshot from the Copernicus Climate Data Store. One needs to register first if you want to download data yourself from the Climate Data Store (click on Login/register button. The product which we download is highlighted. If you click on it, then the detailed data page comes up.
</p>
</div>
<p>As per the ECMWF description, “ERA5-Land is a reanalysis dataset providing a consistent view of the evolution of land variables over several decades at an enhanced resolution compared to ERA5. ERA5-Land has been produced by replaying the land component of the ECMWF ERA5 climate reanalysis. Reanalysis combines model data with observations from across the world into a globally complete and consistent dataset using the laws of physics. Reanalysis produces data that goes several decades back in time, providing an accurate description of the climate of the past.” For more information, please visit the detailed data description <a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land?tab=overview">webpage</a>.</p>
<p>The variables t2m and tp which you can access via this <a href="https://www.dropbox.com/sh/5ce1kuque45njav/AABz97dPaA12qamuXQIdjSFEa?dl=0">link</a> are described described in greater detail on the site. For reference, these data specifications are copied in the Table below.</p>
<table>
<caption>ERA5-Land t2m and pr variables descriptions.</caption>
<colgroup>
<col width="2%" />
<col width="0%" />
<col width="96%" />
</colgroup>
<thead>
<tr class="header">
<th>Name</th>
<th>Units</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2m temperature (t2m)</td>
<td>K</td>
<td>Temperature of air at 2m above the surface of land, sea or in-land waters. 2m temperature is calculated by interpolating between the lowest model level and the Earth’s surface, taking account of the atmospheric conditions. Temperature measured in kelvin can be converted to degrees Celsius (°C) by subtracting 273.15.</td>
</tr>
<tr class="even">
<td>Total precipitation (tp)</td>
<td>m</td>
<td>Accumulated liquid and frozen water, including rain and snow, that falls to the Earth’s surface. It is the sum of large-scale precipitation (that precipitation which is generated by large-scale weather patterns, such as troughs and cold fronts) and convective precipitation (generated by convection which occurs when air at lower levels in the atmosphere is warmer and less dense than the air above, so it rises). Precipitation variables do not include fog, dew or the precipitation that evaporates in the atmosphere before it lands at the surface of the Earth. This variable is accumulated from the beginning of the forecast time to the end of the forecast step. The units of precipitation are depth in meters. It is the depth the water would have if it were spread evenly over the grid box. Care should be taken when comparing model variables with observations, because observations are often local to a particular point in space and time, rather than representing averages over a model grid box and model time step.</td>
</tr>
</tbody>
</table>
</div>
<div id="era5-land-download" class="section level4" number="5.3.2.2">
<h4><span class="header-section-number">5.3.2.2</span> ERA5-Land Download</h4>
<p>Note: This Section just demonstrates how you can order data from Copernicus Climate Data Store. It is not required for you to carry this out in order to access the Central Asia 2m temperature and total precipitation data that has been prepared for this course and is available for download <a href="https://www.dropbox.com/sh/5ce1kuque45njav/AABz97dPaA12qamuXQIdjSFEa?dl=0">here</a>.</p>
<p>The manual data download from the Climate Data Store is tedious. We show here how, with an R-script, you can place a data order and then, once the data is prepared, download it from the Data Store.</p>
<p>The following code segments show to download daily ERA5 t2m and tp data that is segmented into yearly netCDF-files. Like this, these become manageable for later processing. Note that the two code segments start the scripts on the side of the Climate Data Store data service. Following the submission of jobs and after a wait of a couple of hours, the data can then be downloaded at <a href="https://cds.climate.copernicus.eu/cdsapp#!/yourrequests" class="uri">https://cds.climate.copernicus.eu/cdsapp#!/yourrequests</a> manually and stored in the relevant location. Note that for these scripts to run, you need to give your own credentials that you obtain after login in the Climate Data Store.</p>
<p>Under the assumption that you have typed in your credentials (user name, ID and key), 2 meter temperature data can be downloaded in the following way.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="Data-ClimateReanalysisData.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Required library</span></span>
<span id="cb81-2"><a href="Data-ClimateReanalysisData.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecmwfr)</span>
<span id="cb81-3"><a href="Data-ClimateReanalysisData.html#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data download of ERA5 by adding login credentials to the keychain.</span></span>
<span id="cb81-4"><a href="Data-ClimateReanalysisData.html#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wf_set_key</span>(<span class="at">user =</span> <span class="st">&#39;&lt;Your user name&gt;&#39;</span>,</span>
<span id="cb81-5"><a href="Data-ClimateReanalysisData.html#cb81-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">key =</span> <span class="st">&quot;Your key&quot;</span>,</span>
<span id="cb81-6"><a href="Data-ClimateReanalysisData.html#cb81-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">service =</span> <span class="st">&quot;webapi&quot;</span>)</span>
<span id="cb81-7"><a href="Data-ClimateReanalysisData.html#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="Data-ClimateReanalysisData.html#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="Data-ClimateReanalysisData.html#cb81-9" aria-hidden="true" tabindex="-1"></a>downloadList_t2m <span class="ot">&lt;-</span> <span class="dv">1981</span><span class="sc">:</span><span class="dv">2013</span> <span class="co"># The years for which CHELSA v1.2.1 is available are chosen for download. These will be used for the calibration and vaildation of the hydrological model and constitute the reference hydrological period. </span></span>
<span id="cb81-10"><a href="Data-ClimateReanalysisData.html#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="Data-ClimateReanalysisData.html#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (yr <span class="cf">in</span> downloadList_t2m){</span>
<span id="cb81-12"><a href="Data-ClimateReanalysisData.html#cb81-12" aria-hidden="true" tabindex="-1"></a>  CentralAsia_ERA5_hourly_request <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb81-13"><a href="Data-ClimateReanalysisData.html#cb81-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">&quot;netcdf&quot;</span>,</span>
<span id="cb81-14"><a href="Data-ClimateReanalysisData.html#cb81-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">&quot;2m_temperature&quot;</span>),</span>
<span id="cb81-15"><a href="Data-ClimateReanalysisData.html#cb81-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">as.character</span>(yr),</span>
<span id="cb81-16"><a href="Data-ClimateReanalysisData.html#cb81-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">c</span>(<span class="st">&quot;01&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;03&quot;</span>, <span class="st">&quot;04&quot;</span>, <span class="st">&quot;05&quot;</span>, <span class="st">&quot;06&quot;</span>, <span class="st">&quot;07&quot;</span>, <span class="st">&quot;08&quot;</span>, <span class="st">&quot;09&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>),</span>
<span id="cb81-17"><a href="Data-ClimateReanalysisData.html#cb81-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">day =</span> <span class="fu">c</span>(<span class="st">&quot;01&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;03&quot;</span>, <span class="st">&quot;04&quot;</span>, <span class="st">&quot;05&quot;</span>, <span class="st">&quot;06&quot;</span>, <span class="st">&quot;07&quot;</span>, <span class="st">&quot;08&quot;</span>, <span class="st">&quot;09&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;13&quot;</span>, <span class="st">&quot;14&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;16&quot;</span>, <span class="st">&quot;17&quot;</span>, <span class="st">&quot;18&quot;</span>, <span class="st">&quot;19&quot;</span>, <span class="st">&quot;20&quot;</span>, <span class="st">&quot;21&quot;</span>, <span class="st">&quot;22&quot;</span>, <span class="st">&quot;23&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;25&quot;</span>, <span class="st">&quot;26&quot;</span>, <span class="st">&quot;27&quot;</span>, <span class="st">&quot;28&quot;</span>, <span class="st">&quot;29&quot;</span>, <span class="st">&quot;30&quot;</span>, <span class="st">&quot;31&quot;</span>),</span>
<span id="cb81-18"><a href="Data-ClimateReanalysisData.html#cb81-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">c</span>(<span class="st">&quot;00:00&quot;</span>, <span class="st">&quot;01:00&quot;</span>, <span class="st">&quot;02:00&quot;</span>, <span class="st">&quot;03:00&quot;</span>, <span class="st">&quot;04:00&quot;</span>, <span class="st">&quot;05:00&quot;</span>, <span class="st">&quot;06:00&quot;</span>, <span class="st">&quot;07:00&quot;</span>, <span class="st">&quot;08:00&quot;</span>, <span class="st">&quot;09:00&quot;</span>, <span class="st">&quot;10:00&quot;</span>, <span class="st">&quot;11:00&quot;</span>, <span class="st">&quot;12:00&quot;</span>, <span class="st">&quot;13:00&quot;</span>, <span class="st">&quot;14:00&quot;</span>, <span class="st">&quot;15:00&quot;</span>, <span class="st">&quot;16:00&quot;</span>, <span class="st">&quot;17:00&quot;</span>, <span class="st">&quot;18:00&quot;</span>, <span class="st">&quot;19:00&quot;</span>, <span class="st">&quot;20:00&quot;</span>, <span class="st">&quot;21:00&quot;</span>, <span class="st">&quot;22:00&quot;</span>, <span class="st">&quot;23:00&quot;</span>),</span>
<span id="cb81-19"><a href="Data-ClimateReanalysisData.html#cb81-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">64</span>, <span class="dv">34</span>, <span class="dv">81</span>),</span>
<span id="cb81-20"><a href="Data-ClimateReanalysisData.html#cb81-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset_short_name =</span> <span class="st">&quot;reanalysis-era5-land&quot;</span>,</span>
<span id="cb81-21"><a href="Data-ClimateReanalysisData.html#cb81-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> <span class="fu">paste0</span>(<span class="st">&quot;CentralAsia_ERA5_hourly_&quot;</span>,<span class="fu">as.character</span>(yr),<span class="st">&#39;.nc&#39;</span>))</span>
<span id="cb81-22"><a href="Data-ClimateReanalysisData.html#cb81-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb81-23"><a href="Data-ClimateReanalysisData.html#cb81-23" aria-hidden="true" tabindex="-1"></a>  file <span class="ot">&lt;-</span> <span class="fu">wf_request</span>(<span class="at">user     =</span> <span class="st">&quot;Your User ID&quot;</span>,   <span class="co"># user ID (for authentication)</span></span>
<span id="cb81-24"><a href="Data-ClimateReanalysisData.html#cb81-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">request  =</span> CentralAsia_ERA5_hourly_request,  <span class="co"># the request name (can be anything)</span></span>
<span id="cb81-25"><a href="Data-ClimateReanalysisData.html#cb81-25" aria-hidden="true" tabindex="-1"></a>                     <span class="at">transfer =</span> <span class="cn">FALSE</span>,     <span class="co"># put it in the queue and download manually from the website</span></span>
<span id="cb81-26"><a href="Data-ClimateReanalysisData.html#cb81-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">path     =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb81-27"><a href="Data-ClimateReanalysisData.html#cb81-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">job_name =</span> <span class="fu">paste0</span>(<span class="st">&quot;t2m_CentralAsia_ERA5_hourly_&quot;</span>,<span class="fu">as.character</span>(yr),<span class="st">&#39;.nc&#39;</span>))  </span>
<span id="cb81-28"><a href="Data-ClimateReanalysisData.html#cb81-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Similarly, total precipitation is downloaded with the following code.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="Data-ClimateReanalysisData.html#cb82-1" aria-hidden="true" tabindex="-1"></a>downloadList_tp <span class="ot">&lt;-</span> <span class="dv">1981</span><span class="sc">:</span><span class="dv">2013</span></span>
<span id="cb82-2"><a href="Data-ClimateReanalysisData.html#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="Data-ClimateReanalysisData.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (yr <span class="cf">in</span> downloadList_tp){</span>
<span id="cb82-4"><a href="Data-ClimateReanalysisData.html#cb82-4" aria-hidden="true" tabindex="-1"></a>  CentralAsia_ERA5_hourly_request <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb82-5"><a href="Data-ClimateReanalysisData.html#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">&quot;netcdf&quot;</span>,</span>
<span id="cb82-6"><a href="Data-ClimateReanalysisData.html#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">&quot;total_precipitation&quot;</span>),</span>
<span id="cb82-7"><a href="Data-ClimateReanalysisData.html#cb82-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">as.character</span>(yr),</span>
<span id="cb82-8"><a href="Data-ClimateReanalysisData.html#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">c</span>(<span class="st">&quot;01&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;03&quot;</span>, <span class="st">&quot;04&quot;</span>, <span class="st">&quot;05&quot;</span>, <span class="st">&quot;06&quot;</span>, <span class="st">&quot;07&quot;</span>, <span class="st">&quot;08&quot;</span>, <span class="st">&quot;09&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>),</span>
<span id="cb82-9"><a href="Data-ClimateReanalysisData.html#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">day =</span> <span class="fu">c</span>(<span class="st">&quot;01&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;03&quot;</span>, <span class="st">&quot;04&quot;</span>, <span class="st">&quot;05&quot;</span>, <span class="st">&quot;06&quot;</span>, <span class="st">&quot;07&quot;</span>, <span class="st">&quot;08&quot;</span>, <span class="st">&quot;09&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>, <span class="st">&quot;13&quot;</span>, <span class="st">&quot;14&quot;</span>, <span class="st">&quot;15&quot;</span>, <span class="st">&quot;16&quot;</span>, <span class="st">&quot;17&quot;</span>, <span class="st">&quot;18&quot;</span>, <span class="st">&quot;19&quot;</span>, <span class="st">&quot;20&quot;</span>, <span class="st">&quot;21&quot;</span>, <span class="st">&quot;22&quot;</span>, <span class="st">&quot;23&quot;</span>, <span class="st">&quot;24&quot;</span>, <span class="st">&quot;25&quot;</span>, <span class="st">&quot;26&quot;</span>, <span class="st">&quot;27&quot;</span>, <span class="st">&quot;28&quot;</span>, <span class="st">&quot;29&quot;</span>, <span class="st">&quot;30&quot;</span>, <span class="st">&quot;31&quot;</span>),</span>
<span id="cb82-10"><a href="Data-ClimateReanalysisData.html#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">time =</span> <span class="fu">c</span>(<span class="st">&quot;00:00&quot;</span>, <span class="st">&quot;01:00&quot;</span>, <span class="st">&quot;02:00&quot;</span>, <span class="st">&quot;03:00&quot;</span>, <span class="st">&quot;04:00&quot;</span>, <span class="st">&quot;05:00&quot;</span>, <span class="st">&quot;06:00&quot;</span>, <span class="st">&quot;07:00&quot;</span>, <span class="st">&quot;08:00&quot;</span>, <span class="st">&quot;09:00&quot;</span>, <span class="st">&quot;10:00&quot;</span>, <span class="st">&quot;11:00&quot;</span>, <span class="st">&quot;12:00&quot;</span>, <span class="st">&quot;13:00&quot;</span>, <span class="st">&quot;14:00&quot;</span>, <span class="st">&quot;15:00&quot;</span>, <span class="st">&quot;16:00&quot;</span>, <span class="st">&quot;17:00&quot;</span>, <span class="st">&quot;18:00&quot;</span>, <span class="st">&quot;19:00&quot;</span>, <span class="st">&quot;20:00&quot;</span>, <span class="st">&quot;21:00&quot;</span>, <span class="st">&quot;22:00&quot;</span>, <span class="st">&quot;23:00&quot;</span>),</span>
<span id="cb82-11"><a href="Data-ClimateReanalysisData.html#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">area =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">64</span>, <span class="dv">34</span>, <span class="dv">81</span>),</span>
<span id="cb82-12"><a href="Data-ClimateReanalysisData.html#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">dataset_short_name =</span> <span class="st">&quot;reanalysis-era5-land&quot;</span>,</span>
<span id="cb82-13"><a href="Data-ClimateReanalysisData.html#cb82-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">target =</span> <span class="fu">paste0</span>(<span class="st">&quot;CentralAsia_ERA5_hourly_&quot;</span>,<span class="fu">as.character</span>(yr),<span class="st">&#39;.nc&#39;</span>))</span>
<span id="cb82-14"><a href="Data-ClimateReanalysisData.html#cb82-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-15"><a href="Data-ClimateReanalysisData.html#cb82-15" aria-hidden="true" tabindex="-1"></a>  file <span class="ot">&lt;-</span> <span class="fu">wf_request</span>(<span class="at">user     =</span> <span class="st">&quot;11732&quot;</span>,   <span class="co"># user ID (for authentication)</span></span>
<span id="cb82-16"><a href="Data-ClimateReanalysisData.html#cb82-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">request  =</span> CentralAsia_ERA5_hourly_request,  <span class="co"># the request</span></span>
<span id="cb82-17"><a href="Data-ClimateReanalysisData.html#cb82-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">transfer =</span> <span class="cn">FALSE</span>,     <span class="co"># put it in the queue and download manually from the website</span></span>
<span id="cb82-18"><a href="Data-ClimateReanalysisData.html#cb82-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">path     =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb82-19"><a href="Data-ClimateReanalysisData.html#cb82-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">job_name =</span> <span class="fu">paste0</span>(<span class="st">&quot;tp_CentralAsia_ERA5_hourly_&quot;</span>,<span class="fu">as.character</span>(yr),<span class="st">&#39;.nc&#39;</span>))  </span>
<span id="cb82-20"><a href="Data-ClimateReanalysisData.html#cb82-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="rescaling-era5-to-monthly-chelsa-values" class="section level4" number="5.3.2.3">
<h4><span class="header-section-number">5.3.2.3</span> Rescaling ERA5 to monthly CHELSA values</h4>
<p>ERA5 original data can easily be rescaled (bias corrected) to CHELSA data values for any river basin in the Central Asia domain using the convenience function <code>riversCentralAsia::biasCorrect_ERA5_CHELSA()</code>. Type <code>?biasCorrect_ERA5_CHELSA</code> to get more information about the function and its arguments. The code block below shows how to rescale (bias correct) total precipitation. It assumes that the ERA5 directory contains two subfolders <code>ERA5/tp/</code> and <code>ERA5/t2m</code> where the corresponding data are stored.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="Data-ClimateReanalysisData.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify biasCorrect_ERA5_CHELSA() function arguments</span></span>
<span id="cb83-2"><a href="Data-ClimateReanalysisData.html#cb83-2" aria-hidden="true" tabindex="-1"></a>basinName <span class="ot">&lt;-</span> <span class="st">&#39;Gunt&#39;</span></span>
<span id="cb83-3"><a href="Data-ClimateReanalysisData.html#cb83-3" aria-hidden="true" tabindex="-1"></a>dataType_ERA5 <span class="ot">&lt;-</span> <span class="st">&#39;tp&#39;</span> <span class="co"># note that ERA5 tp units are in m!</span></span>
<span id="cb83-4"><a href="Data-ClimateReanalysisData.html#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Directories of relevant climate files  - function arguments</span></span>
<span id="cb83-5"><a href="Data-ClimateReanalysisData.html#cb83-5" aria-hidden="true" tabindex="-1"></a>dir_ERA5_hourly <span class="ot">&lt;-</span> <span class="st">&#39;../HydrologicalModeling_CentralAsia_Data/CentralAsiaDomain/ERA5/&#39;</span></span>
<span id="cb83-6"><a href="Data-ClimateReanalysisData.html#cb83-6" aria-hidden="true" tabindex="-1"></a>dir_CHELSA <span class="ot">&lt;-</span> <span class="st">&#39;../HydrologicalModeling_CentralAsia_Data/CentralAsiaDomain/CHELSA_V1.2.1/&#39;</span></span>
<span id="cb83-7"><a href="Data-ClimateReanalysisData.html#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># start and end times - function arguments</span></span>
<span id="cb83-8"><a href="Data-ClimateReanalysisData.html#cb83-8" aria-hidden="true" tabindex="-1"></a>startY <span class="ot">&lt;-</span> <span class="dv">1981</span></span>
<span id="cb83-9"><a href="Data-ClimateReanalysisData.html#cb83-9" aria-hidden="true" tabindex="-1"></a>endY <span class="ot">&lt;-</span> <span class="dv">2013</span></span>
<span id="cb83-10"><a href="Data-ClimateReanalysisData.html#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="Data-ClimateReanalysisData.html#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu">biasCorrect_ERA5_CHELSA</span>(dir_ERA5_hourly,dataType_ERA5,dir_CHELSA,startY,endY,basinName,gunt_Shapefile_LatLon)</span></code></pre></div>
<p>By simply switching the data type (effectively, it just looks for the files in the corresponding directory), temperature can be rescaled to the CHELSA field values for each month.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="Data-ClimateReanalysisData.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify biasCorrect_ERA5_CHELSA() function arguments</span></span>
<span id="cb84-2"><a href="Data-ClimateReanalysisData.html#cb84-2" aria-hidden="true" tabindex="-1"></a>basinName <span class="ot">&lt;-</span> <span class="st">&#39;Gunt&#39;</span></span>
<span id="cb84-3"><a href="Data-ClimateReanalysisData.html#cb84-3" aria-hidden="true" tabindex="-1"></a>dataType_ERA5 <span class="ot">&lt;-</span> <span class="st">&#39;t2m&#39;</span> <span class="co"># note that ERA5 tp units are in m!</span></span>
<span id="cb84-4"><a href="Data-ClimateReanalysisData.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Directories of relevant climate files  - function arguments</span></span>
<span id="cb84-5"><a href="Data-ClimateReanalysisData.html#cb84-5" aria-hidden="true" tabindex="-1"></a>dir_ERA5_hourly <span class="ot">&lt;-</span> <span class="st">&#39;../HydrologicalModeling_CentralAsia_Data/CentralAsiaDomain/ERA5/&#39;</span></span>
<span id="cb84-6"><a href="Data-ClimateReanalysisData.html#cb84-6" aria-hidden="true" tabindex="-1"></a>dir_CHELSA <span class="ot">&lt;-</span> <span class="st">&#39;../HydrologicalModeling_CentralAsia_Data/CentralAsiaDomain/CHELSA_V1.2.1/&#39;</span></span>
<span id="cb84-7"><a href="Data-ClimateReanalysisData.html#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># start and end times - function arguments</span></span>
<span id="cb84-8"><a href="Data-ClimateReanalysisData.html#cb84-8" aria-hidden="true" tabindex="-1"></a>startY <span class="ot">&lt;-</span> <span class="dv">1981</span></span>
<span id="cb84-9"><a href="Data-ClimateReanalysisData.html#cb84-9" aria-hidden="true" tabindex="-1"></a>endY <span class="ot">&lt;-</span> <span class="dv">2013</span></span>
<span id="cb84-10"><a href="Data-ClimateReanalysisData.html#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="Data-ClimateReanalysisData.html#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="fu">biasCorrect_ERA5_CHELSA</span>(dir_ERA5_hourly,dataType_ERA5,dir_CHELSA,startY,endY,basinName,gunt_Shapefile_LatLon)</span></code></pre></div>
<p>In order to understand if the rescaling of the ERA5 data lead to meaningful results, we can compare monthly precipitation totals from the final ERA5 data to monthly station values, average over the four meteorological stations that we have.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="Data-ClimateReanalysisData.html#cb85-1" aria-hidden="true" tabindex="-1"></a>basinName <span class="ot">&lt;-</span> <span class="st">&#39;Gunt&#39;</span></span>
<span id="cb85-2"><a href="Data-ClimateReanalysisData.html#cb85-2" aria-hidden="true" tabindex="-1"></a>dataType_ERA5 <span class="ot">&lt;-</span> <span class="st">&#39;tp&#39;</span> <span class="co"># note that ERA5 tp units are in m!</span></span>
<span id="cb85-3"><a href="Data-ClimateReanalysisData.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Directories of relevant climate files  - function arguments</span></span>
<span id="cb85-4"><a href="Data-ClimateReanalysisData.html#cb85-4" aria-hidden="true" tabindex="-1"></a>dir_ERA5 <span class="ot">&lt;-</span> <span class="st">&#39;../HydrologicalModeling_CentralAsia_Data/CentralAsiaDomain/ERA5/&#39;</span> <span class="co"># Note: ERA5 data in m</span></span>
<span id="cb85-5"><a href="Data-ClimateReanalysisData.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="co"># basin</span></span>
<span id="cb85-6"><a href="Data-ClimateReanalysisData.html#cb85-6" aria-hidden="true" tabindex="-1"></a>basin_shp_latlon <span class="ot">&lt;-</span> gunt_Shapefile_LatLon</span>
<span id="cb85-7"><a href="Data-ClimateReanalysisData.html#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># start and end times - function arguments</span></span>
<span id="cb85-8"><a href="Data-ClimateReanalysisData.html#cb85-8" aria-hidden="true" tabindex="-1"></a>startY <span class="ot">&lt;-</span> <span class="dv">1981</span></span>
<span id="cb85-9"><a href="Data-ClimateReanalysisData.html#cb85-9" aria-hidden="true" tabindex="-1"></a>endY <span class="ot">&lt;-</span> <span class="dv">2013</span></span>
<span id="cb85-10"><a href="Data-ClimateReanalysisData.html#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Date sequence</span></span>
<span id="cb85-11"><a href="Data-ClimateReanalysisData.html#cb85-11" aria-hidden="true" tabindex="-1"></a>sTime <span class="ot">&lt;-</span> <span class="fu">paste0</span>(startY,<span class="st">&#39;-01-01 01:00:00&#39;</span>)</span>
<span id="cb85-12"><a href="Data-ClimateReanalysisData.html#cb85-12" aria-hidden="true" tabindex="-1"></a>eTime <span class="ot">&lt;-</span> <span class="fu">paste0</span>(endY,<span class="st">&#39;-12-31 23:00:00&#39;</span>)</span>
<span id="cb85-13"><a href="Data-ClimateReanalysisData.html#cb85-13" aria-hidden="true" tabindex="-1"></a>dateSeq_ERA <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.POSIXct</span>(sTime), <span class="fu">as.POSIXct</span>(eTime), <span class="at">by=</span><span class="st">&quot;hour&quot;</span>)</span>
<span id="cb85-14"><a href="Data-ClimateReanalysisData.html#cb85-14" aria-hidden="true" tabindex="-1"></a>dateSeq_ERA <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">date=</span>dateSeq_ERA, <span class="at">data=</span><span class="cn">NA</span>)</span>
<span id="cb85-15"><a href="Data-ClimateReanalysisData.html#cb85-15" aria-hidden="true" tabindex="-1"></a>dateSeq_ERA <span class="ot">&lt;-</span> dateSeq_ERA <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(date)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date))</span>
<span id="cb85-16"><a href="Data-ClimateReanalysisData.html#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Create Basin subdirectory (if not already existing) to store dedicated annual files there</span></span>
<span id="cb85-17"><a href="Data-ClimateReanalysisData.html#cb85-17" aria-hidden="true" tabindex="-1"></a>mainDir <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dir_ERA5,dataType_ERA5,<span class="st">&#39;/&#39;</span>,basinName,<span class="st">&#39;/&#39;</span>)</span>
<span id="cb85-18"><a href="Data-ClimateReanalysisData.html#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Start data fetching</span></span>
<span id="cb85-19"><a href="Data-ClimateReanalysisData.html#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (yr <span class="cf">in</span> startY<span class="sc">:</span>endY){</span>
<span id="cb85-20"><a href="Data-ClimateReanalysisData.html#cb85-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># progress indicator</span></span>
<span id="cb85-21"><a href="Data-ClimateReanalysisData.html#cb85-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&#39;PROCESSING YEAR &#39;</span>,yr))</span>
<span id="cb85-22"><a href="Data-ClimateReanalysisData.html#cb85-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># file handling</span></span>
<span id="cb85-23"><a href="Data-ClimateReanalysisData.html#cb85-23" aria-hidden="true" tabindex="-1"></a>  file2Process_ERA <span class="ot">&lt;-</span> <span class="fu">paste0</span>(dataType_ERA5,<span class="st">&#39;_ERA5_hourly_&#39;</span>,basinName,<span class="st">&#39;_bcorr_&#39;</span>,yr,<span class="st">&#39;.nc&#39;</span>)</span>
<span id="cb85-24"><a href="Data-ClimateReanalysisData.html#cb85-24" aria-hidden="true" tabindex="-1"></a>  era_data<span class="ot">&lt;-</span> <span class="fu">brick</span>(<span class="fu">paste0</span>(mainDir,file2Process_ERA))</span>
<span id="cb85-25"><a href="Data-ClimateReanalysisData.html#cb85-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># extract the data over the basin</span></span>
<span id="cb85-26"><a href="Data-ClimateReanalysisData.html#cb85-26" aria-hidden="true" tabindex="-1"></a>  dateSeq_ERA<span class="sc">$</span>data[dateSeq_ERA<span class="sc">$</span>year<span class="sc">==</span>yr] <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">extract</span>(era_data,basin_shp_latlon,<span class="at">fun=</span>mean)</span>
<span id="cb85-27"><a href="Data-ClimateReanalysisData.html#cb85-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-28"><a href="Data-ClimateReanalysisData.html#cb85-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-29"><a href="Data-ClimateReanalysisData.html#cb85-29" aria-hidden="true" tabindex="-1"></a>dateSeq_ERA_mon <span class="ot">&lt;-</span> dateSeq_ERA <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(date,data) </span>
<span id="cb85-30"><a href="Data-ClimateReanalysisData.html#cb85-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-31"><a href="Data-ClimateReanalysisData.html#cb85-31" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (dataType_ERA5<span class="sc">==</span><span class="st">&#39;t2m&#39;</span>){</span>
<span id="cb85-32"><a href="Data-ClimateReanalysisData.html#cb85-32" aria-hidden="true" tabindex="-1"></a>  era5_data_mon <span class="ot">&lt;-</span> dateSeq_ERA_mon <span class="sc">%&gt;%</span> timetk<span class="sc">::</span><span class="fu">summarize_by_time</span>(<span class="at">.date_var =</span> date,<span class="at">.by =</span> <span class="st">&#39;month&#39;</span>,<span class="at">era5_data_mon =</span> <span class="fu">mean</span>(data),<span class="at">.type =</span> <span class="st">&#39;ceiling&#39;</span>)</span>
<span id="cb85-33"><a href="Data-ClimateReanalysisData.html#cb85-33" aria-hidden="true" tabindex="-1"></a>  station_data_mon <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&#39;mean(T)&#39;</span> <span class="sc">&amp;</span> resolution<span class="sc">==</span><span class="st">&#39;mon&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-34"><a href="Data-ClimateReanalysisData.html#cb85-34" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(date,data,code) <span class="sc">%&gt;%</span></span>
<span id="cb85-35"><a href="Data-ClimateReanalysisData.html#cb85-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(date<span class="sc">&gt;=</span>(dateSeq_ERA_mon<span class="sc">$</span>date <span class="sc">%&gt;%</span> <span class="fu">first</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb85-36"><a href="Data-ClimateReanalysisData.html#cb85-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(date<span class="sc">&lt;=</span>(dateSeq_ERA_mon<span class="sc">$</span>date <span class="sc">%&gt;%</span> <span class="fu">last</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb85-37"><a href="Data-ClimateReanalysisData.html#cb85-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;code&#39;</span>,<span class="at">values_from =</span> data) <span class="sc">%&gt;%</span> </span>
<span id="cb85-38"><a href="Data-ClimateReanalysisData.html#cb85-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">station_data_mon =</span> <span class="fu">rowMeans</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(.,<span class="sc">-</span>date),<span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-39"><a href="Data-ClimateReanalysisData.html#cb85-39" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(date,station_data_mon)</span>
<span id="cb85-40"><a href="Data-ClimateReanalysisData.html#cb85-40" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb85-41"><a href="Data-ClimateReanalysisData.html#cb85-41" aria-hidden="true" tabindex="-1"></a>  era5_data_mon <span class="ot">&lt;-</span> dateSeq_ERA_mon <span class="sc">%&gt;%</span> timetk<span class="sc">::</span><span class="fu">summarize_by_time</span>(<span class="at">.date_var =</span> date,<span class="at">.by =</span> <span class="st">&#39;month&#39;</span>,<span class="at">era5_data_mon =</span> <span class="fu">sum</span>(data),<span class="at">.type =</span> <span class="st">&#39;ceiling&#39;</span>)</span>
<span id="cb85-42"><a href="Data-ClimateReanalysisData.html#cb85-42" aria-hidden="true" tabindex="-1"></a>  era5_data_mon<span class="sc">$</span>era5_data_mon <span class="ot">&lt;-</span> era5_data_mon<span class="sc">$</span>era5_data_mon <span class="sc">*</span> <span class="dv">1000</span> <span class="co"># in mm now</span></span>
<span id="cb85-43"><a href="Data-ClimateReanalysisData.html#cb85-43" aria-hidden="true" tabindex="-1"></a>  station_data_mon <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(type<span class="sc">==</span><span class="st">&#39;P&#39;</span> <span class="sc">&amp;</span> resolution<span class="sc">==</span><span class="st">&#39;mon&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-44"><a href="Data-ClimateReanalysisData.html#cb85-44" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(date,data,code) <span class="sc">%&gt;%</span></span>
<span id="cb85-45"><a href="Data-ClimateReanalysisData.html#cb85-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(date<span class="sc">&gt;=</span>(dateSeq_ERA_mon<span class="sc">$</span>date <span class="sc">%&gt;%</span> <span class="fu">first</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb85-46"><a href="Data-ClimateReanalysisData.html#cb85-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(date<span class="sc">&lt;=</span>(dateSeq_ERA_mon<span class="sc">$</span>date <span class="sc">%&gt;%</span> <span class="fu">last</span>())) <span class="sc">%&gt;%</span> </span>
<span id="cb85-47"><a href="Data-ClimateReanalysisData.html#cb85-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">&#39;code&#39;</span>,<span class="at">values_from =</span> data) <span class="sc">%&gt;%</span> </span>
<span id="cb85-48"><a href="Data-ClimateReanalysisData.html#cb85-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">station_data_mon =</span> <span class="fu">rowMeans</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(.,<span class="sc">-</span>date),<span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb85-49"><a href="Data-ClimateReanalysisData.html#cb85-49" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(date,station_data_mon)</span>
<span id="cb85-50"><a href="Data-ClimateReanalysisData.html#cb85-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-51"><a href="Data-ClimateReanalysisData.html#cb85-51" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-52"><a href="Data-ClimateReanalysisData.html#cb85-52" aria-hidden="true" tabindex="-1"></a>era5_data_mon<span class="sc">$</span>date <span class="ot">&lt;-</span> (era5_data_mon<span class="sc">$</span>date <span class="sc">-</span> <span class="dv">3600</span>) <span class="sc">%&gt;%</span> <span class="fu">as.Date</span>()</span>
<span id="cb85-53"><a href="Data-ClimateReanalysisData.html#cb85-53" aria-hidden="true" tabindex="-1"></a>data_validation <span class="ot">&lt;-</span> <span class="fu">full_join</span>(era5_data_mon,station_data_mon,<span class="at">by=</span><span class="st">&#39;date&#39;</span>)</span>
<span id="cb85-54"><a href="Data-ClimateReanalysisData.html#cb85-54" aria-hidden="true" tabindex="-1"></a>data_validation <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>date) <span class="sc">%&gt;%</span> </span>
<span id="cb85-55"><a href="Data-ClimateReanalysisData.html#cb85-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_time_series</span>(<span class="at">.date_var =</span> date,<span class="at">.value =</span> value,<span class="at">.smooth =</span> <span class="cn">FALSE</span>,</span>
<span id="cb85-56"><a href="Data-ClimateReanalysisData.html#cb85-56" aria-hidden="true" tabindex="-1"></a>                   <span class="at">.color_var =</span> name,<span class="at">.title =</span> <span class="st">&quot;&quot;</span>,<span class="at">.x_lab =</span> <span class="st">&quot;Year&quot;</span>,<span class="at">.y_lab =</span> <span class="st">&quot;mm/month&quot;</span>,<span class="at">.interactive =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure"><span id="fig:ComparionERA5rescaledStationTP"></span>
<img src="_bookdown_files/FIG_DATA/Comparison_ERA5rescaled_Station_tp_monthly.jpg" alt="Comparison of mean monthly precipitation values of the Gunt meteorlogical Stations with the rescaled ERA5 data in the basin. The timeseries compare favorably, both in terms of seasonality and interannual variability." width="725" />
<p class="caption">
Figure 5.41: Comparison of mean monthly precipitation values of the Gunt meteorlogical Stations with the rescaled ERA5 data in the basin. The timeseries compare favorably, both in terms of seasonality and interannual variability.
</p>
</div>
</div>
<div id="era5DownscalingDataExportRSMINERVE" class="section level4" number="5.3.2.4">
<h4><span class="header-section-number">5.3.2.4</span> Downscaling ERA5 to Basin Elevation Bands and Data Export to RS MINERVE Database file</h4>
<p>The next and last step for the preparation of the input data required for hydrological modeling in RS MINVERVE involves the downscaling of the prepared hourly ERA5 data to the individual subbasins and elevation bands inside a catchment. The process of generating the input files is shown by using data from the Gunt river basin.</p>
<p>The Gunt river basin outline is shown in Figure <a href="Data-ClimateReanalysisData.html#fig:guntOutline">5.42</a>. We want to downscale the prepared hourly ERA5 climate fields over the domain of the Gunt river basin to the individual subbasins and the elevation bands of these subbasins (see Figures <a href="Data-ClimateReanalysisData.html#fig:guntOutline">5.42</a> to <a href="#fig:guntSubbasinsElevationBands"><strong>??</strong></a> below). In other words, we want to generate hourly climate timeseries of mean temperature and precipitation levels for each subbasin and all of the elevation bands in each subbasin. The hydrological processes of each of these subbasin elevation bands will then be modeled with a separate model. All these individual hydrological models will be interconnected according to the existing flow topology in the basin. Like this, we arrive at a lumped (lumped over the subbasin-specific elevation bands), semi-distributed (distributed between the subbasins and elevation bands) hydrological model of the entire catchment.</p>
<div class="figure"><span id="fig:guntOutline"></span>
<img src="_bookdown_files/FIG_DATA/Gunt_Outline.jpg" alt="The outline of the Gunt river catchment is shown with the key river sections of all tributariies from the corresponding subbasins." width="888" />
<p class="caption">
Figure 5.42: The outline of the Gunt river catchment is shown with the key river sections of all tributariies from the corresponding subbasins.
</p>
</div>
<div class="figure"><span id="fig:guntSubbasins"></span>
<img src="_bookdown_files/FIG_DATA/Gunt_Subbasins.jpg" alt="Gunt river catchment with the individual subbasins is shown. These subbasins are further divided into elevation band zones and the mean climate finally extracted over these subbasin-specfic elevation bands (see Figure 5.44)." width="888" />
<p class="caption">
Figure 5.43: Gunt river catchment with the individual subbasins is shown. These subbasins are further divided into elevation band zones and the mean climate finally extracted over these subbasin-specfic elevation bands (see Figure <span class="citation">(<a href="#ref-ref" role="doc-biblioref"><strong>ref?</strong></a>)</span>(fig:guntSubasinsElevationBands)).
</p>
</div>
<div class="figure"><span id="fig:guntSubasinsElevationBands"></span>
<img src="_bookdown_files/FIG_DATA/Gunt_Subbasins_ElevationBands.jpg" alt="The Gunt river catchment elevation bands are shown in red color. The entire catchment was divided into 4 altitude zones with an interval spacing of 1'000 meters. In real world climate impact studies, elevation bands are normally generated with an interval spacing of 200 - 500 meters." width="888" />
<p class="caption">
Figure 5.44: The Gunt river catchment elevation bands are shown in red color. The entire catchment was divided into 4 altitude zones with an interval spacing of 1’000 meters. In real world climate impact studies, elevation bands are normally generated with an interval spacing of 200 - 500 meters.
</p>
</div>
<div class="figure"><span id="fig:guntSubbasinsNamingConvention"></span>
<img src="_bookdown_files/FIG_DATA/Gunt_Topology.jpg" alt="The naming concention of the subbasins is shown. For each subbasin, the bands are identified with a suffix .._b1 for elevation band 1, .._b2 for elevation band 2 and so on." width="888" />
<p class="caption">
Figure 5.45: The naming concention of the subbasins is shown. For each subbasin, the bands are identified with a suffix .._b1 for elevation band 1, .._b2 for elevation band 2 and so on.
</p>
</div>
<div class="figure"><span id="fig:bandAttributeTable"></span>
<img src="_bookdown_files/FIG_DATA/Gunt_ElevationBands_AttributeTable.jpg" alt="Subbasin elevation band attribute table. In total there are 14 elevation bands and for each elevation band, a climate time series is created with the function `riversCentralAsia::generate_ERA5_Subbasins_CSV()`. The Z field is important and specifies the average elevation of the corresponding elevation band for each subbasin." width="399" />
<p class="caption">
Figure 5.46: Subbasin elevation band attribute table. In total there are 14 elevation bands and for each elevation band, a climate time series is created with the function <code>riversCentralAsia::generate_ERA5_Subbasins_CSV()</code>. The Z field is important and specifies the average elevation of the corresponding elevation band for each subbasin.
</p>
</div>
<p>The code block assumes that the previously described steps have been carried and that the corresponding files are stored in the correct relative path locations. First, ERA5 precipitation is downscaled with <code>generate_ERA5_Subbasin_CSV(...)</code> with <code>dataType='tp'</code> set. Second, <code>dataType='t2m'</code> for the downscaling of the 2 meter above surface ERA5 temperature. In a third step, we add the discharge data to the resulting data frame in the last column. Finally, the observed discharge data is added. Note here that we add the gap filled time series of the observational record. The process of gap filling discharge data is described in Section <a href="Data-StationData.html#StationData::GapFilling">5.1.2</a> above.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="Data-ClimateReanalysisData.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Housekeeping</span></span>
<span id="cb86-2"><a href="Data-ClimateReanalysisData.html#cb86-2" aria-hidden="true" tabindex="-1"></a>dir_ERA5 <span class="ot">&lt;-</span> <span class="st">&#39;../HydrologicalModeling_CentralAsia_Data/CentralAsiaDomain/ERA5/&#39;</span></span>
<span id="cb86-3"><a href="Data-ClimateReanalysisData.html#cb86-3" aria-hidden="true" tabindex="-1"></a>catchmentName <span class="ot">&lt;-</span> <span class="st">&#39;Gunt&#39;</span></span>
<span id="cb86-4"><a href="Data-ClimateReanalysisData.html#cb86-4" aria-hidden="true" tabindex="-1"></a>elBands_shp <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&#39;../HydrologicalModeling_CentralAsia_Data/AmuDarya/Gunt/GeospatialData/Gunt_ElevationBands_Subbasins_RSMinerve.shp&#39;</span>)</span>
<span id="cb86-5"><a href="Data-ClimateReanalysisData.html#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="Data-ClimateReanalysisData.html#cb86-6" aria-hidden="true" tabindex="-1"></a>startY <span class="ot">&lt;-</span> <span class="dv">1981</span></span>
<span id="cb86-7"><a href="Data-ClimateReanalysisData.html#cb86-7" aria-hidden="true" tabindex="-1"></a>endY <span class="ot">&lt;-</span> <span class="dv">2013</span></span>
<span id="cb86-8"><a href="Data-ClimateReanalysisData.html#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="Data-ClimateReanalysisData.html#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Downscaling precipitation</span></span>
<span id="cb86-10"><a href="Data-ClimateReanalysisData.html#cb86-10" aria-hidden="true" tabindex="-1"></a>dataType <span class="ot">&lt;-</span> <span class="st">&#39;tp&#39;</span> <span class="co"># Precipitation</span></span>
<span id="cb86-11"><a href="Data-ClimateReanalysisData.html#cb86-11" aria-hidden="true" tabindex="-1"></a>gunt_db_tp <span class="ot">&lt;-</span> <span class="fu">generate_ERA5_Subbasin_CSV</span>(dir_ERA5_hourly,catchmentName,dataType,elBands_shp,startY,endY)</span>
<span id="cb86-12"><a href="Data-ClimateReanalysisData.html#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Downscaling temperature</span></span>
<span id="cb86-13"><a href="Data-ClimateReanalysisData.html#cb86-13" aria-hidden="true" tabindex="-1"></a>dataType <span class="ot">&lt;-</span> <span class="st">&#39;t2m&#39;</span> <span class="co"># Temperature</span></span>
<span id="cb86-14"><a href="Data-ClimateReanalysisData.html#cb86-14" aria-hidden="true" tabindex="-1"></a>gunt_db_t2m <span class="ot">&lt;-</span> <span class="fu">generate_ERA5_Subbasin_CSV</span>(dir_ERA5_hourly,catchmentName,dataType,elBands_shp,startY,endY)</span>
<span id="cb86-15"><a href="Data-ClimateReanalysisData.html#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Joining the two data frames.</span></span>
<span id="cb86-16"><a href="Data-ClimateReanalysisData.html#cb86-16" aria-hidden="true" tabindex="-1"></a>gunt_db <span class="ot">&lt;-</span> gunt_db_t2m <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(gunt_db_tp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Station),<span class="at">.name_repair =</span> <span class="st">&#39;unique&#39;</span>) </span>
<span id="cb86-17"><a href="Data-ClimateReanalysisData.html#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Adding the observed discharge data in the required format to the data frame</span></span>
<span id="cb86-18"><a href="Data-ClimateReanalysisData.html#cb86-18" aria-hidden="true" tabindex="-1"></a>gunt_db_Q <span class="ot">&lt;-</span> q_17050_mon_filled <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(date,data) </span>
<span id="cb86-19"><a href="Data-ClimateReanalysisData.html#cb86-19" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>date <span class="ot">&lt;-</span> gunt_db_Q<span class="sc">$</span>date <span class="sc">%&gt;%</span> <span class="fu">as.POSIXct</span>() <span class="sc">+</span> <span class="dv">22</span> <span class="sc">*</span> <span class="dv">60</span> <span class="sc">*</span> <span class="dv">60</span> <span class="co"># just adding time so that we are indeed at the end of the month </span></span>
<span id="cb86-20"><a href="Data-ClimateReanalysisData.html#cb86-20" aria-hidden="true" tabindex="-1"></a>datesChar_Q <span class="ot">&lt;-</span> <span class="fu">posixct2rsminerveChar</span>(gunt_db_Q<span class="sc">$</span>date) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Station=</span>value)</span>
<span id="cb86-21"><a href="Data-ClimateReanalysisData.html#cb86-21" aria-hidden="true" tabindex="-1"></a>datesChar_Q <span class="ot">&lt;-</span> datesChar_Q <span class="sc">%&gt;%</span> <span class="fu">add_column</span>(<span class="at">Q_17050 =</span> (gunt_db_Q<span class="sc">$</span>data <span class="sc">%&gt;%</span> as.character))</span>
<span id="cb86-22"><a href="Data-ClimateReanalysisData.html#cb86-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-23"><a href="Data-ClimateReanalysisData.html#cb86-23" aria-hidden="true" tabindex="-1"></a>gunt_db_Q <span class="ot">&lt;-</span> <span class="fu">full_join</span>(gunt_db,datesChar_Q,<span class="at">by=</span><span class="st">&#39;Station&#39;</span>) <span class="co"># this works well</span></span>
<span id="cb86-24"><a href="Data-ClimateReanalysisData.html#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="co"># now finish off by giving the required attributes in the table for the discharge station</span></span>
<span id="cb86-25"><a href="Data-ClimateReanalysisData.html#cb86-25" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>Q_17050[<span class="dv">1</span>] <span class="ot">=</span> <span class="st">&#39;Q_17050&#39;</span></span>
<span id="cb86-26"><a href="Data-ClimateReanalysisData.html#cb86-26" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>Q_17050[<span class="dv">2</span>] <span class="ot">=</span> meteoStations<span class="sc">$</span>utm.x[<span class="dv">2</span>]</span>
<span id="cb86-27"><a href="Data-ClimateReanalysisData.html#cb86-27" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>Q_17050[<span class="dv">3</span>] <span class="ot">=</span> meteoStations<span class="sc">$</span>utm.y[<span class="dv">2</span>]</span>
<span id="cb86-28"><a href="Data-ClimateReanalysisData.html#cb86-28" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>Q_17050[<span class="dv">4</span>] <span class="ot">=</span> meteoStations<span class="sc">$</span>masl[<span class="dv">2</span>]</span>
<span id="cb86-29"><a href="Data-ClimateReanalysisData.html#cb86-29" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>Q_17050[<span class="dv">5</span>] <span class="ot">=</span> <span class="st">&#39;Q&#39;</span></span>
<span id="cb86-30"><a href="Data-ClimateReanalysisData.html#cb86-30" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>Q_17050[<span class="dv">6</span>] <span class="ot">=</span> <span class="st">&#39;Flow&#39;</span></span>
<span id="cb86-31"><a href="Data-ClimateReanalysisData.html#cb86-31" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>Q_17050[<span class="dv">7</span>] <span class="ot">=</span> <span class="st">&#39;m3/s&#39;</span></span>
<span id="cb86-32"><a href="Data-ClimateReanalysisData.html#cb86-32" aria-hidden="true" tabindex="-1"></a>gunt_db_Q<span class="sc">$</span>Q_17050[<span class="dv">8</span>] <span class="ot">=</span> <span class="st">&#39;Constant before&#39;</span></span></code></pre></div>
<p>The resulting data frame can be stored with <code>write.table(..,..,sep=',',row.names = FALSE,col.names=FALSE,quote=FALSE)</code> as a csv-file and the read into RS MINERVE later. A screenshot of the csv-file is below in Figure <a href="Data-ClimateReanalysisData.html#fig:guntCSVFile">5.47</a>. Elevation band-specific temperature (T) and precipitation (P) data are stored in columns. The last column contains the discharge data Q. If more than one observation station are available, more discharge columns would correspondingly need to be added.</p>
<p>In row 1 - 8, elevation band specific information is stored. More specifically, the following information is contained:</p>
<ul>
<li><p>Row 1: Name of elevation band and discharge station(s)</p></li>
<li><p>Row 2: Longitude of centroid of elevation band and location of gauging station(s) (in meters, UTM)</p></li>
<li><p>Row 3: Latitude of centroid of elevation band and location of gauging station(s) (in meters, UTM)</p></li>
<li><p>Row 4: Mean elevation across elevation band and elevation of gauging station(s)</p></li>
<li><p>Row 5: Observation type indicator (T: temperature, P: precipitation and Q: discharge)</p></li>
<li><p>Row 6: Category</p></li>
<li><p>Row 7: Measurement units</p></li>
<li><p>Row 8: Interpolation method for downsampling course resolution time series<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a></p></li>
</ul>
<div class="figure"><span id="fig:guntCSVFile"></span>
<img src="_bookdown_files/FIG_DATA/gunt_RSMINERVE_CSV.jpg" alt="Screenshot of the resulting large csv file that can be read into RS MINERVE. " width="1571" />
<p class="caption">
Figure 5.47: Screenshot of the resulting large csv file that can be read into RS MINERVE.
</p>
</div>
<p>From rows 9 onward, the actual data are stored where a time stamp in the first column corresponds to the corresponding observation data and time.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="6">
<li id="fn6"><p>Please note that the total size of this repository is 2 GB, approximately. Prior to downloading these data, you should ensure that you have enough storage space on your local machine. Furthermore, it is advised that you create the directory structure in the following way:</p>
<p><strong>FILES/PROJECT</strong><br />
-<strong>Code</strong><br />
—yourRProject.Rproj<br />
—code1.R<br />
—…<br />
-<strong>HydrologicalModeling_CentralAsia_Data</strong><br />
—<br />
</p>
<p>where FILES/PROJECT is the folder where you keep your documents on your computer and project denotes the folder name of your project, Code is the folder where all your code lives and HydrologicalModeling_CentralAsia_Data is the folder where you store all the accompanying data that can downloaded.<a href="Data-ClimateReanalysisData.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>The code for the computation of the CHELSA long-term monthly mean temperature and precipitation climatologies is provided in the Appendix C in the corresponding Sect.<a href="Data-ClimateReanalysisData.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>Please note that one raster brick that encompasses the data for one year is approx 333 MB to download!<a href="Data-ClimateReanalysisData.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>This is for example used to downsample monthly discharge as provided by the hydrometeorological agency to hourly discharge (we use hourly simulation time steps in the hydrological model).<a href="Data-ClimateReanalysisData.html#fnref9" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="Data-GeospatialData.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="data-on-climate-projections.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07_DATA.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["applied-hydrological-modeling-central-asia.pdf", "applied-hydrological-modeling-central-asia.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
