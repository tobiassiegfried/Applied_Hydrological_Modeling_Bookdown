[
["retrieval-analysis-of-data.html", "Chapter 4 Retrieval &amp; Analysis of Data Prerequisites 4.1 Geospatial Data 4.2 Climate Data 4.3 Hydrological Data", " Chapter 4 Retrieval &amp; Analysis of Data Prerequisites This Chapter requires the following R packages to be installed. If you are running R in RStudio and some of the packages are not yet installed on your computer, RStudio will warn you and ask, whether you want to have them installed. Here I change something. # Tidyverse library(tidyverse) # File navigation library(here) # Copernicus Climate Data Store library(ecmwfr) library(keyring) # Handling netcdf files library(ncdf4) # Spatial data plotting &amp; plotting library(rgdal) library(raster) library(rgeos) library(sp) library(sf) library(rasterVis) library(RColorBrewer) 4.1 Geospatial Data 4.2 Climate Data 4.2.1 Access, Select and Download ERA5 Reanalysis Data For the climate data to be used in the modeling approach, we use ERA5 data from the European Center for Medium-Range Weather Forecasts (ECMWF, &lt;www.ecmwf.int&gt;). ERA5, the successor to ERA-Interim, provides global, hourly estimates of atmospheric variables, at a horizontal resolution of 31 km and 137 vertical levels from the surface to 0.01 hPa (Dee D. 2020). ERA5 presently extends back to 1979 but will ultimately be extended back to 19501. The ERA5 data is available via the Copernicus Climate Store at https://cds.climate.copernicus.eu. However, before we can access, select and download it there, each user has to register with a personal account in the store. For this purpose, the user should navigate to the website and register via the Login/Register/NewAccount Menu. You will receive an email once your account is ready. Log in to your account and go to your user profile where you find your user ID and API key. The relevant information should be copied and into the relevant places of the code chunk below and then be executed. #Note: replace the UID and key strings below with the proper user&#39;s information in your Copernicus Climate Data Store account. UID &lt;- &#39;UID&#39; API_key &lt;- &#39;key&#39; #This function links your password and user id for later steps wf_set_key(UID, API_key, &#39;cds&#39;) //TODO: output still showing. How to deal with it? If all worked well, you will get the following confirmation in the console: ## User UID for cds service added successfully On the Copernicus website, make sure that you are logged into your account and the navigate to Datasets. There, search for the Product ‘ERA5-Land monthly averaged data from 1981 to present’ and select it2. You end up on the products homepage where you can get more information and download the data via a form where you select the product’s type, variables, the years, months and time of day, the geographical area and, finally, the download file format of interest. Please select the following: Product type: Monthly averaged reanalysis Variable: Temperature: 2 m Temperature Lakes: NA Snow: NA Soil Water: NA Radiation and Heat: NA Evaporation and Runoff: Potential evaporation Wind, Pressure and Precipitation: Total precipitation Vegetation: NA Year: Select all Month: Select all Time: 00:00 Geographical area: Sub-region extraction (West = 65, East = 80, South = 35, North = 45) Format: NetCDF (experimental) Accept the Terms of use and press the ‘Show API request button’. You should see the following Python request now as shown in Figure 4.1. Figure 4.1: Screenshot showing the Copernicus Data Store API request that can be copied and posted into RStudio for the convenient download of the data there. The request should be copied and pasted into RStudio into your current .Rmd file there. Select the python request with the cursor and choose ‘ECMWFR/Python to List’ under the Addins Menu. The python request will then automatically be translated into a an r command. Please check that everything is ok by comparing it with a correct request as shown below. Also, please note that we have changed the target file name by specifying target = reanalysis-era5-land-monthly-means_CentralAsia.nc. In a final step, the user can then download the data with the wf_request() function. # Here is is the resulting request in R language request &lt;- list(&quot;dataset_short_name&quot; = &quot;reanalysis-era5-land-monthly-means&quot;, format = &quot;netcdf&quot;, product_type = &quot;monthly_averaged_reanalysis&quot;, variable = c(&#39;2m_temperature&#39;, &#39;potential_evaporation&#39;, &#39;total_precipitation&#39;), year = c(&#39;1981&#39;, &#39;1982&#39;, &#39;1983&#39;, &#39;1984&#39;, &#39;1985&#39;, &#39;1986&#39;, &#39;1987&#39;, &#39;1988&#39;, &#39;1989&#39;, &#39;1990&#39;, &#39;1991&#39;, &#39;1992&#39;, &#39;1993&#39;, &#39;1994&#39;, &#39;1995&#39;, &#39;1996&#39;, &#39;1997&#39;, &#39;1998&#39;, &#39;1999&#39;, &#39;2000&#39;, &#39;2001&#39;, &#39;2002&#39;, &#39;2003&#39;, &#39;2004&#39;, &#39;2005&#39;, &#39;2006&#39;, &#39;2007&#39;, &#39;2008&#39;, &#39;2009&#39;, &#39;2010&#39;, &#39;2011&#39;, &#39;2012&#39;, &#39;2013&#39;, &#39;2014&#39;, &#39;2015&#39;, &#39;2016&#39;, &#39;2017&#39;, &#39;2018&#39;, &#39;2019&#39;, &#39;2020&#39;), month = c(&quot;01&quot;, &quot;02&quot;, &quot;03&quot;, &quot;04&quot;, &quot;05&quot;, &quot;06&quot;, &quot;07&quot;, &quot;08&quot;, &quot;09&quot;, &quot;10&quot;, &quot;11&quot;, &quot;12&quot;), time = &quot;00:00&quot;, area = &quot;45/65/35/80&quot;, #dataset = &quot;reanalysis-era5-land-monthly-means&quot;, target = &quot;reanalysis-era5-land-monthly-means_CentralAsia.nc&quot; ) # Download data as netcdf file and store it in the directory where you are running this script, this returns the path to the file ncfilelink &lt;- wf_request(user = UID, request = request, transfer = TRUE, path = here(), verbose = TRUE) ## [1] &quot;moved temporary file to -&gt; /.../reanalysis-era5-land-monthly-means_CentralAsia.nc&quot; ## [1] &quot;request purged from queue!&quot; Some Sources on NetCDF and raster files: Here are some good resources to get you started: https://pjbartlein.github.io/REarthSysSci/index.html and https://cmerow.github.io/RDataScience/05_Raster.html. 4.3 Hydrological Data //TODO: Show added value from consulting data from altimetry https://dahiti.dgfi.tum.de/en/map/ References "]
]
