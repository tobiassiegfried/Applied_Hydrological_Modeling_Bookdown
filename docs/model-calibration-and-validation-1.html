<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.5 Model Calibration and Validation | Applied Modeling of Hydrological Systems in Central Asia</title>
  <meta name="description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="5.5 Model Calibration and Validation | Applied Modeling of Hydrological Systems in Central Asia" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.5 Model Calibration and Validation | Applied Modeling of Hydrological Systems in Central Asia" />
  
  <meta name="twitter:description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  

<meta name="author" content="Tobias Siegfried" />


<meta name="date" content="2021-04-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-hbv-model.html"/>
<link rel="next" href="application-investigating-climate-change-impacts.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Hydrological Modeling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="part"><span><b>I Part I Hydrological Systems</b></span></li>
<li class="chapter" data-level="1" data-path="ShortHistory.html"><a href="ShortHistory.html"><i class="fa fa-check"></i><b>1</b> Short History of Water in Central Asia</a>
<ul>
<li class="chapter" data-level="1.1" data-path="TamingHydrologicalSystems.html"><a href="TamingHydrologicalSystems.html"><i class="fa fa-check"></i><b>1.1</b> The Taming of the Central Asian Rivers</a></li>
<li class="chapter" data-level="1.2" data-path="PostTransitionDevelopmentsChallenges.html"><a href="PostTransitionDevelopmentsChallenges.html"><i class="fa fa-check"></i><b>1.2</b> Post-Transition Development and Challenges</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="HydrologicalSystems.html"><a href="HydrologicalSystems.html"><i class="fa fa-check"></i><b>2</b> Hydrological Systems in Central Asia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regional-hydro-climatological-features.html"><a href="regional-hydro-climatological-features.html"><i class="fa fa-check"></i><b>2.1</b> Regional Hydro-Climatological Features</a></li>
<li class="chapter" data-level="2.2" data-path="chap-regionalWaterBalance.html"><a href="chap-regionalWaterBalance.html"><i class="fa fa-check"></i><b>2.2</b> Regional Water Balance</a></li>
<li class="chapter" data-level="2.3" data-path="runoff-formation.html"><a href="runoff-formation.html"><i class="fa fa-check"></i><b>2.3</b> Runoff Formation</a></li>
<li class="chapter" data-level="2.4" data-path="average-multi-year-runoff.html"><a href="average-multi-year-runoff.html"><i class="fa fa-check"></i><b>2.4</b> Average Multi-Year Runoff</a></li>
<li class="chapter" data-level="2.5" data-path="annual-runoff-fluctuations.html"><a href="annual-runoff-fluctuations.html"><i class="fa fa-check"></i><b>2.5</b> Annual Runoff Fluctuations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="CaseStudies.html"><a href="CaseStudies.html"><i class="fa fa-check"></i><b>3</b> Case Studies</a>
<ul>
<li class="chapter" data-level="3.1" data-path="GuntRB.html"><a href="GuntRB.html"><i class="fa fa-check"></i><b>3.1</b> Gunt River Basin</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="GuntRB.html"><a href="GuntRB.html#GuntRBOverview"><i class="fa fa-check"></i><b>3.1.1</b> Basin Characterization</a></li>
<li class="chapter" data-level="3.1.2" data-path="GuntRB.html"><a href="GuntRB.html#GuntHyrology"><i class="fa fa-check"></i><b>3.1.2</b> Hydrology</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="CRB.html"><a href="CRB.html"><i class="fa fa-check"></i><b>3.2</b> Chirchik River Basin</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="CRB.html"><a href="CRB.html#CRBOverview"><i class="fa fa-check"></i><b>3.2.1</b> Basin Characterization</a></li>
<li class="chapter" data-level="3.2.2" data-path="CRB.html"><a href="CRB.html#CRBBasinCharacteristics"><i class="fa fa-check"></i><b>3.2.2</b> Hydrology</a></li>
<li class="chapter" data-level="3.2.3" data-path="CRB.html"><a href="CRB.html#CRB_KoskuDischargeContribution"><i class="fa fa-check"></i><b>3.2.3</b> Discharge Estimation from the Ungauged Kosku Tributary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="Part2-Applied-Modeling.html"><a href="Part2-Applied-Modeling.html"><i class="fa fa-check"></i>(PART) Part II Applied Modeling</a>
<ul>
<li class="chapter" data-level="3.3" data-path="LongTermWaterBalance.html"><a href="LongTermWaterBalance.html"><i class="fa fa-check"></i><b>3.3</b> Budyko-Type Long-term Water Balance Modeling</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="LongTermWaterBalance.html"><a href="LongTermWaterBalance.html#derivation-of-the-budyko-relationship"><i class="fa fa-check"></i><b>3.3.1</b> Derivation of the Budyko Relationship</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="effects-of-snow-ratio-on-annual-runoff-within-the-budyko-framework.html"><a href="effects-of-snow-ratio-on-annual-runoff-within-the-budyko-framework.html"><i class="fa fa-check"></i><b>3.4</b> Effects of Snow Ratio on Annual Runoff within the Budyko Framework</a></li>
<li class="chapter" data-level="3.5" data-path="hydrological-response-to-a-changing-climate.html"><a href="hydrological-response-to-a-changing-climate.html"><i class="fa fa-check"></i><b>3.5</b> Hydrological Response to a Changing Climate</a></li>
<li class="chapter" data-level="3.6" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html"><i class="fa fa-check"></i><b>3.6</b> Application to Central Asian River Basins</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#data"><i class="fa fa-check"></i><b>3.6.1</b> Data</a></li>
<li class="chapter" data-level="3.6.2" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#model"><i class="fa fa-check"></i><b>3.6.2</b> Model</a></li>
<li class="chapter" data-level="3.6.3" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#conclusions"><i class="fa fa-check"></i><b>3.6.3</b> Conclusions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="Chapter-DATA.html"><a href="Chapter-DATA.html"><i class="fa fa-check"></i><b>4</b> Data Retrieval, Preparation &amp; Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="Data-StationData.html"><a href="Data-StationData.html"><i class="fa fa-check"></i><b>4.1</b> Station Data</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="Data-StationData.html"><a href="Data-StationData.html#Chap9AvailableData"><i class="fa fa-check"></i><b>4.1.1</b> Available Data</a></li>
<li class="chapter" data-level="4.1.2" data-path="Data-StationData.html"><a href="Data-StationData.html#StationData::GapFilling"><i class="fa fa-check"></i><b>4.1.2</b> Gap Filling Discharge Data</a></li>
<li class="chapter" data-level="4.1.3" data-path="Data-StationData.html"><a href="Data-StationData.html#Chap9DataPreparationPT"><i class="fa fa-check"></i><b>4.1.3</b> Gap Filling Meteorological Data</a></li>
<li class="chapter" data-level="4.1.4" data-path="Data-StationData.html"><a href="Data-StationData.html#Chap9AnomaliesOutliers"><i class="fa fa-check"></i><b>4.1.4</b> Anomalies and Outliers</a></li>
<li class="chapter" data-level="4.1.5" data-path="Data-StationData.html"><a href="Data-StationData.html#Chap9_FinalData"><i class="fa fa-check"></i><b>4.1.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html"><i class="fa fa-check"></i><b>4.2</b> Geospatial Data</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#section-steps-setting-up"><i class="fa fa-check"></i><b>4.2.1</b> Setting up QGIS</a></li>
<li class="chapter" data-level="4.2.2" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#load-dem"><i class="fa fa-check"></i><b>4.2.2</b> Load DEM</a></li>
<li class="chapter" data-level="4.2.3" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#section-steps-derive-catchment-boundaries"><i class="fa fa-check"></i><b>4.2.3</b> Derive the boundaries of your catchment</a></li>
<li class="chapter" data-level="4.2.4" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#run-through-the-process-model"><i class="fa fa-check"></i><b>4.2.4</b> Run through the process model</a></li>
<li class="chapter" data-level="4.2.5" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#manually-edit-the-gis-layers-for-import-to-rs-minerve"><i class="fa fa-check"></i><b>4.2.5</b> Manually edit the GIS Layers for import to RS Minerve</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html"><i class="fa fa-check"></i><b>4.3</b> Climate Reanalysis Data</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html#Data::CHELSA"><i class="fa fa-check"></i><b>4.3.1</b> CHELSA V1.2.1 Data and Bias Correction</a></li>
<li class="chapter" data-level="4.3.2" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html#Data::ERA5"><i class="fa fa-check"></i><b>4.3.2</b> ERA5 Download and Data Resampling with PBCORR CHELSA</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html"><i class="fa fa-check"></i><b>4.4</b> Data on Climate Projections</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html#high-resolution-monthly-climate-time-series-for-2006---2100"><i class="fa fa-check"></i><b>4.4.1</b> High Resolution Monthly Climate Time Series for 2006 - 2100</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html#using-a-weather-generator-to-simulate-daily-future-climate"><i class="fa fa-check"></i><b>4.4.2</b> Using a Weather Generator to Simulate Daily Future Climate</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="snow-cover-data.html"><a href="snow-cover-data.html"><i class="fa fa-check"></i><b>4.5</b> Snow Cover Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="RSMinerveMODELS.html"><a href="RSMinerveMODELS.html"><i class="fa fa-check"></i><b>5</b> Hydrological-Hydraulic Modeling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="section-rsminerve-prerequisites.html"><a href="section-rsminerve-prerequisites.html"><i class="fa fa-check"></i><b>5.1</b> Prerequisites</a></li>
<li class="chapter" data-level="5.2" data-path="section-rsminerve-why-model-introduction.html"><a href="section-rsminerve-why-model-introduction.html"><i class="fa fa-check"></i><b>5.2</b> Recap: Hydrological response</a></li>
<li class="chapter" data-level="5.3" data-path="data-preparation-and-setup.html"><a href="data-preparation-and-setup.html"><i class="fa fa-check"></i><b>5.3</b> Data Preparation and Setup</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-preparation-and-setup.html"><a href="data-preparation-and-setup.html#examining-and-understanding-the-gis-data"><i class="fa fa-check"></i><b>5.3.1</b> Examining and Understanding the GIS Data</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-preparation-and-setup.html"><a href="data-preparation-and-setup.html#loading-gis-data-and-model-creation"><i class="fa fa-check"></i><b>5.3.2</b> Loading GIS Data and Model Creation</a></li>
<li class="chapter" data-level="5.3.3" data-path="data-preparation-and-setup.html"><a href="data-preparation-and-setup.html#climate-data"><i class="fa fa-check"></i><b>5.3.3</b> Climate Data</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="section-hbv-model.html"><a href="section-hbv-model.html"><i class="fa fa-check"></i><b>5.4</b> The HBV model</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="section-hbv-model.html"><a href="section-hbv-model.html#section-hbv-nauvalisoy-tutorial-short"><i class="fa fa-check"></i><b>5.4.1</b> HBV example: Simple model of the Nauvalisoy river catchment</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="model-calibration-and-validation-1.html"><a href="model-calibration-and-validation-1.html"><i class="fa fa-check"></i><b>5.5</b> Model Calibration and Validation</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="model-calibration-and-validation-1.html"><a href="model-calibration-and-validation-1.html#section-calibration-principles"><i class="fa fa-check"></i><b>5.5.1</b> Basic Principles</a></li>
<li class="chapter" data-level="5.5.2" data-path="model-calibration-and-validation-1.html"><a href="model-calibration-and-validation-1.html#secion-calibration-practical-steps"><i class="fa fa-check"></i><b>5.5.2</b> Practical Steps</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="application-investigating-climate-change-impacts.html"><a href="application-investigating-climate-change-impacts.html"><i class="fa fa-check"></i><b>5.6</b> Application: Investigating Climate Change Impacts</a></li>
<li class="chapter" data-level="5.7" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>5.7</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="HydroModelsEmpiricalModels.html"><a href="HydroModelsEmpiricalModels.html"><i class="fa fa-check"></i><b>6</b> Discharge Forecasting with Predictive Inference</a>
<ul>
<li class="chapter" data-level="" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="6.1" data-path="Chap9PredictiveInference.html"><a href="Chap9PredictiveInference.html"><i class="fa fa-check"></i><b>6.1</b> Forecasting Using Predictive Inference</a></li>
<li class="chapter" data-level="6.2" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html"><i class="fa fa-check"></i><b>6.2</b> Forecasting in the Central Asian Hydromets</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html#background"><i class="fa fa-check"></i><b>6.2.1</b> Background</a></li>
<li class="chapter" data-level="6.2.2" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html#forecasting-for-what-and-whom"><i class="fa fa-check"></i><b>6.2.2</b> Forecasting for What and Whom?</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html"><i class="fa fa-check"></i><b>6.3</b> Data and Preparation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="Data-StationData.html"><a href="Data-StationData.html#Chap9AvailableData"><i class="fa fa-check"></i><b>6.3.1</b> Available Data</a></li>
<li class="chapter" data-level="6.3.2" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9DataPreparationQ"><i class="fa fa-check"></i><b>6.3.2</b> Gap Filling Discharge Data</a></li>
<li class="chapter" data-level="6.3.3" data-path="Data-StationData.html"><a href="Data-StationData.html#Chap9DataPreparationPT"><i class="fa fa-check"></i><b>6.3.3</b> Gap Filling Meteorological Data</a></li>
<li class="chapter" data-level="6.3.4" data-path="Data-StationData.html"><a href="Data-StationData.html#Chap9AnomaliesOutliers"><i class="fa fa-check"></i><b>6.3.4</b> Anomalies and Outliers</a></li>
<li class="chapter" data-level="6.3.5" data-path="Data-StationData.html"><a href="Data-StationData.html#Chap9_FinalData"><i class="fa fa-check"></i><b>6.3.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html"><i class="fa fa-check"></i><b>6.4</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap_9_DataTransformation"><i class="fa fa-check"></i><b>6.4.1</b> Data Transformation</a></li>
<li class="chapter" data-level="6.4.2" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_Trends"><i class="fa fa-check"></i><b>6.4.2</b> Detecting Trends</a></li>
<li class="chapter" data-level="6.4.3" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_Autocorrelations"><i class="fa fa-check"></i><b>6.4.3</b> Auto- and Crosscorrelations</a></li>
<li class="chapter" data-level="6.4.4" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_SeasonalityAnalysis"><i class="fa fa-check"></i><b>6.4.4</b> Time Series Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html"><i class="fa fa-check"></i><b>6.5</b> Investigating and Engineering Predictors</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_CurrentPractice"><i class="fa fa-check"></i><b>6.5.1</b> Benchmark: Current Operational Forecasting Models in the Hydrometeorological Agencies</a></li>
<li class="chapter" data-level="6.5.2" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_TSR"><i class="fa fa-check"></i><b>6.5.2</b> Time Series Regression Models</a></li>
<li class="chapter" data-level="6.5.3" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_ForecastQuality"><i class="fa fa-check"></i><b>6.5.3</b> Assessing the Quality of Forecasts</a></li>
<li class="chapter" data-level="6.5.4" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#generating-and-assessing-out-of-sample-forecasts"><i class="fa fa-check"></i><b>6.5.4</b> Generating and Assessing Out-of-Sample Forecasts</a></li>
<li class="chapter" data-level="6.5.5" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_MLM"><i class="fa fa-check"></i><b>6.5.5</b> Machine Learning Models</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="save-data-for-hot-start.html"><a href="save-data-for-hot-start.html"><i class="fa fa-check"></i><b>6.6</b> Save Data for Hot Start</a></li>
</ul></li>
<li class="part"><span><b>II Part III Model Operationalization</b></span></li>
<li class="chapter" data-level="7" data-path="Operationalization.html"><a href="Operationalization.html"><i class="fa fa-check"></i><b>7</b> Operationalization of Models - Opportunities and Challenges</a>
<ul>
<li class="chapter" data-level="7.1" data-path="co-design-phase.html"><a href="co-design-phase.html"><i class="fa fa-check"></i><b>7.1</b> Co-design Phase</a></li>
<li class="chapter" data-level="7.2" data-path="modeling-phase.html"><a href="modeling-phase.html"><i class="fa fa-check"></i><b>7.2</b> Modeling Phase</a></li>
<li class="chapter" data-level="7.3" data-path="testing-phase.html"><a href="testing-phase.html"><i class="fa fa-check"></i><b>7.3</b> Testing Phase</a></li>
<li class="chapter" data-level="7.4" data-path="operational-deployment.html"><a href="operational-deployment.html"><i class="fa fa-check"></i><b>7.4</b> Operational Deployment</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ChapterAppendix.html"><a href="ChapterAppendix.html"><i class="fa fa-check"></i><b>8</b> (APPENDIX) Appendix</a>
<ul>
<li class="chapter" data-level="8.1" data-path="appendix-a-open-source-resources.html"><a href="appendix-a-open-source-resources.html"><i class="fa fa-check"></i><b>8.1</b> Appendix A: Open-source resources</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="appendix-a-open-source-resources.html"><a href="appendix-a-open-source-resources.html#literature"><i class="fa fa-check"></i><b>8.1.1</b> Literature</a></li>
<li class="chapter" data-level="8.1.2" data-path="appendix-a-open-source-resources.html"><a href="appendix-a-open-source-resources.html#qgis"><i class="fa fa-check"></i><b>8.1.2</b> QGIS</a></li>
<li class="chapter" data-level="8.1.3" data-path="appendix-a-open-source-resources.html"><a href="appendix-a-open-source-resources.html#r-and-rstudio"><i class="fa fa-check"></i><b>8.1.3</b> R and RStudio</a></li>
<li class="chapter" data-level="8.1.4" data-path="appendix-a-open-source-resources.html"><a href="appendix-a-open-source-resources.html#rs-minerve"><i class="fa fa-check"></i><b>8.1.4</b> RS Minerve</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html"><i class="fa fa-check"></i><b>8.2</b> Appendix B: Quick Guides</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#qgis-1"><i class="fa fa-check"></i><b>8.2.1</b> QGIS:</a></li>
<li class="chapter" data-level="8.2.2" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-create-hbv-model"><i class="fa fa-check"></i><b>8.2.2</b> RSM: Create HBV model and edit parameters</a></li>
<li class="chapter" data-level="8.2.3" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#rsm-add-and-link-climate-station-section-quickguides-add-climate-station"><i class="fa fa-check"></i><b>8.2.3</b> RSM: Add and link climate station {#section-quickguides-add-climate-station)}</a></li>
<li class="chapter" data-level="8.2.4" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-import-climate-data"><i class="fa fa-check"></i><b>8.2.4</b> RSM: Import climate data</a></li>
<li class="chapter" data-level="8.2.5" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-atapt-model-settings"><i class="fa fa-check"></i><b>8.2.5</b> RSM: Adapt model settings</a></li>
<li class="chapter" data-level="8.2.6" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-export-sim-results-to-db"><i class="fa fa-check"></i><b>8.2.6</b> RSM: Export simulation results to data base</a></li>
<li class="chapter" data-level="8.2.7" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-add-comparator-and-discharge-data"><i class="fa fa-check"></i><b>8.2.7</b> RSM: Add comparator and load discharge measurements</a></li>
<li class="chapter" data-level="8.2.8" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-copy-paste-database-values"><i class="fa fa-check"></i><b>8.2.8</b> RSM: Copy-paste data to database</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html"><i class="fa fa-check"></i><b>8.3</b> Appendix C: Processing Climate Data</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#cutting-chelsa-v.1.2.1-to-ca-domain"><i class="fa fa-check"></i><b>8.3.1</b> Cutting CHELSA v.1.2.1 to CA Domain</a></li>
<li class="chapter" data-level="8.3.2" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#bias-correcting-chelsa-v1.2.1-precipitation-data-for-snow-undercatch"><i class="fa fa-check"></i><b>8.3.2</b> Bias Correcting CHELSA v1.2.1 Precipitation Data for Snow Undercatch</a></li>
<li class="chapter" data-level="8.3.3" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#computing-mean-monthly-temperature-climatology-from-chelsa-v1.2.1-data"><i class="fa fa-check"></i><b>8.3.3</b> Computing Mean Monthly Temperature Climatology from CHELSA v1.2.1 data</a></li>
<li class="chapter" data-level="8.3.4" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#era5"><i class="fa fa-check"></i><b>8.3.4</b> ERA5</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html"><i class="fa fa-check"></i><b>8.4</b> Appendix D: Solutions to exercises</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html#section-appendix-solutions-exercise1"><i class="fa fa-check"></i><b>8.4.1</b> Exercise on Linear Reservoir modelling</a></li>
<li class="chapter" data-level="8.4.2" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html#section-appendix-solutions-hbv-exercises"><i class="fa fa-check"></i><b>8.4.2</b> Exercises on the HBV model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i><b>9</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Modeling of Hydrological Systems in Central Asia</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-calibration-and-validation-1" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Model Calibration and Validation</h2>
<div id="section-calibration-principles" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Basic Principles</h3>
<p>The large number of parameters of the HBV model can be adjusted within reasonable ranges to make the simulated river discharge more similar to the measured discharge. This process is sometimes called history matching because past measurements are used to adapt the model parameters. The following two exercises are important for understanding hydrological models. They are relevant whether you work as a modeler or as a decision maker. Try to first come up with a few own ideas and then study the solutions carefully. They will be discussed in the lectures in more detail.</p>
<div class="exercisebox" exercise-rsminerve-hbv-5="">
<div class="center" exercise-rsminerve-hbv-5="">
<p><strong>Exercise: Model calibration - Common difficulties</strong></p>
</div>
<p>What are typical difficulties inherent to the calibration of common semi-distributed (or fully distributed) hydrological models?</p>
<p>Hint: Compare the number of parameters of the HBV model to the number of model states.<br />
<a href="sectin-appendix-solutions.html#section-appendix-solutions-common-calibration-issues">Solution</a></p>
<div class="center" exercise-rsminerve-hbv-6="">
<p><strong>Exercise: Model calibration - Strategies to handle the difficulties</strong></p>
</div>
<p>Based on the list of common difficulties in the solution of exercise 5, think about possible strategies to address these challenges.</p>
<p>Hint: A modeler proverb says “as simple as possible but as complex as necessary.”<br />
<a href="sectin-appendix-solutions.html#section-appendix-solutions-strategies-for-issues">Solution</a></p>
</div>
<div id="calibration-vs.-validation" class="section level4" number="5.5.1.1">
<h4><span class="header-section-number">5.5.1.1</span> Calibration vs. validation</h4>
<p>As you have learned, semi- and fully distributed hydrological models are typically not well defined, i.e. you will find multiple sets of parameter combinations which will all yield reasonable model performance. An important strategy to gain confidence into a model is to split your time series into a calibration period and a validation period. During calibration, you adjust the model parameters to get a satisfying fit with the measured discharge. During the validation period you check how the calibrated model compares to discharge data that it hasn’t seen before, i.e. you judge the ability of the model to handle potentially different model input than it has seen during calibration. For example, if you have 30 years of discharge time series available you can use the first 10 years for model calibration (i.e. you run the model calibration procedure only over the first 10 years of the time series) and use the last 20 years for model validation. A good model should perform satisfactorily not only during calibration but also during validation.<br />
In hydrology, it is recommended to do cross-validation, i.e. to calibrate and validate a model with several combinations of calibration and validation periods and to summarize the overall model performance.</p>
</div>
<div id="performance-indicators" class="section level4" number="5.5.1.2">
<h4><span class="header-section-number">5.5.1.2</span> Performance indicators</h4>
<p>Model performance can be expressed in different ways. Some indicators are better suited to calibrate high flows (e.g. root mean squared error) and some are better suited to calibrate low flows (e.g. Nash coefficient for logarithm values). Others evaluate the models ability to reproduce the exceedance of a given discharge which is especially important for flood modelling. The calibration result depends on the choice of the performance indicators. For the automated calibration in RS Minerve, the user can choose a combination of several performance indicators. Care has to be taken to choose them according to the models goal.</p>
<div class="exercisebox" task-performance-indicators="">
<div class="center" task-performance-indicators="">
<p><strong>Task: Read up on performance indicators</strong></p>
</div>
<p>The RS Minerve technical manual <span class="citation">(<a href="References.html#ref-rsminerve_tm" role="doc-biblioref">Garcia Hernandez et al. 2020</a>)</span> summarizes the most important performance indicators typically used in hydrological modelling. For the more ambitious modellers, the manual includes references to the literature. Read Chapter 3 of the technical manual.</p>
</div>
</div>
<div id="the-general-modelling-process" class="section level4" number="5.5.1.3">
<h4><span class="header-section-number">5.5.1.3</span> The general modelling process</h4>
Hydrological modelling is an iterative process (see Figure <a href="model-calibration-and-validation-1.html#fig:iterative-modelling-process">5.11</a>. At the beginning, the purpose of the model has to be defined. The model goal determines the spatial and temporal resolution of the hydrological model. E.g. for analyzing the impact of climate change on seasonal, regional flows we are interested in the seasonal flow volumes whereas a model used for early warnings from floods requires high temporal resolution and a high model performance for threshold overflows. Please note that the definition of the model goal also determines the performance criteria the model has to fulfill in order to be judged suitable for its purpose. As a next step, data about the catchment is gathered (see for example basin characterization in the Chapter <a href="CaseStudies.html#CaseStudies">Case Studies</a>](#CaseStudies)) and a first conceptual model of the dominant flow processes in the basin is drafted (e.g. low peaks and significant base flow point to large storage capacity in the basin whereas high peaks and low base flow indicate small storage capacity in the basin). The conceptual model of the river catchment is then implemented with a mathematical model (e.g. the HBV model in RS Minerve) and parameterized as well as possible (i.e. using reasonable estimates for initial parameter values). The model is then calibrated and validated as described above. If the performance criteria for the model calibration are satisfied, a conscientious modeler performs a sensitivity analysis to gain confidence in the model. From each of these steps, the modeler can (and generally has to) go back to a previous step to gather more data, modify the conceptual model, adapt the model implementation, re-calibrate the model and/or re-evaluate the model sensitivity. The described steps produce a model (or an ensemble of models) that satisfy the performance criteria, only now the modeller can start actually using the model for the purpose it was implemented for.<br />

<div class="figure" style="text-align: center"><span id="fig:iterative-modelling-process"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_modelling_process.png" alt="The modelling process is iterative." width="100%" />
<p class="caption">
Figure 5.11: The modelling process is iterative.
</p>
</div>
<p>Modelling is an involved process requiring highly specialized knowledge and skills. This book chapter will guide you through the modelling process with the example of the Nauvalisoy catchment.</p>
</div>
</div>
<div id="secion-calibration-practical-steps" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Practical Steps</h3>
<div id="section-hbv-nauvalisoy-calibration" class="section level4" number="5.5.2.1">
<h4><span class="header-section-number">5.5.2.1</span> Manual calibration of synthetic discharge</h4>
<p>The following section describes the steps for manual model calibration. We use the example of the Nauvalisoy river catchment and calibrate it with synthetic discharge measurements to deepen our understanding of the HBV model. For the synthetic discharge measurements it is theoretically possible to find a perfect match between simulated and measured data which is typically not the case for real measurements.</p>
<div class="figure" style="text-align: center"><span id="fig:rsminerve-run-model-precalibration"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_simulation_result_before_calibration_synthetic.png" alt="The simulated discharge (green) differs from the reference discharge (blue) before model calibration." width="80%" />
<p class="caption">
Figure 5.12: The simulated discharge (green) differs from the reference discharge (blue) before model calibration.
</p>
</div>
<div class="exercisebox" exercise-rsminerve-manual-calibration="">
<div class="center" exercise-rsminerve-manual-calibration="">
<p><strong>Exercise: RS Minerve - Manual calibration of synthetic discharge</strong></p>
</div>
<p>Add a comparator and a source object to your Nauvalisoy model and load river discharge measurements (filename), then run the model <a href="appendix-b-quick-guides.html#section-quickguides-add-comparator-and-discharge-data">how to</a>. With default parameters, the outcome of this step should look like Figure <a href="model-calibration-and-validation-1.html#fig:rsminerve-run-model-precalibration">5.12</a>. Should your result differ significantly from the one shown here, compare the parameters of the HBV mode to the ones in the file ./data/SyrDarya/Chirchiq/RSMinerve/nauvalisoy_PAR_precalibration.txt. You can import the parameter set to RS Minerve via Import P in the model properties toolbar.</p>
<p>Hints: Start adjusting the parameters of the HBV model to make the simulated discharge curve more similar to the reference discharge. Start with the parameters of the snow function and then proceed downwards through the compartments of the HBV model.
Focus on parts of the curves. Try to figure out which parameters influence the timing of the discharge peak, which the height of the peak and which the form of the recession curve. Give yourself some time for this task before you go peaking in the results.<br />
The parameters of the calibrated model are linked <a href="#section-appendix-solutions-calibrated%20parameters">here.</a></p>
<div class="center" exercise-rsminerve-manual-calibration="">
<p><strong>Exercise: RS Minerve - Load real discharge measurements</strong></p>
</div>
<p>Import the database file for Nauvalisoy including measured discharge at the outlet of the catchment ./data/SyrDarya/Chirchiq/RSMinerve/ERA5Q_Nauvalisoy_1981_2013.csv into RS Minerve and connect it to your model. Adapt the simulation time period to start on Jan 1 1981 at 1 a.m. until Dec 31 2013 at 11 p.m (the full period with available data). The simulation will take place at the maximum resolution of the forcing data, i.e. at hourly time steps. The discharge measurements are available as averages over 8-11 days. We choose an output interval of 2 days. As the initial water content in the system is not known, a warm-up period of 1 year is typically used to minimize the impact of the unknown initial conditions on the simulation results. You can implement the warm-up period in the comparator object under Parameters. Use the default, pre-calibration parameter set in ./data/SyrDarya/Chirchiq/RSMinerve/nauvalisoy_PAR_precalibration.txt as we don’t know much about the catchment properties.</p>
</div>
Figure <a href="model-calibration-and-validation-1.html#fig:fig-real-discharge-result">5.13</a> shows the resulting discharge time series in the comparator object.
<div class="figure"><span id="fig:fig-real-discharge-result"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_Nauvalisoy_real_discharge_base.png" alt="Simulated and measured discahrge at the outlet of the Nauvalisoy catchment." width="1440" />
<p class="caption">
Figure 5.13: Simulated and measured discahrge at the outlet of the Nauvalisoy catchment.
</p>
</div>
<p>The simulated discharge peak arrives several months before the observed discharge peak. You may invest 10 minutes to try it out but by merely adjusting the parameters of our HBV model, we will not be able to shift the simulated discharge time series sufficiently to reproduce the measured discharge. We are facing a conceptual model error which we have to identify and eliminate.</p>
<p>Figure <a href="model-calibration-and-validation-1.html#fig:gunt-temp-elevation">5.14</a> shows the relationship between elevation and temperature of the 4 meteo stations in the Gunt river catchment. The elevation dependence of temperature is highly important for snow-melt driven river catchments.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="model-calibration-and-validation-1.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## MeteoStation locations and elevation</span></span>
<span id="cb109-2"><a href="model-calibration-and-validation-1.html#cb109-2" aria-hidden="true" tabindex="-1"></a>meteoStations <span class="ot">&lt;-</span> <span class="co"># just put everything in a regular dataframe</span></span>
<span id="cb109-3"><a href="model-calibration-and-validation-1.html#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">code =</span> <span class="fu">c</span>(<span class="dv">38953</span>, <span class="dv">38954</span>, <span class="dv">38956</span>, <span class="dv">38950</span>),</span>
<span id="cb109-4"><a href="model-calibration-and-validation-1.html#cb109-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">masl  =</span> <span class="fu">c</span>(<span class="dv">3746</span>, <span class="dv">2075</span>, <span class="dv">3438</span>, <span class="dv">2566</span>))</span>
<span id="cb109-5"><a href="model-calibration-and-validation-1.html#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="model-calibration-and-validation-1.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Gunt data</span></span>
<span id="cb109-7"><a href="model-calibration-and-validation-1.html#cb109-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&#39;./data/AmuDarya/Gunt/StationData/gunt_data_cleaned.Rds&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb109-8"><a href="model-calibration-and-validation-1.html#cb109-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(type, <span class="st">&quot;T&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Filter for data types that contain T </span></span>
<span id="cb109-9"><a href="model-calibration-and-validation-1.html#cb109-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">code =</span> <span class="fu">as.numeric</span>(code)) <span class="sc">%&gt;%</span>  <span class="co"># Cast code column to numeric</span></span>
<span id="cb109-10"><a href="model-calibration-and-validation-1.html#cb109-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meteoStations)  <span class="co"># Add the station altitude to the data</span></span>
<span id="cb109-11"><a href="model-calibration-and-validation-1.html#cb109-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-12"><a href="model-calibration-and-validation-1.html#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the dataframe</span></span>
<span id="cb109-13"><a href="model-calibration-and-validation-1.html#cb109-13" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb109-14"><a href="model-calibration-and-validation-1.html#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::filter(!str_detect(type, &quot;meanmax&quot;), </span></span>
<span id="cb109-15"><a href="model-calibration-and-validation-1.html#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                 !str_detect(type, &quot;meanmin&quot;)) %&gt;%</span></span>
<span id="cb109-16"><a href="model-calibration-and-validation-1.html#cb109-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(type, <span class="st">&quot;mean</span><span class="sc">\\</span><span class="st">(T</span><span class="sc">\\</span><span class="st">)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb109-17"><a href="model-calibration-and-validation-1.html#cb109-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Variable =</span> type) <span class="sc">%&gt;%</span></span>
<span id="cb109-18"><a href="model-calibration-and-validation-1.html#cb109-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(code, Variable) <span class="sc">%&gt;%</span></span>
<span id="cb109-19"><a href="model-calibration-and-validation-1.html#cb109-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">norm =</span> <span class="fu">mean</span>(norm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb109-20"><a href="model-calibration-and-validation-1.html#cb109-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">masl =</span> <span class="fu">first</span>(masl)) <span class="sc">%&gt;%</span></span>
<span id="cb109-21"><a href="model-calibration-and-validation-1.html#cb109-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(norm, masl)) <span class="sc">+</span>  <span class="co">#, colour = Variable)) + </span></span>
<span id="cb109-22"><a href="model-calibration-and-validation-1.html#cb109-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb109-23"><a href="model-calibration-and-validation-1.html#cb109-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb109-24"><a href="model-calibration-and-validation-1.html#cb109-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Altitude [masl]&quot;</span>, <span class="at">x =</span> <span class="st">&quot;T [deg C]&quot;</span>) <span class="sc">+</span> </span>
<span id="cb109-25"><a href="model-calibration-and-validation-1.html#cb109-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span id="fig:gunt-temp-elevation"></span>
<img src="applied-hydrological-modeling-central-asia_files/figure-html/gunt-temp-elevation-1.png" alt="Elevation dependence of mean temperature at the four meteo stations in the Gunt river catchment. The temperature decrease is a little below 1 degree K per 100 m of altitude gain." width="672" />
<p class="caption">
Figure 5.14: Elevation dependence of mean temperature at the four meteo stations in the Gunt river catchment. The temperature decrease is a little below 1 degree K per 100 m of altitude gain.
</p>
</div>
<p>At temperatures below approximately 0 degrees C, precipitation falls as snow and remains stored as snow in the catchment until temperatures above 0 degrees C melt the snow and produce runoff. Especially for snow driven catchments, it is important to take the elevation dependence of temperature into account. In RS Minerve, this can be done by dividing the catchment into several sub-catchments of similar altitude (i.e. elevation bands) and to define temperature (and precipitation) inputs for these sub-catchments. This is a spatial refinement of the model which allows us to better represent the snow storage and melting processes in the catchment. A description of how to obtain the elevation bands is given in the Chapter on the preparation of <a href="Data-GeospatialData.html#Data::GeospatialData">geospatial data</a>.</p>
</div>
<div id="section-hbv-elevation-bands" class="section level4" number="5.5.2.2">
<h4><span class="header-section-number">5.5.2.2</span> Spatial refinement of the model</h4>
<p>** TODO: Nauvalisoy elevation bands at higher resolution, ask tobi how involved the exctraction of the era5 bias corrected data for the elevation bands is **</p>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="section-hbv-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-investigating-climate-change-impacts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08_RS_MINERVE.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["applied-hydrological-modeling-central-asia.pdf", "applied-hydrological-modeling-central-asia.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
