<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Retrieval &amp; Analysis of Geospatial &amp; Hydro-Climatological Data | Applied Modeling of Hydrological Systems in Central Asia</title>
  <meta name="description" content="This is a course book on Central Asia hydrological systems and hydrological modeling." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Retrieval &amp; Analysis of Geospatial &amp; Hydro-Climatological Data | Applied Modeling of Hydrological Systems in Central Asia" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a course book on Central Asia hydrological systems and hydrological modeling." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Retrieval &amp; Analysis of Geospatial &amp; Hydro-Climatological Data | Applied Modeling of Hydrological Systems in Central Asia" />
  
  <meta name="twitter:description" content="This is a course book on Central Asia hydrological systems and hydrological modeling." />
  

<meta name="author" content="Tobias Siegfried" />


<meta name="date" content="2020-06-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="irrigation-agriculture-in-central-asia.html"/>
<link rel="next" href="the-manual-water-balance.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Hydrological Systems in Central Asia</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="part"><span><b>I Part I Hydrological Systems</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="hydrological-systems-in-central-asia.html"><a href="hydrological-systems-in-central-asia.html"><i class="fa fa-check"></i><b>2</b> Hydrological Systems in Central Asia</a><ul>
<li class="chapter" data-level="2.1" data-path="hydrological-systems-in-central-asia.html"><a href="hydrological-systems-in-central-asia.html#regional-hydro-climatological-features"><i class="fa fa-check"></i><b>2.1</b> Regional Hydro-Climatological Features</a></li>
<li class="chapter" data-level="2.2" data-path="hydrological-systems-in-central-asia.html"><a href="hydrological-systems-in-central-asia.html#chap:regionalWaterBalance"><i class="fa fa-check"></i><b>2.2</b> Regional Water Balance</a></li>
<li class="chapter" data-level="2.3" data-path="hydrological-systems-in-central-asia.html"><a href="hydrological-systems-in-central-asia.html#runoff-formation"><i class="fa fa-check"></i><b>2.3</b> Runoff Formation</a></li>
<li class="chapter" data-level="2.4" data-path="hydrological-systems-in-central-asia.html"><a href="hydrological-systems-in-central-asia.html#average-multi-year-runoff"><i class="fa fa-check"></i><b>2.4</b> Average Multi-Year Runoff</a></li>
<li class="chapter" data-level="2.5" data-path="hydrological-systems-in-central-asia.html"><a href="hydrological-systems-in-central-asia.html#annual-runoff-fluctuations"><i class="fa fa-check"></i><b>2.5</b> Annual Runoff Fluctuations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="irrigation-agriculture-in-central-asia.html"><a href="irrigation-agriculture-in-central-asia.html"><i class="fa fa-check"></i><b>3</b> Irrigation Agriculture in Central Asia</a><ul>
<li class="chapter" data-level="3.1" data-path="irrigation-agriculture-in-central-asia.html"><a href="irrigation-agriculture-in-central-asia.html#historic-developments"><i class="fa fa-check"></i><b>3.1</b> Historic Developments</a></li>
<li class="chapter" data-level="3.2" data-path="irrigation-agriculture-in-central-asia.html"><a href="irrigation-agriculture-in-central-asia.html#irrigation-and-socio-economic-activity-in-the-twentieth-century"><i class="fa fa-check"></i><b>3.2</b> Irrigation and Socio-Economic Activity in the Twentieth Century</a></li>
<li class="chapter" data-level="3.3" data-path="irrigation-agriculture-in-central-asia.html"><a href="irrigation-agriculture-in-central-asia.html#post-transition-developments-in-the-irrigation-sectors"><i class="fa fa-check"></i><b>3.3</b> Post-Transition Developments in the Irrigation Sectors</a></li>
</ul></li>
<li class="part"><span><b>II Part II Applied Modeling</b></span></li>
<li class="chapter" data-level="4" data-path="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><i class="fa fa-check"></i><b>4</b> Retrieval &amp; Analysis of Geospatial &amp; Hydro-Climatological Data</a><ul>
<li class="chapter" data-level="" data-path="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="4.1" data-path="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#geospatial-data"><i class="fa fa-check"></i><b>4.1</b> Geospatial Data</a></li>
<<<<<<< HEAD
<li class="chapter" data-level="4.2" data-path="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#hydro-climatological-data"><i class="fa fa-check"></i><b>4.2</b> Hydro-Climatological Data</a><ul>
<li class="chapter" data-level="4.2.1" data-path="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#access-select-and-download-era5-reanalysis-data"><i class="fa fa-check"></i><b>4.2.1</b> Access, Select and Download ERA5 Reanalysis Data</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#hydrological-data"><i class="fa fa-check"></i><b>4.3</b> Hydrological Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html"><i class="fa fa-check"></i><b>5</b> The Manual Water Balance</a></li>
=======
<li class="chapter" data-level="4.2" data-path="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#hydro-climatological-data"><i class="fa fa-check"></i><b>4.2</b> Hydro-Climatological Data</a></li>
<li class="chapter" data-level="4.3" data-path="retrieval-analysis-of-geospatial-hydro-climatological-data.html"><a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#hydrological-data"><i class="fa fa-check"></i><b>4.3</b> Hydrological Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html"><i class="fa fa-check"></i><b>5</b> The Manual Water Balance</a><ul>
<li class="chapter" data-level="5.1" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#dominant-flow-processes-in-the-hydrological-cycle"><i class="fa fa-check"></i><b>5.1</b> Dominant flow processes in the hydrological cycle</a><ul>
<li class="chapter" data-level="5.1.1" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#precipitation"><i class="fa fa-check"></i><b>5.1.1</b> Precipitation</a></li>
<li class="chapter" data-level="5.1.2" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#canopy-interception"><i class="fa fa-check"></i><b>5.1.2</b> Canopy interception</a></li>
<li class="chapter" data-level="5.1.3" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#snowmelt"><i class="fa fa-check"></i><b>5.1.3</b> Snowmelt</a></li>
<li class="chapter" data-level="5.1.4" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#runoff"><i class="fa fa-check"></i><b>5.1.4</b> Runoff</a></li>
<li class="chapter" data-level="5.1.5" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#infiltration"><i class="fa fa-check"></i><b>5.1.5</b> Infiltration</a></li>
<li class="chapter" data-level="5.1.6" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#sub-surface-flow"><i class="fa fa-check"></i><b>5.1.6</b> Sub-surface flow</a></li>
<li class="chapter" data-level="5.1.7" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#evaporation"><i class="fa fa-check"></i><b>5.1.7</b> Evaporation</a></li>
<li class="chapter" data-level="5.1.8" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#sublimation"><i class="fa fa-check"></i><b>5.1.8</b> Sublimation</a></li>
<li class="chapter" data-level="5.1.9" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#transpiration"><i class="fa fa-check"></i><b>5.1.9</b> Transpiration</a></li>
<li class="chapter" data-level="5.1.10" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#percolation"><i class="fa fa-check"></i><b>5.1.10</b> Percolation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#the-general-water-balance-equation"><i class="fa fa-check"></i><b>5.2</b> The general water balance equation</a></li>
<li class="chapter" data-level="5.3" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#boundaries-of-the-water-balance"><i class="fa fa-check"></i><b>5.3</b> Boundaries of the water balance</a></li>
<li class="chapter" data-level="5.4" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#data-need-for-a-water-balance"><i class="fa fa-check"></i><b>5.4</b> Data need for a water balance</a></li>
<li class="chapter" data-level="5.5" data-path="the-manual-water-balance.html"><a href="the-manual-water-balance.html#setting-up-a-conceptual-model"><i class="fa fa-check"></i><b>5.5</b> Setting up a conceptual model</a></li>
</ul></li>
>>>>>>> develop_bea
<li class="chapter" data-level="6" data-path="hydrological-modeling-physically-based-models.html"><a href="hydrological-modeling-physically-based-models.html"><i class="fa fa-check"></i><b>6</b> Hydrological Modeling: Physically-Based Models</a></li>
<li class="chapter" data-level="7" data-path="hydrological-modeling-empirical-models.html"><a href="hydrological-modeling-empirical-models.html"><i class="fa fa-check"></i><b>7</b> Hydrological Modeling: Empirical Models</a></li>
<li class="chapter" data-level="8" data-path="operationalization-of-models-opportunities-and-challenges.html"><a href="operationalization-of-models-opportunities-and-challenges.html"><i class="fa fa-check"></i><b>8</b> Operationalization of Models - Opportunities and Challenges</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a.html"><a href="appendix-a.html"><i class="fa fa-check"></i><b>A</b> Appendix A</a><ul>
<li class="chapter" data-level="A.1" data-path="appendix-a.html"><a href="appendix-a.html#open-source-software"><i class="fa fa-check"></i><b>A.1</b> Open-Source Software</a><ul>
<li class="chapter" data-level="A.1.1" data-path="appendix-a.html"><a href="appendix-a.html#qgis"><i class="fa fa-check"></i><b>A.1.1</b> QGIS</a></li>
<li class="chapter" data-level="A.1.2" data-path="appendix-a.html"><a href="appendix-a.html#r-and-rstudio"><i class="fa fa-check"></i><b>A.1.2</b> R and RStudio</a></li>
<li class="chapter" data-level="A.1.3" data-path="appendix-a.html"><a href="appendix-a.html#rs-minerve"><i class="fa fa-check"></i><b>A.1.3</b> RS Minerve</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="B" data-path="hydrological-systems-in-central-asia-1.html"><a href="hydrological-systems-in-central-asia-1.html"><i class="fa fa-check"></i><b>B</b> Hydrological Systems in Central Asia</a><ul>
<li class="chapter" data-level="B.1" data-path="hydrological-systems-in-central-asia-1.html"><a href="hydrological-systems-in-central-asia-1.html#regional-hydro-climatological-features-1"><i class="fa fa-check"></i><b>B.1</b> Regional Hydro-Climatological Features</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Modeling of Hydrological Systems in Central Asia</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="retrieval-analysis-of-geospatial-hydro-climatological-data" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Retrieval &amp; Analysis of Geospatial &amp; Hydro-Climatological Data</h1>
<div id="prerequisites" class="section level2 unnumbered">
<h2>Prerequisites</h2>
<p>This Chapter requires the following R packages to be installed. If you are running R in RStudio and some of the packages are not yet installed on your computer, RStudio will warn you and ask, whether you want to have them installed. Here I change something.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Tidyverse </span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># File navigation</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co"># Copernicus Climate Data Store</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">library</span>(ecmwfr)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">library</span>(keyring)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co"># Handling netcdf files</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">library</span>(ncdf4)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co"># Spatial data plotting &amp; plotting</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">library</span>(rgdal)</a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="kw">library</span>(rgeos)</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="kw">library</span>(sp)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="kw">library</span>(rasterVis)</a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="kw">library</span>(RColorBrewer)</a></code></pre></div>
</div>
<div id="geospatial-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Geospatial Data</h2>
</div>
<div id="hydro-climatological-data" class="section level2">
<h2><span class="header-section-number">4.2</span> Hydro-Climatological Data</h2>
<<<<<<< HEAD
<div id="access-select-and-download-era5-reanalysis-data" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Access, Select and Download ERA5 Reanalysis Data</h3>
<p>For the climate data to be used in the modeling approach, we use ERA5 data from the European Center for Medium-Range Weather Forecasts (ECMWF, &lt;www.ecmwf.int&gt;). ERA5, the successor to ERA-Interim, provides global, hourly estimates of atmospheric variables, at a horizontal resolution of 31 km and 137 vertical levels from the surface to 0.01 hPa <span class="citation">(Dee D. <a href="#ref-era5-desc">2020</a>)</span>. ERA5 presently extends back to 1979 but will ultimately be extended back to 1950<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>The ERA5 data is available via the Copernicus Climate Store at <a href="https://cds.climate.copernicus.eu" class="uri">https://cds.climate.copernicus.eu</a>. However, before we can access, select and download it there, each user has to register with a personal account in the store. For this purpose, the user should navigate to the website and register via the Login/Register/NewAccount Menu. You will receive an email once your account is ready.</p>
<p>Log in to your account and go to your user profile where you find your user ID and API key. The relevant information should be copied and into the relevant places of the code chunk below and then be executed.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">#Note: replace the UID and key strings below with the proper user&#39;s information in your Copernicus Climate Data Store account.</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">UID &lt;-<span class="st"> &#39;UID&#39;</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">API_key &lt;-<span class="st"> &#39;key&#39;</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#This function links your password and user id for later steps</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">wf_set_key</span>(UID, API_key, <span class="st">&#39;cds&#39;</span>)</a></code></pre></div>
<p>//TODO: output still showing. How to deal with it?</p>
<pre><code>## User 11732 for cds service added successfully</code></pre>
<p>If all worked well, you will get the following confirmation in the console:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co">## User UID for cds service added successfully</span></a></code></pre></div>
<p>On the Copernicus website, make sure that you are logged into your account and the navigate to Datasets. There, search for the Product ‘ERA5-Land monthly averaged data from 1981 to present’ and select it<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. You end up on the products homepage where you can get more information and download the data via a form where you select the product’s type, variables, the years, months and time of day, the geographical area and, finally, the download file format of interest. Please select the following:</p>
<ul>
<li>Product type: Monthly averaged reanalysis</li>
<li>Variable:
<ul>
<li>Temperature: 2 m Temperature</li>
<li>Lakes: NA</li>
<li>Snow: NA</li>
<li>Soil Water: NA</li>
<li>Radiation and Heat: NA</li>
<li>Evaporation and Runoff: Potential evaporation</li>
<li>Wind, Pressure and Precipitation: Total precipitation</li>
<li>Vegetation: NA</li>
</ul></li>
<li>Year: Select all</li>
<li>Month: Select all</li>
<li>Time: 00:00</li>
<li>Geographical area: Sub-region extraction (West = 65, East = 80, South = 35, North = 45)</li>
<li>Format: NetCDF (experimental)</li>
</ul>
<p>Accept the Terms of use and press the ‘Show API request button’. You should see the following Python request now as shown in Figure <a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#fig:Copernicus-API-Request">4.1</a>.</p>
<div class="figure"><span id="fig:Copernicus-API-Request"></span>
<img src="_bookdown_files/Chap4-Figures/fig_Copernicus_API_request" alt="Screenshot showing the Copernicus Data Store API request that can be copied and posted into RStudio for the convenient download of the data there."  />
<p class="caption">
Figure 4.1: Screenshot showing the Copernicus Data Store API request that can be copied and posted into RStudio for the convenient download of the data there.
</p>
</div>
<p>The request should be copied and pasted into RStudio into your current .Rmd file there. Select the python request with the cursor and choose ‘ECMWFR/Python to List’ under the Addins Menu. The python request will then automatically be translated into a an r command. Please check that everything is ok by comparing it with a correct request as shown below.</p>
<p>In a final step, the user can then download the data with the <code>wf_request()</code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Here is is the resulting request in R language </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">request &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;dataset_short_name&quot;</span> =<span class="st"> &quot;reanalysis-era5-land-monthly-means&quot;</span>,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  <span class="dt">format =</span> <span class="st">&quot;netcdf&quot;</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="dt">product_type =</span> <span class="st">&quot;monthly_averaged_reanalysis&quot;</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  <span class="dt">variable =</span> <span class="kw">c</span>(<span class="st">&#39;2m_temperature&#39;</span>, <span class="st">&#39;potential_evaporation&#39;</span>, <span class="st">&#39;total_precipitation&#39;</span>),</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">  <span class="dt">year =</span>  <span class="kw">c</span>(<span class="st">&#39;1981&#39;</span>, <span class="st">&#39;1982&#39;</span>, <span class="st">&#39;1983&#39;</span>,</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">            <span class="st">&#39;1984&#39;</span>, <span class="st">&#39;1985&#39;</span>, <span class="st">&#39;1986&#39;</span>,</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">            <span class="st">&#39;1987&#39;</span>, <span class="st">&#39;1988&#39;</span>, <span class="st">&#39;1989&#39;</span>,</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">            <span class="st">&#39;1990&#39;</span>, <span class="st">&#39;1991&#39;</span>, <span class="st">&#39;1992&#39;</span>,</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">            <span class="st">&#39;1993&#39;</span>, <span class="st">&#39;1994&#39;</span>, <span class="st">&#39;1995&#39;</span>,</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">            <span class="st">&#39;1996&#39;</span>, <span class="st">&#39;1997&#39;</span>, <span class="st">&#39;1998&#39;</span>,</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">            <span class="st">&#39;1999&#39;</span>, <span class="st">&#39;2000&#39;</span>, <span class="st">&#39;2001&#39;</span>,</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">            <span class="st">&#39;2002&#39;</span>, <span class="st">&#39;2003&#39;</span>, <span class="st">&#39;2004&#39;</span>,</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">            <span class="st">&#39;2005&#39;</span>, <span class="st">&#39;2006&#39;</span>, <span class="st">&#39;2007&#39;</span>,</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">            <span class="st">&#39;2008&#39;</span>, <span class="st">&#39;2009&#39;</span>, <span class="st">&#39;2010&#39;</span>,</a>
<a class="sourceLine" id="cb5-16" data-line-number="16">            <span class="st">&#39;2011&#39;</span>, <span class="st">&#39;2012&#39;</span>, <span class="st">&#39;2013&#39;</span>,</a>
<a class="sourceLine" id="cb5-17" data-line-number="17">            <span class="st">&#39;2014&#39;</span>, <span class="st">&#39;2015&#39;</span>, <span class="st">&#39;2016&#39;</span>,</a>
<a class="sourceLine" id="cb5-18" data-line-number="18">            <span class="st">&#39;2017&#39;</span>, <span class="st">&#39;2018&#39;</span>, <span class="st">&#39;2019&#39;</span>,</a>
<a class="sourceLine" id="cb5-19" data-line-number="19">            <span class="st">&#39;2020&#39;</span>),</a>
<a class="sourceLine" id="cb5-20" data-line-number="20">  <span class="dt">month =</span> <span class="kw">c</span>(<span class="st">&quot;01&quot;</span>, <span class="st">&quot;02&quot;</span>, <span class="st">&quot;03&quot;</span>, <span class="st">&quot;04&quot;</span>, <span class="st">&quot;05&quot;</span>, <span class="st">&quot;06&quot;</span>, <span class="st">&quot;07&quot;</span>, <span class="st">&quot;08&quot;</span>, <span class="st">&quot;09&quot;</span>, <span class="st">&quot;10&quot;</span>, <span class="st">&quot;11&quot;</span>, <span class="st">&quot;12&quot;</span>),</a>
<a class="sourceLine" id="cb5-21" data-line-number="21">  <span class="dt">time =</span> <span class="st">&quot;00:00&quot;</span>,</a>
<a class="sourceLine" id="cb5-22" data-line-number="22">  <span class="dt">area =</span> <span class="st">&quot;45/65/35/80&quot;</span>,</a>
<a class="sourceLine" id="cb5-23" data-line-number="23">  <span class="co">#dataset = &quot;reanalysis-era5-land-monthly-means&quot;,</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24">  <span class="dt">target =</span> <span class="st">&quot;reanalysis-era5-land-monthly-means_CentralAsia.nc&quot;</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25">)</a>
<a class="sourceLine" id="cb5-26" data-line-number="26"></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co"># Download data as netcdf file and store it in the directory where you are running this script, this returns the path to the file </span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28">ncfilelink &lt;-<span class="st"> </span><span class="kw">wf_request</span>(<span class="dt">user =</span> UID,</a>
<a class="sourceLine" id="cb5-29" data-line-number="29">                     <span class="dt">request =</span> request,</a>
<a class="sourceLine" id="cb5-30" data-line-number="30">                     <span class="dt">transfer =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb5-31" data-line-number="31">                     <span class="dt">path =</span> <span class="kw">here</span>(),</a>
<a class="sourceLine" id="cb5-32" data-line-number="32">                     <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Requesting data to the cds service with username 11732</code></pre>
<pre><code>## - staging data transfer at url endpoint or request id:</code></pre>
<pre><code>##   2dc49415-75bd-4448-b8ed-1483be185146</code></pre>
<pre><code>## - timeout set to 1.0 hours</code></pre>
<pre><code>## - polling server for a data transfer \ polling server for a data transfer
## | polling server for a data transfer / polling server for a data transfer
## - polling server for a data transfer \ polling server for a data transfer
## | polling server for a data transfer / polling server for a data transfer
## - polling server for a data transfer \ polling server for a data transfer
## | polling server for a data transfer / polling server for a data transfer
## - polling server for a data transfer \ polling server for a data transfer
## | polling server for a data transfer / polling server for a data transfer
## - polling server for a data transfer \ polling server for a data transfer
## | polling server for a data transfer / polling server for a data transfer
## - polling server for a data transfer \ polling server for a data transfer
## | polling server for a data transfer / polling server for a data transfer -
## polling server for a data transfer</code></pre>
<pre><code>## 
  |                                                                            
  |                                                                      |   0%
  |                                                                            
  |                                                                      |   1%
  |                                                                            
  |=                                                                     |   1%
  |                                                                            
  |=                                                                     |   2%
  |                                                                            
  |==                                                                    |   2%
  |                                                                            
  |==                                                                    |   3%
  |                                                                            
  |==                                                                    |   4%
  |                                                                            
  |===                                                                   |   4%
  |                                                                            
  |===                                                                   |   5%
  |                                                                            
  |====                                                                  |   5%
  |                                                                            
  |====                                                                  |   6%
  |                                                                            
  |=====                                                                 |   6%
  |                                                                            
  |=====                                                                 |   7%
  |                                                                            
  |=====                                                                 |   8%
  |                                                                            
  |======                                                                |   8%
  |                                                                            
  |======                                                                |   9%
  |                                                                            
  |=======                                                               |   9%
  |                                                                            
  |=======                                                               |  10%
  |                                                                            
  |=======                                                               |  11%
  |                                                                            
  |========                                                              |  11%
  |                                                                            
  |========                                                              |  12%
  |                                                                            
  |=========                                                             |  12%
  |                                                                            
  |=========                                                             |  13%
  |                                                                            
  |=========                                                             |  14%
  |                                                                            
  |==========                                                            |  14%
  |                                                                            
  |==========                                                            |  15%
  |                                                                            
  |===========                                                           |  15%
  |                                                                            
  |===========                                                           |  16%
  |                                                                            
  |============                                                          |  16%
  |                                                                            
  |============                                                          |  17%
  |                                                                            
  |============                                                          |  18%
  |                                                                            
  |=============                                                         |  18%
  |                                                                            
  |=============                                                         |  19%
  |                                                                            
  |==============                                                        |  19%
  |                                                                            
  |==============                                                        |  20%
  |                                                                            
  |==============                                                        |  21%
  |                                                                            
  |===============                                                       |  21%
  |                                                                            
  |===============                                                       |  22%
  |                                                                            
  |================                                                      |  22%
  |                                                                            
  |================                                                      |  23%
  |                                                                            
  |================                                                      |  24%
  |                                                                            
  |=================                                                     |  24%
  |                                                                            
  |=================                                                     |  25%
  |                                                                            
  |==================                                                    |  25%
  |                                                                            
  |==================                                                    |  26%
  |                                                                            
  |===================                                                   |  26%
  |                                                                            
  |===================                                                   |  27%
  |                                                                            
  |===================                                                   |  28%
  |                                                                            
  |====================                                                  |  28%
  |                                                                            
  |====================                                                  |  29%
  |                                                                            
  |=====================                                                 |  29%
  |                                                                            
  |=====================                                                 |  30%
  |                                                                            
  |=====================                                                 |  31%
  |                                                                            
  |======================                                                |  31%
  |                                                                            
  |======================                                                |  32%
  |                                                                            
  |=======================                                               |  32%
  |                                                                            
  |=======================                                               |  33%
  |                                                                            
  |=======================                                               |  34%
  |                                                                            
  |========================                                              |  34%
  |                                                                            
  |========================                                              |  35%
  |                                                                            
  |=========================                                             |  35%
  |                                                                            
  |=========================                                             |  36%
  |                                                                            
  |==========================                                            |  36%
  |                                                                            
  |==========================                                            |  37%
  |                                                                            
  |==========================                                            |  38%
  |                                                                            
  |===========================                                           |  38%
  |                                                                            
  |===========================                                           |  39%
  |                                                                            
  |============================                                          |  39%
  |                                                                            
  |============================                                          |  40%
  |                                                                            
  |============================                                          |  41%
  |                                                                            
  |=============================                                         |  41%
  |                                                                            
  |=============================                                         |  42%
  |                                                                            
  |==============================                                        |  42%
  |                                                                            
  |==============================                                        |  43%
  |                                                                            
  |==============================                                        |  44%
  |                                                                            
  |===============================                                       |  44%
  |                                                                            
  |===============================                                       |  45%
  |                                                                            
  |================================                                      |  45%
  |                                                                            
  |================================                                      |  46%
  |                                                                            
  |=================================                                     |  46%
  |                                                                            
  |=================================                                     |  47%
  |                                                                            
  |=================================                                     |  48%
  |                                                                            
  |==================================                                    |  48%
  |                                                                            
  |==================================                                    |  49%
  |                                                                            
  |===================================                                   |  49%
  |                                                                            
  |===================================                                   |  50%
  |                                                                            
  |===================================                                   |  51%
  |                                                                            
  |====================================                                  |  51%
  |                                                                            
  |====================================                                  |  52%
  |                                                                            
  |=====================================                                 |  52%
  |                                                                            
  |=====================================                                 |  53%
  |                                                                            
  |=====================================                                 |  54%
  |                                                                            
  |======================================                                |  54%
  |                                                                            
  |======================================                                |  55%
  |                                                                            
  |=======================================                               |  55%
  |                                                                            
  |=======================================                               |  56%
  |                                                                            
  |========================================                              |  56%
  |                                                                            
  |========================================                              |  57%
  |                                                                            
  |========================================                              |  58%
  |                                                                            
  |=========================================                             |  58%
  |                                                                            
  |=========================================                             |  59%
  |                                                                            
  |==========================================                            |  59%
  |                                                                            
  |==========================================                            |  60%
  |                                                                            
  |==========================================                            |  61%
  |                                                                            
  |===========================================                           |  61%
  |                                                                            
  |===========================================                           |  62%
  |                                                                            
  |============================================                          |  62%
  |                                                                            
  |============================================                          |  63%
  |                                                                            
  |============================================                          |  64%
  |                                                                            
  |=============================================                         |  64%
  |                                                                            
  |=============================================                         |  65%
  |                                                                            
  |==============================================                        |  65%
  |                                                                            
  |==============================================                        |  66%
  |                                                                            
  |===============================================                       |  66%
  |                                                                            
  |===============================================                       |  67%
  |                                                                            
  |===============================================                       |  68%
  |                                                                            
  |================================================                      |  68%
  |                                                                            
  |================================================                      |  69%
  |                                                                            
  |=================================================                     |  69%
  |                                                                            
  |=================================================                     |  70%
  |                                                                            
  |=================================================                     |  71%
  |                                                                            
  |==================================================                    |  71%
  |                                                                            
  |==================================================                    |  72%
  |                                                                            
  |===================================================                   |  72%
  |                                                                            
  |===================================================                   |  73%
  |                                                                            
  |===================================================                   |  74%
  |                                                                            
  |====================================================                  |  74%
  |                                                                            
  |====================================================                  |  75%
  |                                                                            
  |=====================================================                 |  75%
  |                                                                            
  |=====================================================                 |  76%
  |                                                                            
  |======================================================                |  76%
  |                                                                            
  |======================================================                |  77%
  |                                                                            
  |======================================================                |  78%
  |                                                                            
  |=======================================================               |  78%
  |                                                                            
  |=======================================================               |  79%
  |                                                                            
  |========================================================              |  79%
  |                                                                            
  |========================================================              |  80%
  |                                                                            
  |========================================================              |  81%
  |                                                                            
  |=========================================================             |  81%
  |                                                                            
  |=========================================================             |  82%
  |                                                                            
  |==========================================================            |  82%
  |                                                                            
  |==========================================================            |  83%
  |                                                                            
  |==========================================================            |  84%
  |                                                                            
  |===========================================================           |  84%
  |                                                                            
  |===========================================================           |  85%
  |                                                                            
  |============================================================          |  85%
  |                                                                            
  |============================================================          |  86%
  |                                                                            
  |=============================================================         |  86%
  |                                                                            
  |=============================================================         |  87%
  |                                                                            
  |=============================================================         |  88%
  |                                                                            
  |==============================================================        |  88%
  |                                                                            
  |==============================================================        |  89%
  |                                                                            
  |===============================================================       |  89%
  |                                                                            
  |===============================================================       |  90%
  |                                                                            
  |===============================================================       |  91%
  |                                                                            
  |================================================================      |  91%
  |                                                                            
  |================================================================      |  92%
  |                                                                            
  |=================================================================     |  92%
  |                                                                            
  |=================================================================     |  93%
  |                                                                            
  |=================================================================     |  94%
  |                                                                            
  |==================================================================    |  94%
  |                                                                            
  |==================================================================    |  95%
  |                                                                            
  |===================================================================   |  95%
  |                                                                            
  |===================================================================   |  96%
  |                                                                            
  |====================================================================  |  96%
  |                                                                            
  |====================================================================  |  97%
  |                                                                            
  |====================================================================  |  98%
  |                                                                            
  |===================================================================== |  98%
  |                                                                            
  |===================================================================== |  99%
  |                                                                            
  |======================================================================|  99%
  |                                                                            
  |======================================================================| 100%</code></pre>
<pre><code>## - moved temporary file to -&gt; /Users/tobiassiegfried/Dropbox (hydrosolutions)/hydrosolutionsLocal/Projects_Active/SDC/DKU_WRM_COURSE_CA/Course Materials/Handbook/Applied_Hydrological_Modeling_Bookdown/reanalysis-era5-land-monthly-means_CentralAsia.nc
## - request purged from queue!</code></pre>
<p>/<code>{r &lt;chunk-label&gt;, eval = FALSE} ## - moved temporary file to -&gt; /.../reanalysis-era5-land-monthly-means_CentralAsia.nc ## - request purged from queue!</code></p>
<p>Some Sources on NetCDF and raster files:
Here are some good resources to get you started: <a href="https://pjbartlein.github.io/REarthSysSci/index.html" class="uri">https://pjbartlein.github.io/REarthSysSci/index.html</a> and
<a href="https://cmerow.github.io/RDataScience/05_Raster.html" class="uri">https://cmerow.github.io/RDataScience/05_Raster.html</a>.</p>
</div>
=======
>>>>>>> develop_bea
</div>
<div id="hydrological-data" class="section level2">
<h2><span class="header-section-number">4.3</span> Hydrological Data</h2>
<p>//TODO: Show added value from consulting data from altimetry <a href="https://dahiti.dgfi.tum.de/en/map/" class="uri">https://dahiti.dgfi.tum.de/en/map/</a></p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-era5-desc">
<p>Dee D., National Center for Atmospheric Research Staff. 2020. “The Climate Data Guide: ERA5 Atmospheric Reanalysis.” <a href="https://climatedataguide.ucar.edu/climate-data/era5-atmospheric-reanalysis" class="uri">https://climatedataguide.ucar.edu/climate-data/era5-atmospheric-reanalysis</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Although this is an extraordinary product, users still need to be aware of the limitations of reanalysis; two of the major ones are that non-physical trends and variability may be present in the record due to changes in the observing system, and that the climatologies of some variables, like surface energy fluxes, are not well represented.<a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>The direct link is <a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land-monthly-means?tab=form" class="uri">https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land-monthly-means?tab=form</a>.<a href="retrieval-analysis-of-geospatial-hydro-climatological-data.html#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="irrigation-agriculture-in-central-asia.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="the-manual-water-balance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/06_PII_Retrieval_Analysis_Geo_Hydro_Data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
