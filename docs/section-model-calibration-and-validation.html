<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.6 Model Calibration and Validation | Applied Modeling of Hydrological Systems in Central Asia</title>
  <meta name="description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="6.6 Model Calibration and Validation | Applied Modeling of Hydrological Systems in Central Asia" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.6 Model Calibration and Validation | Applied Modeling of Hydrological Systems in Central Asia" />
  
  <meta name="twitter:description" content="This is a open-source course book on Central Asia hydrological systems and hydrological modeling." />
  

<meta name="author" content="Tobias Siegfried and Beatrice Marti" />


<meta name="date" content="2021-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="section-hbv-model.html"/>
<link rel="next" href="application-investigating-climate-change-impacts.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Hydrological Modeling</a></li>

<li class="divider"></li>
<li><a href="index.html#Welcome"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="foreword.html"><a href="foreword.html"><i class="fa fa-check"></i>Foreword</a></li>
<li class="chapter" data-level="" data-path="study-guide.html"><a href="study-guide.html"><i class="fa fa-check"></i>Study Guide &amp; Materials</a>
<ul>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html"><i class="fa fa-check"></i>Study Guide</a>
<ul>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-1-introduction-and-installation-of-software"><i class="fa fa-check"></i>Day 1: Introduction and installation of software</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-2-hydrological-processes-characterization"><i class="fa fa-check"></i>Day 2: Hydrological processes &amp; characterization</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-3-hydrological-models-introduction-to-rs-minerve"><i class="fa fa-check"></i>Day 3: Hydrological models &amp; Introduction to RS Minerve</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-4-data-for-hydrological-modeling"><i class="fa fa-check"></i>Day 4: Data for hydrological modeling</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-5-the-hbv-model"><i class="fa fa-check"></i>Day 5: The HBV model</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-6-model-calibration-and-validation"><i class="fa fa-check"></i>Day 6: Model calibration and validation</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-7-case-studies"><i class="fa fa-check"></i>Day 7: Case studies</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-8-real-world-applications"><i class="fa fa-check"></i>Day 8: Real-world applications</a></li>
<li class="chapter" data-level="" data-path="study-guide-1.html"><a href="study-guide-1.html#day-9-student-presentations-and-wrap-up-of-workshop"><i class="fa fa-check"></i>Day 9: Student presentations and wrap-up of workshop</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="study-materials.html"><a href="study-materials.html"><i class="fa fa-check"></i>Study Materials</a></li>
</ul></li>
<li class="part"><span><b>I Part I Hydrological Systems</b></span></li>
<li class="chapter" data-level="1" data-path="ShortHistory.html"><a href="ShortHistory.html"><i class="fa fa-check"></i><b>1</b> Short History of Water in Central Asia</a>
<ul>
<li class="chapter" data-level="1.1" data-path="TamingHydrologicalSystems.html"><a href="TamingHydrologicalSystems.html"><i class="fa fa-check"></i><b>1.1</b> The Taming of the Central Asian Rivers</a></li>
<li class="chapter" data-level="1.2" data-path="PostTransitionDevelopmentsChallenges.html"><a href="PostTransitionDevelopmentsChallenges.html"><i class="fa fa-check"></i><b>1.2</b> Post-Transition Development and Challenges</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="HydrologicalSystems.html"><a href="HydrologicalSystems.html"><i class="fa fa-check"></i><b>2</b> Hydrological Systems in Central Asia</a>
<ul>
<li class="chapter" data-level="2.1" data-path="regional-hydro-climatological-features.html"><a href="regional-hydro-climatological-features.html"><i class="fa fa-check"></i><b>2.1</b> Regional Hydro-Climatological Features</a></li>
<li class="chapter" data-level="2.2" data-path="chap-regionalWaterBalance.html"><a href="chap-regionalWaterBalance.html"><i class="fa fa-check"></i><b>2.2</b> Regional Water Balance</a></li>
<li class="chapter" data-level="2.3" data-path="runoff-formation.html"><a href="runoff-formation.html"><i class="fa fa-check"></i><b>2.3</b> Runoff Formation</a></li>
<li class="chapter" data-level="2.4" data-path="average-multi-year-runoff.html"><a href="average-multi-year-runoff.html"><i class="fa fa-check"></i><b>2.4</b> Average Multi-Year Runoff</a></li>
<li class="chapter" data-level="2.5" data-path="annual-runoff-fluctuations.html"><a href="annual-runoff-fluctuations.html"><i class="fa fa-check"></i><b>2.5</b> Annual Runoff Fluctuations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="CaseStudies.html"><a href="CaseStudies.html"><i class="fa fa-check"></i><b>3</b> Case Studies</a>
<ul>
<li class="chapter" data-level="3.1" data-path="GuntRB.html"><a href="GuntRB.html"><i class="fa fa-check"></i><b>3.1</b> Gunt River Basin</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="GuntRB.html"><a href="GuntRB.html#GuntRBOverview"><i class="fa fa-check"></i><b>3.1.1</b> Basin Characterization</a></li>
<li class="chapter" data-level="3.1.2" data-path="GuntRB.html"><a href="GuntRB.html#GuntHydrology"><i class="fa fa-check"></i><b>3.1.2</b> Hydrology</a></li>
<li class="chapter" data-level="3.1.3" data-path="GuntRB.html"><a href="GuntRB.html#GuntClimate"><i class="fa fa-check"></i><b>3.1.3</b> Climate</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="CRB.html"><a href="CRB.html"><i class="fa fa-check"></i><b>3.2</b> Chirchik River Basin</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="CRB.html"><a href="CRB.html#CRBOverview"><i class="fa fa-check"></i><b>3.2.1</b> Basin Characterization</a></li>
<li class="chapter" data-level="3.2.2" data-path="CRB.html"><a href="CRB.html#CRBBasinCharacteristics"><i class="fa fa-check"></i><b>3.2.2</b> Hydrology</a></li>
<li class="chapter" data-level="3.2.3" data-path="CRB.html"><a href="CRB.html#climate"><i class="fa fa-check"></i><b>3.2.3</b> Climate</a></li>
<li class="chapter" data-level="3.2.4" data-path="CRB.html"><a href="CRB.html#CRB_KoskuDischargeContribution"><i class="fa fa-check"></i><b>3.2.4</b> Discharge Estimation from the Ungauged Kosku Tributary</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Part II Applied Modeling</b></span></li>
<li class="chapter" data-level="4" data-path="LongTermWaterBalance.html"><a href="LongTermWaterBalance.html"><i class="fa fa-check"></i><b>4</b> Budyko-Type Long-term Water Balance Modeling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="DerivationBudykoRelationship.html"><a href="DerivationBudykoRelationship.html"><i class="fa fa-check"></i><b>4.1</b> Derivation of the Budyko Relationship</a></li>
<li class="chapter" data-level="4.2" data-path="SnowEffectsOnAnnualRunoffBudyko.html"><a href="SnowEffectsOnAnnualRunoffBudyko.html"><i class="fa fa-check"></i><b>4.2</b> Effects of Snow Ratio on Annual Runoff within the Budyko Framework</a></li>
<li class="chapter" data-level="4.3" data-path="hydrological-response-to-a-changing-climate.html"><a href="hydrological-response-to-a-changing-climate.html"><i class="fa fa-check"></i><b>4.3</b> Hydrological Response to a Changing Climate</a></li>
<li class="chapter" data-level="4.4" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html"><i class="fa fa-check"></i><b>4.4</b> Application to Central Asian River Basins</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#data"><i class="fa fa-check"></i><b>4.4.1</b> Data</a></li>
<li class="chapter" data-level="4.4.2" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#model"><i class="fa fa-check"></i><b>4.4.2</b> Model</a></li>
<li class="chapter" data-level="4.4.3" data-path="application-to-central-asian-river-basins.html"><a href="application-to-central-asian-river-basins.html#conclusions"><i class="fa fa-check"></i><b>4.4.3</b> Conclusions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Chapter-DATA.html"><a href="Chapter-DATA.html"><i class="fa fa-check"></i><b>5</b> Data Retrieval, Preparation &amp; Analysis</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Data-StationData.html"><a href="Data-StationData.html"><i class="fa fa-check"></i><b>5.1</b> Station Data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="Data-StationData.html"><a href="Data-StationData.html#AvailableData"><i class="fa fa-check"></i><b>5.1.1</b> Available Data</a></li>
<li class="chapter" data-level="5.1.2" data-path="Data-StationData.html"><a href="Data-StationData.html#StationData::GapFilling"><i class="fa fa-check"></i><b>5.1.2</b> Gap Filling Discharge Data</a></li>
<li class="chapter" data-level="5.1.3" data-path="Data-StationData.html"><a href="Data-StationData.html#DataPreparationPT"><i class="fa fa-check"></i><b>5.1.3</b> Gap Filling Meteorological Data</a></li>
<li class="chapter" data-level="5.1.4" data-path="Data-StationData.html"><a href="Data-StationData.html#AnomaliesOutliers"><i class="fa fa-check"></i><b>5.1.4</b> Anomalies and Outliers</a></li>
<li class="chapter" data-level="5.1.5" data-path="Data-StationData.html"><a href="Data-StationData.html#FinalData"><i class="fa fa-check"></i><b>5.1.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html"><i class="fa fa-check"></i><b>5.2</b> Geospatial Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#prerequisites-1"><i class="fa fa-check"></i><b>5.2.1</b> Prerequisites</a></li>
<li class="chapter" data-level="5.2.2" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#section-geospatial-data-steps-setting-up"><i class="fa fa-check"></i><b>5.2.2</b> Setting up QGIS</a></li>
<li class="chapter" data-level="5.2.3" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#section-geospatial-data-load-dem"><i class="fa fa-check"></i><b>5.2.3</b> Load DEM</a></li>
<li class="chapter" data-level="5.2.4" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#section-steps-derive-catchment-boundaries"><i class="fa fa-check"></i><b>5.2.4</b> Catchment delineation</a></li>
<li class="chapter" data-level="5.2.5" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#run-through-the-process-model"><i class="fa fa-check"></i><b>5.2.5</b> Run through the process model</a></li>
<li class="chapter" data-level="5.2.6" data-path="Data-GeospatialData.html"><a href="Data-GeospatialData.html#manually-edit-the-gis-layers-for-import-in-rs-minerve"><i class="fa fa-check"></i><b>5.2.6</b> Manually edit the GIS layers for import in RS MINERVE</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html"><i class="fa fa-check"></i><b>5.3</b> Climate Reanalysis Data</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html#Data::CHELSA"><i class="fa fa-check"></i><b>5.3.1</b> CHELSA V1.2.1 Data and Bias Correction</a></li>
<li class="chapter" data-level="5.3.2" data-path="Data-ClimateReanalysisData.html"><a href="Data-ClimateReanalysisData.html#Data::ERA5"><i class="fa fa-check"></i><b>5.3.2</b> ERA5 Download and Data Resampling with PBCORR CHELSA</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html"><i class="fa fa-check"></i><b>5.4</b> Data on Climate Projections</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html#CHELSA21Century"><i class="fa fa-check"></i><b>5.4.1</b> High Res. Monthly Climate Time Series for 2006 - 2100</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-on-climate-projections.html"><a href="data-on-climate-projections.html#Data::WeatherGenerator"><i class="fa fa-check"></i><b>5.4.2</b> Using a Weather Generator to Simulate Daily Future Climate</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="snow-cover-data.html"><a href="snow-cover-data.html"><i class="fa fa-check"></i><b>5.5</b> Snow Cover Data</a></li>
<li class="chapter" data-level="5.6" data-path="glacier-data.html"><a href="glacier-data.html"><i class="fa fa-check"></i><b>5.6</b> Glacier Data</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="RSMinerveMODELS.html"><a href="RSMinerveMODELS.html"><i class="fa fa-check"></i><b>6</b> Hydrological-Hydraulic Modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="section-rsminerve-prerequisites.html"><a href="section-rsminerve-prerequisites.html"><i class="fa fa-check"></i><b>6.1</b> Prerequisites</a></li>
<li class="chapter" data-level="6.2" data-path="section-rsminerve-why-model-introduction.html"><a href="section-rsminerve-why-model-introduction.html"><i class="fa fa-check"></i><b>6.2</b> Recap: Hydrological response</a></li>
<li class="chapter" data-level="6.3" data-path="section-general-modelling-process.html"><a href="section-general-modelling-process.html"><i class="fa fa-check"></i><b>6.3</b> Recap: The general modeling process</a></li>
<li class="chapter" data-level="6.4" data-path="section-rsminerve-data-preparation.html"><a href="section-rsminerve-data-preparation.html"><i class="fa fa-check"></i><b>6.4</b> Data Preparation and Setup</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="section-rsminerve-data-preparation.html"><a href="section-rsminerve-data-preparation.html#examining-and-understanding-the-gis-data"><i class="fa fa-check"></i><b>6.4.1</b> Examining and Understanding the GIS Data</a></li>
<li class="chapter" data-level="6.4.2" data-path="section-rsminerve-data-preparation.html"><a href="section-rsminerve-data-preparation.html#loading-gis-data-and-model-creation"><i class="fa fa-check"></i><b>6.4.2</b> Loading GIS Data and Model Creation</a></li>
<li class="chapter" data-level="6.4.3" data-path="section-rsminerve-data-preparation.html"><a href="section-rsminerve-data-preparation.html#climate-data"><i class="fa fa-check"></i><b>6.4.3</b> Climate Data</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="section-hbv-model.html"><a href="section-hbv-model.html"><i class="fa fa-check"></i><b>6.5</b> The HBV model</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="section-hbv-model.html"><a href="section-hbv-model.html#section-hbv-nauvalisoy-tutorial-short"><i class="fa fa-check"></i><b>6.5.1</b> HBV example: Simple model of the Nauvalisoy river catchment</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="section-model-calibration-and-validation.html"><a href="section-model-calibration-and-validation.html"><i class="fa fa-check"></i><b>6.6</b> Model Calibration and Validation</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="section-model-calibration-and-validation.html"><a href="section-model-calibration-and-validation.html#section-calibration-principles"><i class="fa fa-check"></i><b>6.6.1</b> Basic Principles</a></li>
<li class="chapter" data-level="6.6.2" data-path="section-model-calibration-and-validation.html"><a href="section-model-calibration-and-validation.html#secion-calibration-practical-steps"><i class="fa fa-check"></i><b>6.6.2</b> Practical Steps</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="application-investigating-climate-change-impacts.html"><a href="application-investigating-climate-change-impacts.html"><i class="fa fa-check"></i><b>6.7</b> Application: Investigating Climate Change Impacts</a></li>
<li class="chapter" data-level="6.8" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i><b>6.8</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="HydroModelsEmpiricalModels.html"><a href="HydroModelsEmpiricalModels.html"><i class="fa fa-check"></i><b>7</b> Discharge Forecasting with Predictive Inference</a>
<ul>
<li class="chapter" data-level="" data-path="prerequisites-2.html"><a href="prerequisites-2.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="7.1" data-path="Chap9PredictiveInference.html"><a href="Chap9PredictiveInference.html"><i class="fa fa-check"></i><b>7.1</b> Forecasting Using Predictive Inference</a></li>
<li class="chapter" data-level="7.2" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html"><i class="fa fa-check"></i><b>7.2</b> Forecasting in the Central Asian Hydromets</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html#background"><i class="fa fa-check"></i><b>7.2.1</b> Background</a></li>
<li class="chapter" data-level="7.2.2" data-path="forecasting-in-the-central-asian-hydromets.html"><a href="forecasting-in-the-central-asian-hydromets.html#forecasting-for-what-and-whom"><i class="fa fa-check"></i><b>7.2.2</b> Forecasting for What and Whom?</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html"><i class="fa fa-check"></i><b>7.3</b> Data and Preparation</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9AvailableData"><i class="fa fa-check"></i><b>7.3.1</b> Available Data</a></li>
<li class="chapter" data-level="7.3.2" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9DataPreparationQ"><i class="fa fa-check"></i><b>7.3.2</b> Gap Filling Discharge Data</a></li>
<li class="chapter" data-level="7.3.3" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9DataPreparationPT"><i class="fa fa-check"></i><b>7.3.3</b> Gap Filling Meteorological Data</a></li>
<li class="chapter" data-level="7.3.4" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9AnomaliesOutliers"><i class="fa fa-check"></i><b>7.3.4</b> Anomalies and Outliers</a></li>
<li class="chapter" data-level="7.3.5" data-path="Chap9DataPreparation.html"><a href="Chap9DataPreparation.html#Chap9_FinalData"><i class="fa fa-check"></i><b>7.3.5</b> Putting it all together</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html"><i class="fa fa-check"></i><b>7.4</b> Data Analysis</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap_9_DataTransformation"><i class="fa fa-check"></i><b>7.4.1</b> Data Transformation</a></li>
<li class="chapter" data-level="7.4.2" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_Trends"><i class="fa fa-check"></i><b>7.4.2</b> Detecting Trends</a></li>
<li class="chapter" data-level="7.4.3" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_Autocorrelations"><i class="fa fa-check"></i><b>7.4.3</b> Auto- and Crosscorrelations</a></li>
<li class="chapter" data-level="7.4.4" data-path="Chap9-DataAnalysis.html"><a href="Chap9-DataAnalysis.html#Chap9_SeasonalityAnalysis"><i class="fa fa-check"></i><b>7.4.4</b> Time Series Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html"><i class="fa fa-check"></i><b>7.5</b> Investigating and Engineering Predictors</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_CurrentPractice"><i class="fa fa-check"></i><b>7.5.1</b> Benchmark: Current Operational Forecasting Models in the Hydrometeorological Agencies</a></li>
<li class="chapter" data-level="7.5.2" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_TSR"><i class="fa fa-check"></i><b>7.5.2</b> Time Series Regression Models</a></li>
<li class="chapter" data-level="7.5.3" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_ForecastQuality"><i class="fa fa-check"></i><b>7.5.3</b> Assessing the Quality of Forecasts</a></li>
<li class="chapter" data-level="7.5.4" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#generating-and-assessing-out-of-sample-forecasts"><i class="fa fa-check"></i><b>7.5.4</b> Generating and Assessing Out-of-Sample Forecasts</a></li>
<li class="chapter" data-level="7.5.5" data-path="Chap9FeatureEngineering.html"><a href="Chap9FeatureEngineering.html#Chap9_MLM"><i class="fa fa-check"></i><b>7.5.5</b> Machine Learning Models</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="save-data-for-hot-start.html"><a href="save-data-for-hot-start.html"><i class="fa fa-check"></i><b>7.6</b> Save Data for Hot Start</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="Operationalization.html"><a href="Operationalization.html"><i class="fa fa-check"></i><b>8</b> Operationalization of Models - Opportunities and Challenges</a>
<ul>
<li class="chapter" data-level="8.1" data-path="co-design-phase.html"><a href="co-design-phase.html"><i class="fa fa-check"></i><b>8.1</b> Co-design Phase</a></li>
<li class="chapter" data-level="8.2" data-path="modeling-phase.html"><a href="modeling-phase.html"><i class="fa fa-check"></i><b>8.2</b> Modeling Phase</a></li>
<li class="chapter" data-level="8.3" data-path="testing-phase.html"><a href="testing-phase.html"><i class="fa fa-check"></i><b>8.3</b> Testing Phase</a></li>
<li class="chapter" data-level="8.4" data-path="operational-deployment.html"><a href="operational-deployment.html"><i class="fa fa-check"></i><b>8.4</b> Operational Deployment</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ChapterAppendix.html"><a href="ChapterAppendix.html"><i class="fa fa-check"></i><b>9</b> (APPENDIX) Appendix</a>
<ul>
<li class="chapter" data-level="9.1" data-path="section-appendix-open-source-resources.html"><a href="section-appendix-open-source-resources.html"><i class="fa fa-check"></i><b>9.1</b> Appendix A: Open-source resources</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="section-appendix-open-source-resources.html"><a href="section-appendix-open-source-resources.html#literature"><i class="fa fa-check"></i><b>9.1.1</b> Literature</a></li>
<li class="chapter" data-level="9.1.2" data-path="section-appendix-open-source-resources.html"><a href="section-appendix-open-source-resources.html#section-open-resrouces-software-QGIS"><i class="fa fa-check"></i><b>9.1.2</b> QGIS</a></li>
<li class="chapter" data-level="9.1.3" data-path="section-appendix-open-source-resources.html"><a href="section-appendix-open-source-resources.html#section-open-resrouces-software-R"><i class="fa fa-check"></i><b>9.1.3</b> R and RStudio</a></li>
<li class="chapter" data-level="9.1.4" data-path="section-appendix-open-source-resources.html"><a href="section-appendix-open-source-resources.html#section-open-resrouces-software-RSMinerve"><i class="fa fa-check"></i><b>9.1.4</b> RS Minerve</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html"><i class="fa fa-check"></i><b>9.2</b> Appendix B: Quick Guides</a>
<ul>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-register-with-earth-explorer"><i class="fa fa-check"></i>EE: Register for an account</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-earth-explorer-download-srtm"><i class="fa fa-check"></i>EE: Download SRTM data for a selected region</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#appendix-sofware-qgis-installation-guide"><i class="fa fa-check"></i>QGIS installation guide</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-qgis-window-overview"><i class="fa fa-check"></i>The QGIS window - overview</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-saving-a-new-qgis-project"><i class="fa fa-check"></i>QGIS: Saving a new QGIS project</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-change-project-projection-qgis"><i class="fa fa-check"></i>QGIS: Change the projection of the QGIS project</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-install-and-activate-plugins-in-QGIS3"><i class="fa fa-check"></i>QGIS: Install and activate plugins in QGIS3</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-managing-panels"><i class="fa fa-check"></i>GQIS: Managing panels visibility in QGIS</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-loading-public-background-layers"><i class="fa fa-check"></i>QGIS: Loading public background maps</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-zoom-to-layer"><i class="fa fa-check"></i>QGIS: Zoom to layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-srtm-plugin"><i class="fa fa-check"></i>QGIS: Import SRTM layers using the SRTM plugin</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-merge-srtm-tiles"><i class="fa fa-check"></i>QGIS: Merge SRTM tiles to a single layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quick-guides-load-dem"><i class="fa fa-check"></i>QGIS: Add raster layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#appendix-quick-guides-change-color-of-raster-layer"><i class="fa fa-check"></i>QGIS: Change color of raster layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-add-map-decorations"><i class="fa fa-check"></i>QGIS: Add map decorations</a></li>
<li class="chapter" data-level="9.2.1" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quick-guides-verify-projection-reproject"><i class="fa fa-check"></i><b>9.2.1</b> QGIS: Verify projection of layer and re-project layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#appendix-quick-guide-save-temp-layer"><i class="fa fa-check"></i>QGIS: Save a temporary layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-add-vector-layer-to-qgis"><i class="fa fa-check"></i>QGIS: Add vector layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-change-color-of-vector-layer"><i class="fa fa-check"></i>QGIS: Change color of a vector layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#appendix-quick-guides-fill-sinks"><i class="fa fa-check"></i>QGIS: Fill sinks</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#appendix-quick-guide-upslope-area"><i class="fa fa-check"></i>QGIS: Calculate the area upslope of a point</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#appendix-quick-guide-polygonize"><i class="fa fa-check"></i>QGIS:</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#appendix-section-graphical-edit-junctions"><i class="fa fa-check"></i>QGIS: Edit Junctions layer</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-create-hbv-model"><i class="fa fa-check"></i>RSM: Create HBV model and edit parameters</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-add-climate-station"><i class="fa fa-check"></i>RSM: Add and link climate station</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-import-climate-data"><i class="fa fa-check"></i>RSM: Import climate data</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-atapt-model-settings"><i class="fa fa-check"></i>RSM: Adapt model settings</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-export-sim-results-to-db"><i class="fa fa-check"></i>RSM: Export simulation results to data base</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-add-comparator-and-discharge-data"><i class="fa fa-check"></i>RSM: Add comparator and load discharge measurements</a></li>
<li class="chapter" data-level="" data-path="appendix-b-quick-guides.html"><a href="appendix-b-quick-guides.html#section-quickguides-copy-paste-database-values"><i class="fa fa-check"></i>RSM: Copy-paste data to database</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html"><i class="fa fa-check"></i><b>9.3</b> Appendix C: Processing Climate Data</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#cutting-chelsa-v.1.2.1-to-ca-domain"><i class="fa fa-check"></i><b>9.3.1</b> Cutting CHELSA v.1.2.1 to CA Domain</a></li>
<li class="chapter" data-level="9.3.2" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#bias-correcting-chelsa-v1.2.1-precipitation-data-for-snow-undercatch"><i class="fa fa-check"></i><b>9.3.2</b> Bias Correcting CHELSA v1.2.1 Precipitation Data for Snow Undercatch</a></li>
<li class="chapter" data-level="9.3.3" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#computing-mean-monthly-temperature-climatology-from-chelsa-v1.2.1-data"><i class="fa fa-check"></i><b>9.3.3</b> Computing Mean Monthly Temperature Climatology from CHELSA v1.2.1 data</a></li>
<li class="chapter" data-level="9.3.4" data-path="appendix-c-processing-climate-data.html"><a href="appendix-c-processing-climate-data.html#era5"><i class="fa fa-check"></i><b>9.3.4</b> ERA5</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html"><i class="fa fa-check"></i><b>9.4</b> Appendix D: Solutions to exercises</a>
<ul>
<li class="chapter" data-level="" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html#section-appendix-solutions-exercise1"><i class="fa fa-check"></i>Exercise on Linear Reservoir modelling</a></li>
<li class="chapter" data-level="" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html#exercise-on-creating-gis-layers-for-import-to-rs-minerve"><i class="fa fa-check"></i>Exercise on creating GIS layers for import to RS Minerve</a></li>
<li class="chapter" data-level="" data-path="sectin-appendix-solutions.html"><a href="sectin-appendix-solutions.html#section-appendix-solutions-hbv-exercises"><i class="fa fa-check"></i>Exercises on the HBV model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Modeling of Hydrological Systems in Central Asia</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="section-model-calibration-and-validation" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Model Calibration and Validation</h2>
<div id="section-calibration-principles" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Basic Principles</h3>
<p>The large number of parameters of the HBV model can be adjusted within reasonable ranges to make the simulated river discharge more similar to the measured discharge. This process is sometimes called history matching because past measurements are used to adapt the model parameters. The following two exercises are important for understanding hydrological models. They are relevant whether you work as a modeler or as a decision maker. Try to first come up with a few own ideas and then study the solutions carefully. They will be discussed in the lectures in more detail.</p>
<div class = "exercise" <div class = "exercise" id="t4.7"> 
<h3 class = "right">E4.7</h3> 
<h3 class= "left">Model calibration - Common difficulties</h3> 
<p>Discuss with your colleague(s): What are typical difficulties inherent to the calibration of common semi-distributed (or fully distributed) hydrological models?</p>
<p>Hint: Compare the number of parameters of the HBV model to the number of model states.</p>
<p><a href="https://tobiassiegfried.github.io/HydrologicalModeling_CentralAsia/sectin-appendix-solutions.html#section-appendix-solutions-common-calibration-issues">Solution</a></p>
</div>
<div class = "exercise" <div class = "exercise" id="t4.8"> 
<h3 class = "right">E4.8</h3> 
<h3 class= "left">Model calibration - Strategies to handle the difficulties</h3> 
<p>Discuss with your colleague(s): Based on the list of common difficulties in the solution of exercise 5, think about possible strategies to address these challenges.</p>
<p>Hint: A modeler proverb says "as simple as possible but as complex as necessary".</p>
<p><a href="https://tobiassiegfried.github.io/HydrologicalModeling_CentralAsia/sectin-appendix-solutions.html#section-appendix-solutions-strategies-for-issues">Solution</a></p>
</div>
<div id="calibration-vs.-validation" class="section level4" number="6.6.1.1">
<h4><span class="header-section-number">6.6.1.1</span> Calibration vs. validation</h4>
<p>As you have learned, semi- and fully distributed hydrological models are typically not well defined, i.e. you will find multiple sets of parameter combinations which will all yield reasonable model performance. An important strategy to gain confidence into a model is to split your time series into a calibration period and a validation period. During calibration, you adjust the model parameters to get a satisfying fit with the measured discharge. During the validation period you check how the calibrated model compares to discharge data that it hasn’t seen before, i.e. you judge the ability of the model to handle potentially different model input than it has seen during calibration. For example, if you have 30 years of discharge time series available you can use the first 10 years for model calibration (i.e. you run the model calibration procedure only over the first 10 years of the time series) and use the last 20 years for model validation. A good model should perform satisfactorily not only during calibration but also during validation.<br />
In hydrology, it is recommended to do cross-validation, i.e. to calibrate and validate a model with several combinations of calibration and validation periods and to summarize the overall model performance.<br />
Interested readers are refered to the literature for a more thorough discussion of the topic. For example, Bergstroem <span class="citation">(<a href="References.html#ref-bergstrom_principles_1991" role="doc-biblioref">Bergström 1991</a>)</span> gives a thorough discussion of model calibration and validation based on the HBV model which is still valid today.</p>
</div>
<div id="performance-indicators" class="section level4" number="6.6.1.2">
<h4><span class="header-section-number">6.6.1.2</span> Performance indicators</h4>
<p>Model performance can be expressed in different ways. Some indicators are better suited to calibrate high flows (e.g. root mean squared error) and some are better suited to calibrate low flows (e.g. Nash coefficient for logarithm values). Others evaluate the models ability to reproduce the exceedance of a given discharge which is especially important for flood modelling. The calibration result depends on the choice of the performance indicators. For the automated calibration in RS Minerve, the user can choose a combination of several performance indicators. Care has to be taken to choose them according to the models goal.</p>
<div class = "exercise" <div class = "exercise" id="t4.9"> 
<h3 class = "right">E4.9</h3> 
<h3 class= "left">Model performance indicators</h3> 
<p>The RS Minerve technical manual summarizes the most important performance indicators typically used in hydrological modelling. For the more ambitious modellers, the manual includes references to the literature.</p>
<p>Read Chapter 3 of the technical manual. </p>
</div>
</div>
</div>
<div id="secion-calibration-practical-steps" class="section level3" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Practical Steps</h3>
<div id="section-hbv-nauvalisoy-calibration" class="section level4" number="6.6.2.1">
<h4><span class="header-section-number">6.6.2.1</span> Manual calibration of synthetic discharge</h4>
<p>The following section describes the steps for manual model calibration. We use the example of the Nauvalisoy river catchment and calibrate it with synthetic discharge measurements to deepen our understanding of the HBV model. For the synthetic discharge measurements it is theoretically possible to find a perfect match between simulated and measured data which is typically not the case for real measurements.<br />
Add a comparator and a source object to your Nauvalisoy model and load river discharge measurements (filename), then run the model <a href="appendix-b-quick-guides.html#section-quickguides-add-comparator-and-discharge-data">Here</a> is a detailed step-by-step description of how to do this. With default parameters, the outcome of this step should look like Figure <a href="section-model-calibration-and-validation.html#fig:rsminerve-run-model-precalibration">6.12</a>. Should your result differ significantly from the one shown here, compare the parameters of the HBV mode to the ones in the file <a href="./data/SyrDarya/Chirchiq/RSMinerve/nauvalisoy_PAR_precalibration.txt">./data/SyrDarya/Chirchiq/RSMinerve/nauvalisoy_PAR_precalibration.txt</a>. You can import the parameter set to RS Minerve via Import P in the model properties toolbar.</p>
<div class="figure" style="text-align: center"><span id="fig:rsminerve-run-model-precalibration"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_simulation_result_before_calibration_synthetic.png" alt="The simulated discharge (green) differs from the reference discharge (blue) before model calibration." width="80%" />
<p class="caption">
Figure 6.12: The simulated discharge (green) differs from the reference discharge (blue) before model calibration.
</p>
</div>
<div class = "exercise" <div class = "exercise" id="t4.10"> 
<h3 class = "right">E4.10</h3> 
<h3 class= "left">RS Minerve - Manual calibration of synthetic discharge</h3> 
<p>1. Try to calibrate the model. Start with the parameters of the snow function and then proceed downwards through the compartments of the HBV model. Try to figure out which parameters influence the timing of the discharge peak, which the height of the peak and which the form of the recession curve.</p>
<p>2. Look at the variables of the HBV model during calibration (e.g. snow water equivalent, soil moisture, etc.).</p>
<p>Hint: This is an iterative process, give yourself some time for this task before you go peaking in the results.</p>
<p>The parameters of the calibrated model are linked <a href="https://tobiassiegfried.github.io/HydrologicalModeling_CentralAsia/sectin-appendix-solutions.html#section-appendix-solutions-calibrated parameters">here</a>. Inspiration for this exercise from Prof. Jan Seibert and colleagues.</p>
</div>
The calibration process can be automated in RS Minerve. Automated calibration works similarly as manual calibration: A parameter is changed to minimize the calibration performance criteria (e.g. the difference between the simulated and the measured discharge). Because the automated calibration is much faster than manual calibration, it is extremely tempting to let it calibrate all parameters at once while working on something else but by now you know that good modeling is not as simple as that. Let’s see if RS Minerve finds the parameter set that was used to produce the synthetic discharge curve. Load the original parameter set via import P in the Model Properties toolbar. The file is in <a href="./data/SyrDarya/Chirchiq/RSMinerve/nauvalisoy_PAR_precalibration.txt">./data/SyrDarya/Chirchiq/RSMinerve/nauvalisoy_PAR_precalibration.txt</a>. Open the calibration tab in the Module toolbar (Figure <a href="section-model-calibration-and-validation.html#fig:open-calibration-tab">6.13</a>).
<div class="figure" style="text-align: center"><span id="fig:open-calibration-tab"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_open-calibration-tab.png" alt="Open the calibration tab in RS Minerve." width="80%" />
<p class="caption">
Figure 6.13: Open the calibration tab in RS Minerve.
</p>
</div>
In the calibrator tab, select the parameters <strong>CFmax</strong>, <strong>TT</strong>, <strong>TTInt</strong>, <strong>FC</strong>, <strong>SUMax</strong>, <strong>Kr</strong>, <strong>Ku</strong>, <strong>Kl</strong>, and <strong>Kperc</strong> for calibration. Compare the parameter ranges to the calibrated parameter set from the <a href="#section-appendix-solutions-calibrated%20parameters">solutions of the manual calibration example</a> and make sure that the <em>true</em> parameters are within the range of the parameters to be calibrated (e.g. make sure that for TT and TTInt Max is set to 3 (see also Figure <a href="section-model-calibration-and-validation.html#fig:calibration-parameters">6.14</a>)).
<div class="figure" style="text-align: center"><span id="fig:calibration-parameters"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_calibration_parameters.png" alt="Open the calibration tab in RS Minerve." width="80%" />
<p class="caption">
Figure 6.14: Open the calibration tab in RS Minerve.
</p>
</div>
<p>You will have to choose performance indicators which will be combined in the objective function.</p>
<div class = "exercise" <div class = "exercise" id="t4.11"> 
<h3 class = "right">E4.11</h3> 
<h3 class= "left">RS Minerve - Automated calibration</h3> 
<p>Choose one or several performance indicators and run the automated calibration. The automated calibration may take a few minutes (expect around 3000 model iterations). Compare the parameters found with the automated calibration to the ones that were used for the generation of the synthetic discharge values (in <a href="https://tobiassiegfried.github.io/HydrologicalModeling_CentralAsia/sectin-appendix-solutions.html#section-appendix-solutions-calibrated parameters">solutions of the manual calibration example</a>). Discuss the differences. Where were you surprised? Which parameters could be identified and which not?</p>
<p>Change the combination and weights of the performance indicators and redo the automated calibration. Note how the calibration result changes. </p>
</div>
<p>You have seen in the exercise above that is not so easy to find the <em>true</em> parameter set of a basin. Let’s get a better understanding of the model parameters. Choose 1-3 parameters for which you will do a sensitivity analysis.</p>
<div class = "exercise" <div class = "exercise" id="t4.12"> 
<h3 class = "right">E4.12</h3> 
<h3 class= "left">RS Minerve - Manual sensitivity analysis</h3> 
<p>Discuss with your colleague(s) in which way you expect the model outcomes to change when you modify your chosen parameters before you run the model. </p>
<p>Make notes of the changes in parameters and the changes in the model outcomes.</p>
</div>
<p>The sensitivity analysis can be automated in RS Minerve. Make sure to have the calibrated parameter set loaded (via import P in the Model Properties toolbar). Open the tab for stochastic simulations in the Module toolbar (see Figure <a href="section-model-calibration-and-validation.html#fig:rsminerve-open-stochastic-simulation">6.15</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:rsminerve-open-stochastic-simulation"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_stochasticSimulation.png" alt="Open the stochastic simulation tab in RS Minerve." width="80%" />
<p class="caption">
Figure 6.15: Open the stochastic simulation tab in RS Minerve.
</p>
</div>
Select one of the parameters that you have evaluated manually in the exercise above and assume a uniform distribution between the default parameter ranges for said parameter (see for example Figure <a href="section-model-calibration-and-validation.html#fig:rsminerve-do-stochastic-simulation">6.16</a>).
<div class="figure" style="text-align: center"><span id="fig:rsminerve-do-stochastic-simulation"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_doStochasticSimulation.png" alt="Open the stochastic simulation tab in RS Minerve." width="80%" />
<p class="caption">
Figure 6.16: Open the stochastic simulation tab in RS Minerve.
</p>
</div>
<div class = "exercise" <div class = "exercise" id="t4.13"> 
<h3 class = "right">E4.13</h3> 
<h3 class= "left">RS Minerve - Automated sensitivity analysis</h3> 
<p>Perform an automated sensitivity analysis for the same parameters you chose in the previous exercise (manual sensitivity analysis).</p>
<p>Compare the outcome of the manual sensitivity analysis.</p>
<p>Bonus task: Choose a sensitive model parameter and evaluate the sensitivity of the stochastic simulation with regard to the number of simulations or the seed. (The seed is used in the random number generator. It makes the stochastic simulation reproducible.)</p>
</div>
Now we have a rasonable understanding of the HBV model. Let’s try it out with real discharge data. Import the database file for Nauvalisoy including measured discharge at the outlet of the catchment <a href="./data/SyrDarya/Chirchiq/RSMinerve/ERA5Q_Nauvalisoy_1981_2013.csv">./data/SyrDarya/Chirchiq/RSMinerve/ERA5Q_Nauvalisoy_1981_2013.csv</a> into RS Minerve and connect it to your model. Adapt the simulation time period to start on Jan 1 1981 at 1 a.m. until Dec 31 2013 at 11 p.m (the full period with available data). The simulation will take place at the maximum resolution of the forcing data, i.e. at hourly time steps. The discharge measurements are available as averages over 8-11 days. We choose an output interval of 2 days. As the initial water content in the system is not known, a warm-up period of 1 year is typically used to minimize the impact of the unknown initial conditions on the simulation results. You can implement the warm-up period in the comparator object under Parameters. Use the default, pre-calibration parameter set in <a href="./data/SyrDarya/Chirchiq/RSMinerve/nauvalisoy_PAR_precalibration.txt">./data/SyrDarya/Chirchiq/RSMinerve/nauvalisoy_PAR_precalibration.txt</a> as we don’t know much about the catchment properties.<br />
Figure <a href="section-model-calibration-and-validation.html#fig:fig-real-discharge-result">6.17</a> shows the resulting discharge time series in the comparator object.
<div class="figure"><span id="fig:fig-real-discharge-result"></span>
<img src="_bookdown_files/FIG_RS_MINERVE/fig_Nauvalisoy_real_discharge_base.png" alt="Simulated and measured discahrge at the outlet of the Nauvalisoy catchment." width="1440" />
<p class="caption">
Figure 6.17: Simulated and measured discahrge at the outlet of the Nauvalisoy catchment.
</p>
</div>
<p>The simulated discharge peak arrives several months before the observed discharge peak. You may invest 10 minutes to try it out but by merely adjusting the parameters of our HBV model, we will not be able to shift the simulated discharge time series sufficiently to reproduce the measured discharge. We are facing a conceptual model error which we have to identify and eliminate.</p>
<p>Figure <a href="section-model-calibration-and-validation.html#fig:gunt-temp-elevation">6.18</a> shows the relationship between elevation and temperature of the 4 meteo stations in the Gunt river catchment. The elevation dependence of temperature is highly important for snow-melt driven river catchments.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="section-model-calibration-and-validation.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="do">## MeteoStation locations and elevation</span></span>
<span id="cb120-2"><a href="section-model-calibration-and-validation.html#cb120-2" aria-hidden="true" tabindex="-1"></a>meteoStations <span class="ot">&lt;-</span> <span class="co"># just put everything in a regular dataframe</span></span>
<span id="cb120-3"><a href="section-model-calibration-and-validation.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">code =</span> <span class="fu">c</span>(<span class="dv">38953</span>, <span class="dv">38954</span>, <span class="dv">38956</span>, <span class="dv">38950</span>),</span>
<span id="cb120-4"><a href="section-model-calibration-and-validation.html#cb120-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">masl  =</span> <span class="fu">c</span>(<span class="dv">3746</span>, <span class="dv">2075</span>, <span class="dv">3438</span>, <span class="dv">2566</span>))</span>
<span id="cb120-5"><a href="section-model-calibration-and-validation.html#cb120-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-6"><a href="section-model-calibration-and-validation.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Gunt data</span></span>
<span id="cb120-7"><a href="section-model-calibration-and-validation.html#cb120-7" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&#39;./data/AmuDarya/Gunt/StationData/gunt_data_cleaned.Rds&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb120-8"><a href="section-model-calibration-and-validation.html#cb120-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(type, <span class="st">&quot;T&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Filter for data types that contain T </span></span>
<span id="cb120-9"><a href="section-model-calibration-and-validation.html#cb120-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">code =</span> <span class="fu">as.numeric</span>(code)) <span class="sc">%&gt;%</span>  <span class="co"># Cast code column to numeric</span></span>
<span id="cb120-10"><a href="section-model-calibration-and-validation.html#cb120-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(meteoStations)  <span class="co"># Add the station altitude to the data</span></span>
<span id="cb120-11"><a href="section-model-calibration-and-validation.html#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="section-model-calibration-and-validation.html#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting the dataframe</span></span>
<span id="cb120-13"><a href="section-model-calibration-and-validation.html#cb120-13" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb120-14"><a href="section-model-calibration-and-validation.html#cb120-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::filter(!str_detect(type, &quot;meanmax&quot;), </span></span>
<span id="cb120-15"><a href="section-model-calibration-and-validation.html#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co">#                 !str_detect(type, &quot;meanmin&quot;)) %&gt;%</span></span>
<span id="cb120-16"><a href="section-model-calibration-and-validation.html#cb120-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">str_detect</span>(type, <span class="st">&quot;mean</span><span class="sc">\\</span><span class="st">(T</span><span class="sc">\\</span><span class="st">)&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb120-17"><a href="section-model-calibration-and-validation.html#cb120-17" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Variable =</span> type) <span class="sc">%&gt;%</span></span>
<span id="cb120-18"><a href="section-model-calibration-and-validation.html#cb120-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(code, Variable) <span class="sc">%&gt;%</span></span>
<span id="cb120-19"><a href="section-model-calibration-and-validation.html#cb120-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">norm =</span> <span class="fu">mean</span>(norm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb120-20"><a href="section-model-calibration-and-validation.html#cb120-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">masl =</span> <span class="fu">first</span>(masl)) <span class="sc">%&gt;%</span></span>
<span id="cb120-21"><a href="section-model-calibration-and-validation.html#cb120-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(norm, masl)) <span class="sc">+</span>  <span class="co">#, colour = Variable)) + </span></span>
<span id="cb120-22"><a href="section-model-calibration-and-validation.html#cb120-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">alpha =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">&quot;gray&quot;</span>) <span class="sc">+</span> </span>
<span id="cb120-23"><a href="section-model-calibration-and-validation.html#cb120-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb120-24"><a href="section-model-calibration-and-validation.html#cb120-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Altitude [masl]&quot;</span>, <span class="at">x =</span> <span class="st">&quot;T [deg C]&quot;</span>) <span class="sc">+</span> </span>
<span id="cb120-25"><a href="section-model-calibration-and-validation.html#cb120-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure"><span id="fig:gunt-temp-elevation"></span>
<img src="applied-hydrological-modeling-central-asia_files/figure-html/gunt-temp-elevation-1.png" alt="Elevation dependence of mean temperature at the four meteo stations in the Gunt river catchment. The temperature decrease is a little below 1 degree K per 100 m of altitude gain." width="672" />
<p class="caption">
Figure 6.18: Elevation dependence of mean temperature at the four meteo stations in the Gunt river catchment. The temperature decrease is a little below 1 degree K per 100 m of altitude gain.
</p>
</div>
<p>At temperatures below approximately 0 degrees C, precipitation falls as snow and remains stored as snow in the catchment until temperatures above 0 degrees C melt the snow and produce runoff. Especially for snow driven catchments, it is important to take the elevation dependence of temperature into account. In RS Minerve, this can be done by dividing the catchment into several sub-catchments of similar altitude (i.e. elevation bands) and to define temperature (and precipitation) inputs for these sub-catchments. This is a spatial refinement of the model which allows us to better represent the snow storage and melting processes in the catchment. A description of how to obtain the elevation bands is given in the Chapter on the preparation of <a href="Data-GeospatialData.html#Data::GeospatialData">geospatial data</a>.</p>
</div>
<div id="section-hbv-elevation-bands" class="section level4" number="6.6.2.2">
<h4><span class="header-section-number">6.6.2.2</span> Spatial refinement of the model</h4>
<p>** TODO: Nauvalisoy elevation bands at higher resolution, ask tobi how involved the exctraction of the era5 bias corrected data for the elevation bands is **</p>
</div>
</div>
</div>
<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://hydrological-modeling-central-asia.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="section-hbv-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-investigating-climate-change-impacts.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08_RS_MINERVE.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["applied-hydrological-modeling-central-asia.pdf", "applied-hydrological-modeling-central-asia.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
