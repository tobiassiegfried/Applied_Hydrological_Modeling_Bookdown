plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year", .y_lab = "deg. C.",.legend_show = T
) + theme(legend.position = c(0.1, 0.8))
pQ2 <- q2T  %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "deg. C.",.legend_show = F
)
pQ3 <- q3T  %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "deg. C.", .legend_show = F
)
pQ4 <- q4T  %>% na.omit() %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "deg. C.",.legend_show = F
)
plotM <- list(pQ1,pQ2,pQ3,pQ4)
cowplot::plot_grid(plotlist = plotM,nrow = 1,ncol = 4)
quarterP_mean <- data %>% filter(type == "P" & code=="38464") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date, .by = "quarter",value = mean(data,na.rm = TRUE)) %>%
rename(mean = value) %>% na.omit()
quarterP_max <- data %>% filter(type == "P" & code=="38464") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date, .by = "quarter",value = max(data,na.rm = TRUE)) %>%
rename(max = value) %>% na.omit()
quarterP_min <- data %>% filter(type == "P" & code=="38464") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date,.by = "quarter",value = min(data,na.rm = TRUE)) %>%
rename(min = value) %>% na.omit()
quarterP <- left_join(quarterP_mean,quarterP_max,by='date')
quarterP <- left_join(quarterP,quarterP_min,by='date')
quarterP <-
bind_cols(quarterP,quarterP$date %>% tsibble::yearquarter()) %>% rename(quarter='...5')
quarterP$quarter <- quarterP$quarter %>% format(.,format = "Q%q")
q1P <- quarterP %>% filter(quarter=='Q1') %>% select(-quarter) %>% pivot_longer(-date)
q2P <- quarterP %>% filter(quarter=='Q2') %>% select(-quarter) %>% pivot_longer(-date)
q3P <- quarterP %>% filter(quarter=='Q3') %>% select(-quarter) %>% pivot_longer(-date)
q4P <- quarterP %>% filter(quarter=='Q4') %>% select(-quarter) %>% pivot_longer(-date)
pQ1 <- q1P  %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year", .y_lab = "deg. C.",.legend_show = T
) + theme(legend.position = c(0.1, 0.8))
pQ2 <- q2P  %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "mm / 10 days",.legend_show = F
)
pQ3 <- q3P  %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "mm / 10 days", .legend_show = F
)
pQ4 <- q4P  %>% na.omit() %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "mm / 10 days",.legend_show = F
)
plotM <- list(pQ1,pQ2,pQ3,pQ4)
cowplot::plot_grid(plotlist = plotM,nrow = 1,ncol = 4)
tp <- left_join(q1T,q1P,by='date')
tp
q1T
q1P
tp <- full_join(q1T,q1P,by='date')
tp
q1T
q1P
tp <- full_join(q1T,q1P,by=('date','name')
tp <- full_join(q1T,q1P,by=('date','name'))
tp <- full_join(q1T,q1P,by=('date'))
tp
?full_join
tp <- left_join(q1T,q1P,by=('date'),name)
tp
tp <- left_join(q1T,q1P,by=('date'),name)
tp
q1T34 <- q1T %>% filter(date>"1933-12,31")
q1T34 <- q1T %>% filter(date > "1933-12,31" %>% as.Date())
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1T34
tp <- left_join(q1T34,q1P,by=('date'),name)
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
tp <- left_join(q1T34,q1P,by=('date'),name)
tp
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
tp <- left_join(q1T34,q1P,by=('name'))
tp
tp
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
tp <- left_join(q1T34,q1P,by=('date'))
tp
q134
q1T34
q1P
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
tp <- left_join(q1T34 %>% select(-name),q1P %>% select(-name),by=('date'))
tp
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
tp <- left_join(q1T34 ,q1P ,by=c('date','name'))
tp
q1TP %>% na.omit() %>% ggplot(aes(x=value.x,y=value.y)) + geom_point()
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name'))
q1TP %>% na.omit() %>% ggplot(aes(x=value.x,y=value.y)) + geom_point()
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name'))
q1TP %>% na.omit() %>% filter(name=="mean") %>% ggplot(aes(x=value.x,y=value.y)) + geom_point()
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name'))
q1TP %>% na.omit() %>% filter(name=="min") %>% ggplot(aes(x=value.x,y=value.y)) + geom_point()
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name'))
q1TP %>% na.omit() %>% filter(name=="max") %>% ggplot(aes(x=value.x,y=value.y)) + geom_point()
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name'))
q1TP %>% na.omit() %>% filter(name=="max") %>% ggplot(aes(x=value.x,y=value.y)) +
geom_point() + geom_smooth(formula = y ~ x)
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name'))
q1TP %>% na.omit() %>%
#filter(name=="max") %>%
ggplot(aes(x=value.x,y=value.y)) +
geom_point() + geom_smooth(formula = y ~ x)
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name'))
q1TP %>% na.omit() %>%
#filter(name=="max") %>%
ggplot(aes(x=value.x,y=value.y)) +
geom_point() + geom_smooth(formula = y ~ x,method = "lm")
?rowwi?geom_smooth
?geom_smooth
q1TP %>% na.omit() %>%
#filter(name=="max") %>%
ggplot(aes(x=value.x,y=value.y)) +
geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name')) %>% rename(T=value.x,'P'=value.y
q1TP %>% na.omit() %>%
q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T34 ,q1P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
q1TP %>% na.omit() %>%
#filter(name=="max") %>%
ggplot(aes(x=T,y=P)) +
geom_point() + geom_smooth(formula = y ~ x,method = "loess")
#q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T ,q1P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
q1TP %>% na.omit() %>%
#filter(name=="max") %>%
ggplot(aes(x=T,y=P)) +
geom_point() + geom_smooth(formula = y ~ x,method = "loess")
#q1T34 <- q1T %>% filter(date > "1933-12-31" %>% as.Date())
q1TP <- left_join(q1T ,q1P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
q1TP
q1TP <- left_join(q1T ,q1P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p1 <- q1TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2TP <- left_join(q2T ,q2P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p2 <- q2TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q3TP <- left_join(q3T ,q3P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p3 <- q3TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q4TP <- left_join(q4T ,q4P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p4 <- q4TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p2,p3,p4)
cowplot::plot_grid(plotlist = plotM,nrow = 1,ncol = 4)
p1
p2
q1TP <- left_join(q1T ,q1P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p1 <- q1TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2TP <- left_join(q2T ,q2P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p2 <- q2TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q3TP <- left_join(q3T ,q3P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p3 <- q3TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q4TP <- left_join(q4T ,q4P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p4 <- q4TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p2,p3,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 4)
q1TP <- left_join(q1T ,q1P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p1 <- q1TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2TP <- left_join(q2T ,q2P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p2 <- q2TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q3TP <- left_join(q3T ,q3P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p3 <- q3TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q4TP <- left_join(q4T ,q4P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p4 <- q4TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 4)
q1TP <- left_join(q1T ,q1P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p1 <- q1TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2TP <- left_join(q2T ,q2P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p2 <- q2TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q3TP <- left_join(q3T ,q3P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p3 <- q3TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q4TP <- left_join(q4T ,q4P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p4 <- q4TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1TP <- left_join(q1T ,q1P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p1 <- q1TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q2TP <- left_join(q2T ,q2P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p2 <- q2TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q3TP <- left_join(q3T ,q3P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p3 <- q3TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q4TP <- left_join(q4T ,q4P ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p4 <- q4TP %>% na.omit() %>% ggplot(aes(x=T,y=P)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p <- list(p1,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1TQ <- left_join(q1T ,q1Q ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p1 <- q1TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q2TQ <- left_join(q2T ,q2Q ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p2 <- q2TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q3TQ <- left_join(q3T ,q3Q ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p3 <- q3TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q4TQ <- left_join(q4T ,q4Q ,by=c('date','name')) %>% rename(T=value.x,P=value.y)
p4 <- q4TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p <- list(p1,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1TQ
q1TQ <- left_join(q1T ,q1Q ,by=c('date','name')) %>% rename(T=value.x,Q=value.y)
p1 <- q1TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q2TQ <- left_join(q2T ,q2Q ,by=c('date','name')) %>% rename(T=value.x,Q=value.y)
p2 <- q2TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q3TQ <- left_join(q3T ,q3Q ,by=c('date','name')) %>% rename(T=value.x,Q=value.y)
p3 <- q3TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q4TQ <- left_join(q4T ,q4Q ,by=c('date','name')) %>% rename(T=value.x,Q=value.y)
p4 <- q4TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p <- list(p1,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1TQ <- left_join(q1T ,q1Q ,by=c('date','name')) %>% rename(T=value.x,Q=value.y)
p1 <- q1TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q2TQ <- left_join(q2T ,q2Q ,by=c('date','name')) %>% rename(T=value.x,Q=value.y)
p2 <- q2TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q3TQ <- left_join(q3T ,q3Q ,by=c('date','name')) %>% rename(T=value.x,Q=value.y)
p3 <- q3TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q4TQ <- left_join(q4T ,q4Q ,by=c('date','name')) %>% rename(T=value.x,Q=value.y)
p4 <- q4TQ %>% na.omit() %>% ggplot(aes(x=T,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p <- list(p1,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1PQ <- left_join(q1P,q1Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p1 <- q1PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q2PQ <- left_join(q2P,q2Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p2 <- q2PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q3PQ <- left_join(q3P,q3Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p3 <- q3PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q4PQ <- left_join(q4P,q4Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p4 <- q4PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p <- list(p1,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1PQ <- left_join(q1P,q1Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p1 <- q1PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q2PQ <- left_join(q2P,q2Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p2 <- q2PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q3PQ <- left_join(q3P,q3Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p3 <- q3PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q4PQ <- left_join(q4P,q4Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p4 <- q4PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p <- list(p1,p2,p3,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1PQ <- left_join(q1P,q1Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p1 <- q1PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q2PQ <- left_join(q2P,q2Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p2 <- q2PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q3PQ <- left_join(q3P,q3Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p3 <- q3PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
q4PQ <- left_join(q4P,q4Q ,by=c('date','name')) %>% rename(P=value.x,Q=value.y)
p4 <- q4PQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p <- list(p1,p2,p3,p4)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 4)
q1QQ <- left_join(q1Q,qwQ ,by=c('date','name')) %>% rename(Q1=value.x,Q2=value.y)
q1QQ <- left_join(q1Q,q2Q ,by=c('date','name')) %>% rename(Q1=value.x,Q2=value.y)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=P,y=Q)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p1
q1QQ <- left_join(q1Q,q2Q ,by=c('date','name')) %>% rename(Q1=value.x,Q2=value.y)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p1
q1QQ
q1Q
q2Q
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) rename(Q1=value.x)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value.x)
q1Q %>% add_column(Q2=q2Q$value)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "lm")
p1
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p1
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p1
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
p2 <- q2QQ %>% na.omit() %>% ggplot(aes(x=Q2,y=Q3)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p2
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
p2 <- q2QQ %>% na.omit() %>% ggplot(aes(x=Q2,y=Q3)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q3QQ <- q3Q %>% add_column(Q4=q4Q$value) %>%  rename(Q3=value)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
p2 <- q2QQ %>% na.omit() %>% ggplot(aes(x=Q2,y=Q3)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
# q3QQ <- q3Q %>% add_column(Q4=q4Q$value) %>%  rename(Q3=value)
# p3 <- q3QQ %>% na.omit() %>% ggplot(aes(x=Q3,y=Q4)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p2)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess") +
stat_smooth_func(geom="text",method="lm",hjust=0,parse=TRUE) +
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess") +
stat_smooth_func(geom="text",method="lm",hjust=0,parse=TRUE)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
p2 <- q2QQ %>% na.omit() %>% ggplot(aes(x=Q2,y=Q3)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
# q3QQ <- q3Q %>% add_column(Q4=q4Q$value) %>%  rename(Q3=value)
# p3 <- q3QQ %>% na.omit() %>% ggplot(aes(x=Q3,y=Q4)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p2)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
quarterQ_mean <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date,.by = "quarter",value = mean(data,na.rm = TRUE)) %>%
rename(mean = value) #%>% na.omit()
quarterQ_max <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date, .by = "quarter", value = max(data,na.rm = TRUE)) %>%
rename(max = value) #%>% na.omit()
quarterQ_min <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date, .by = "quarter", value = min(data,na.rm = TRUE)) %>%
rename(min = value) #%>% na.omit()
quarterQ <- left_join(quarterQ_mean,quarterQ_max,by='date')
quarterQ <- left_join(quarterQ,quarterQ_min,by='date')
quarterQ <- bind_cols(quarterQ,quarterQ$date %>% tsibble::yearquarter()) %>% rename(quarter='...5')
quarterQ$quarter <- quarterQ$quarter %>% format(.,format = "Q%q")
q1Q <- quarterQ %>% filter(quarter=='Q1') %>% select(-quarter) %>% pivot_longer(-date)
q2Q <- quarterQ %>% filter(quarter=='Q2') %>% select(-quarter) %>% pivot_longer(-date)
q3Q <- quarterQ %>% filter(quarter=='Q3') %>% select(-quarter) %>% pivot_longer(-date)
q4Q <- quarterQ %>% filter(quarter=='Q4') %>% select(-quarter) %>% pivot_longer(-date)
pQ1 <- q1Q  %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year", .y_lab = "Q", .legend_show = T
) + theme(legend.position = c(0.1, 0.8))
pQ2 <- q2Q  %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q", .legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
pQ3 <- q3Q  %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q",.legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
pQ4 <- q4Q  %>% na.omit() %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q",.legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
q1Q
q2Q
q3Q
q4Q
quarterQ_mean <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date,.by = "quarter",value = mean(data,na.rm = TRUE)) %>%
rename(mean = value) #%>% na.omit()
quarterQ_max <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date, .by = "quarter", value = max(data,na.rm = TRUE)) %>%
rename(max = value) #%>% na.omit()
quarterQ_min <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date, .by = "quarter", value = min(data,na.rm = TRUE)) %>%
rename(min = value) #%>% na.omit()
quarterQ <- left_join(quarterQ_mean,quarterQ_max,by='date')
quarterQ <- left_join(quarterQ,quarterQ_min,by='date')
quarterQ <- bind_cols(quarterQ,quarterQ$date %>% tsibble::yearquarter()) %>% rename(quarter='...5')
quarterQ$quarter <- quarterQ$quarter %>% format(.,format = "Q%q")
q1Q <- quarterQ %>% filter(quarter=='Q1') %>% select(-quarter) %>% pivot_longer(-date)
q2Q <- quarterQ %>% filter(quarter=='Q2') %>% select(-quarter) %>% pivot_longer(-date)
q3Q <- quarterQ %>% filter(quarter=='Q3') %>% select(-quarter) %>% pivot_longer(-date)
q4Q <- quarterQ %>% filter(quarter=='Q4') %>% select(-quarter) %>% pivot_longer(-date)
pQ1 <- q1Q  %>% na.omit() %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year", .y_lab = "Q", .legend_show = T
) + theme(legend.position = c(0.1, 0.8))
pQ2 <- q2Q  %>% na.omit() %>%#group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q", .legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
pQ3 <- q3Q  %>% na.omit() %>%#group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q",.legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
pQ4 <- q4Q  %>% na.omit() %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q",.legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
?summarize_by_time
quarterQ
quarterQ_mean <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date,.by = "quarter",value = mean(data,na.rm = TRUE)) %>%
rename(mean = value) #%>% na.omit()
quarterQ_max <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date, .by = "quarter", value = max(data,na.rm = TRUE)) %>%
rename(max = value) #%>% na.omit()
quarterQ_min <- data %>% filter(type == "Q" & code=="16924") %>%
dplyr::select(date,data,code,river)  %>%
summarise_by_time(.date_var = date, .by = "quarter", value = min(data,na.rm = TRUE)) %>%
rename(min = value) #%>% na.omit()
quarterQ <- left_join(quarterQ_mean,quarterQ_max,by='date')
quarterQ <- left_join(quarterQ,quarterQ_min,by='date')
quarterQ <- bind_cols(quarterQ,quarterQ$date %>% tsibble::yearquarter()) %>% rename(quarter='...5')
quarterQ$quarter <- quarterQ$quarter %>% format(.,format = "Q%q")
q1Q <- quarterQ %>% filter(quarter=='Q1') %>% select(-quarter) %>% na.omit() %>%pivot_longer(-date)
q2Q <- quarterQ %>% filter(quarter=='Q2') %>% select(-quarter) %>% na.omit() %>%pivot_longer(-date)
q3Q <- quarterQ %>% filter(quarter=='Q3') %>% select(-quarter) %>% na.omit() %>%pivot_longer(-date)
q4Q <- quarterQ %>% filter(quarter=='Q4') %>% select(-quarter) %>% na.omit() %>%pivot_longer(-date)
pQ1 <- q1Q  %>% na.omit() %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year", .y_lab = "Q", .legend_show = T
) + theme(legend.position = c(0.1, 0.8))
pQ2 <- q2Q  %>% na.omit() %>%#group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q", .legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
pQ3 <- q3Q  %>% na.omit() %>%#group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q",.legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
pQ4 <- q4Q  %>% na.omit() %>% #group_by(name) %>%
plot_time_series(date,value,name,
.smooth = T, .smooth_degree = 1, .smooth_period = 'auto',
.title = "", .interactive = F, .facet_ncol = 1,
.x_lab = "year",.y_lab = "Q",.legend_show = F
) #+ theme(legend.position = c(0.1, 0.8))
plotM <- list(pQ1,pQ2,pQ3,pQ4)
cowplot::plot_grid(plotlist = plotM, nrow = 1, ncol = 4)
q1Q
q2Q
q3Q
q4Q
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1 %>% log1p(),y=Q2 %>% log1p())) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
p2 <- q2QQ %>% na.omit() %>% ggplot(aes(x=Q2,y=Q3)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
# q3QQ <- q3Q %>% add_column(Q4=q4Q$value) %>%  rename(Q3=value)
# p3 <- q3QQ %>% na.omit() %>% ggplot(aes(x=Q3,y=Q4)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p2)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1 %>% log1p(),y=Q2) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1 %>% log1p(),y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
p2 <- q2QQ %>% na.omit() %>% ggplot(aes(x=Q2,y=Q3)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
# q3QQ <- q3Q %>% add_column(Q4=q4Q$value) %>%  rename(Q3=value)
# p3 <- q3QQ %>% na.omit() %>% ggplot(aes(x=Q3,y=Q4)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p2)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2 %>% log1p())) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
p2 <- q2QQ %>% na.omit() %>% ggplot(aes(x=Q2,y=Q3)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
# q3QQ <- q3Q %>% add_column(Q4=q4Q$value) %>%  rename(Q3=value)
# p3 <- q3QQ %>% na.omit() %>% ggplot(aes(x=Q3,y=Q4)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p2)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
q1QQ <- q1Q %>% add_column(Q2=q2Q$value) %>%  rename(Q1=value)
p1 <- q1QQ %>% na.omit() %>% ggplot(aes(x=Q1,y=Q2)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
q2QQ <- q2Q %>% add_column(Q3=q3Q$value) %>%  rename(Q2=value)
p2 <- q2QQ %>% na.omit() %>% ggplot(aes(x=Q2,y=Q3)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
# q3QQ <- q3Q %>% add_column(Q4=q4Q$value) %>%  rename(Q3=value)
# p3 <- q3QQ %>% na.omit() %>% ggplot(aes(x=Q3,y=Q4)) + geom_point() + geom_smooth(formula = y ~ x,method = "loess")
p <- list(p1,p2)
cowplot::plot_grid(plotlist = p,nrow = 1,ncol = 2)
